(function(Ia,Za){"object"===typeof exports&&"undefined"!==typeof module?Za(exports):"function"===typeof define&&define.amd?define(["exports"],Za):(Ia="undefined"!==typeof globalThis?globalThis:Ia||self,Za(Ia.Countly=Ia.Countly||{}))})(this,function(Ia){function Za(m,q,v){if("function"==typeof m?m===q:m.has(q))return 3>arguments.length?q:v;throw new TypeError("Private element is not present on this object");}function b(m,q){return m.get(Za(m,q))}function p(m,q,v){if(q.has(m))throw new TypeError("Cannot initialize the same private elements twice on an object");
q.set(m,v)}function k(m,q,v){return m.set(Za(m,q),v),v}function x(m,q,v){a:{var a=q;if("object"==typeof a&&a){var G=a[Symbol.toPrimitive];if(void 0!==G){a=G.call(a,"string");if("object"!=typeof a)break a;throw new TypeError("@@toPrimitive must return a primitive value.");}a=String(a)}}return(q="symbol"==typeof a?a:a+"")in m?Object.defineProperty(m,q,{value:v,enumerable:!0,configurable:!0,writable:!0}):m[q]=v,m}function U(m){"@babel/helpers - typeof";return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?
function(q){return typeof q}:function(q){return q&&"function"==typeof Symbol&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},U(m)}function Lc(m){var q=[];if("undefined"!==typeof m.options)for(var v=0;v<m.options.length;v++)m.options[v].selected&&q.push(m.options[v].value);return q.join(", ")}function nc(){var m=Mc("xxxxxxxx","[x]");var q=Date.now().toString();return m+q}function oc(){return Mc("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx","[xy]")}function Mc(m,q){var v=(new Date).getTime();
return m.replace(new RegExp(q,"g"),function(a){var G=(v+16*Math.random())%16|0;return("x"===a?G:G&3|8).toString(16)})}function I(){return Math.floor((new Date).getTime()/1E3)}function $a(){var m=(new Date).getTime();Hb>=m?Hb++:Hb=m;return Hb}function w(m,q,v){if(q&&Object.keys(q).length){if("undefined"!==typeof q[m])return q[m]}else if("undefined"!==typeof t[m])return t[m];return v}function pc(m,q,v){for(var a in t.i)t.i[a].tracking_crashes&&t.i[a].recordError(m,q,v)}function qc(m,q){var v=[],a;for(a in m)v.push(a+
"="+encodeURIComponent(m[a]));var G=v.join("&");return q?Nc(G,q).then(function(c){return G+="&checksum256="+c}):Promise.resolve(G)}function Ja(m){return"string"===typeof m&&"/"===m.substring(m.length-1)?m.substring(0,m.length-1):m}function pb(m,q){for(var v={},a,G=0,c=q.length;G<c;G++)a=q[G],"undefined"!==typeof m[a]&&(v[a]=m[a]);return v}function ra(m,q,v,a,G,c){var d={};if(m){if(Object.keys(m).length>a){var g={},h=0,n;for(n in m)h<a&&(g[n]=m[n],h++);m=g}for(var l in m)a=C(l,q,G,c),g=C(m[l],v,G,
c),d[a]=g}return d}function C(m,q,v,a){var G=m;"number"===typeof m&&(m=m.toString());"string"===typeof m&&m.length>q&&(G=m.substring(0,q),a(f.DEBUG,v+", Key: [ "+m+" ] is longer than accepted length. It will be truncated."));return G}function Nc(m,q){m=(new TextEncoder).encode(m+q);return crypto.subtle.digest("SHA-256",m).then(function(v){return Array.from(new Uint8Array(v)).map(function(a){return a.toString(16).padStart(2,"0")}).join("")})}function E(m,q,v){A&&(null===m||"undefined"===typeof m?Ib()&&
console.warn("[WARNING] [Countly] add_event_listener, Can't bind ["+q+"] event to nonexisting element"):"undefined"!==typeof m.addEventListener?m.addEventListener(q,v,!1):m.attachEvent("on"+q,v))}function Jb(m){return m?"undefined"!==typeof m.target?m.target:m.srcElement:window.event.srcElement}function ab(m){if(m)return m;(m=navigator.userAgent)||(m=rc());return m}function rc(m){if(m)return m;m="";navigator.userAgentData&&(m=navigator.userAgentData.brands.map(function(q){return q.brand+":"+q.version}).join(),
m+=navigator.userAgentData.mobile?" mobi ":" ",m+=navigator.userAgentData.platform);return m}function sc(m){if(!m){if(navigator.userAgentData&&navigator.userAgentData.mobile)return"phone";m=ab()}m=m.toLowerCase();var q="desktop",v=/(mobi|ipod|phone|blackberry|opera mini|fennec|minimo|symbian|psp|nintendo ds|archos|skyfire|puffin|blazer|bolt|gobrowser|iris|maemo|semc|teashark|uzard)/;/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(m)?
q="tablet":v.test(m)&&(q="phone");return q}function Oc(m){var q=/(CountlySiteBot|nuhk|Googlebot|GoogleSecurityScanner|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver|bingbot|Google Web Preview|Mediapartners-Google|AdsBot-Google|Baiduspider|Ezooms|YahooSeeker|AltaVista|AVSearch|Mercator|Scooter|InfoSeek|Ultraseek|Lycos|Wget|YandexBot|Yandex|YaDirectFetcher|SiteBot|Exabot|AhrefsBot|MJ12bot|TurnitinBot|magpie-crawler|Nutch Crawler|CMS Crawler|rogerbot|Domnutch|ssearch_bot|XoviBot|netseer|digincore|fr-crawler|wesee|AliasIO|contxbot|PingdomBot|BingPreview|HeadlessChrome|Lighthouse)/;
if(m)return q.test(m);m=q.test(ab());q=q.test(rc());return m||q}function tc(m){"undefined"===typeof m.pageY&&"number"===typeof m.clientX&&document.documentElement&&(m.pageX=m.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,m.pageY=m.clientY+document.body.scrollTop+document.documentElement.scrollTop);return m}function Kb(){var m=document;return Math.max(Math.max(m.body.scrollHeight,m.documentElement.scrollHeight),Math.max(m.body.offsetHeight,m.documentElement.offsetHeight),Math.max(m.body.clientHeight,
m.documentElement.clientHeight))}function uc(){var m=document;return Math.max(Math.max(m.body.scrollWidth,m.documentElement.scrollWidth),Math.max(m.body.offsetWidth,m.documentElement.offsetWidth),Math.max(m.body.clientWidth,m.documentElement.clientWidth))}function Pc(){var m=document;return Math.min(Math.min(m.body.clientHeight,m.documentElement.clientHeight),Math.min(m.body.offsetHeight,m.documentElement.offsetHeight),window.innerHeight)}function Qc(m,q,v,a,G,c){m=document.createElement(m);var d;
m.setAttribute(q,v);m.setAttribute(a,G);q=function(){d||c();d=!0};c&&(m.onreadystatechange=q,m.onload=q);document.getElementsByTagName("head")[0].appendChild(m)}function Rc(m,q){Qc("script","type","text/javascript","src",m,q)}function Lb(m,q){Qc("link","rel","stylesheet","href",m,q)}function Sc(){if(A){var m=document.getElementById("cly-loader");if(!m){var q=document.head||document.getElementsByTagName("head")[0],v=document.createElement("style");v.type="text/css";v.styleSheet?v.styleSheet.cssText=
"#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}":v.appendChild(document.createTextNode("#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}"));
q.appendChild(v);m=document.createElement("div");m.setAttribute("id","cly-loader");window.addEventListener("load",function(){if(t.showLoaderProtection)Ib()&&console.warn("[WARNING] [Countly] showLoader, Loader is already on");else try{document.body.appendChild(m)}catch(a){Ib()&&console.error("[ERROR] [Countly] showLoader, Body is not loaded for loader to append: "+a)}})}m.style.display="block"}}function Ib(){return t&&t.debug&&"undefined"!==typeof console?!0:!1}function Tc(){if(A){t.showLoaderProtection=
!0;var m=document.getElementById("cly-loader");m&&(m.style.display="none")}}function qd(m){var q=document.createElement("script"),v=document.createElement("script");q.async=!0;v.async=!0;q.src=t.customSourceBoomerang||Uc.BOOMERANG_SRC;v.src=t.customSourceCountlyBoomerang||Uc.CLY_BOOMERANG_SRC;document.getElementsByTagName("head")[0].appendChild(q);document.getElementsByTagName("head")[0].appendChild(v);var a=!1,G=!1;q.onload=function(){a=!0};v.onload=function(){G=!0};var c=0,d=setInterval(function(){c+=
50;if(a&&G||1500<=c){if(t.debug){var g="BoomerangJS loaded:["+a+"], countly_boomerang loaded:["+G+"].";a&&G?console.log("[DEBUG] "+g):console.warn("[WARNING] "+g+" Initializing without APM.")}t.init(m);clearInterval(d)}},50)}var R={NPS:"[CLY]_nps",SURVEY:"[CLY]_survey",STAR_RATING:"[CLY]_star_rating",VIEW:"[CLY]_view",ORIENTATION:"[CLY]_orientation",ACTION:"[CLY]_action"},rd=Object.values(R),f={ERROR:"[ERROR] ",WARNING:"[WARNING] ",INFO:"[INFO] ",DEBUG:"[DEBUG] ",VERBOSE:"[VERBOSE] "},Uc={BOOMERANG_SRC:"https://cdn.jsdelivr.net/npm/countly-sdk-web@latest/plugin/boomerang/boomerang.min.js",
CLY_BOOMERANG_SRC:"https://cdn.jsdelivr.net/npm/countly-sdk-web@latest/plugin/boomerang/countly_boomerang.js"},Q=Object.freeze({errorCount:"cly_hc_error_count",warningCount:"cly_hc_warning_count",statusCode:"cly_hc_status_code",errorMessage:"cly_hc_error_message",backoffCount:"cly_hc_backoff_count",consecutiveBackoffCount:"cly_hc_consecutive_backoff_count"}),Vc=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?::([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?::([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,
A="undefined"!==typeof window,t=globalThis.Countly||{},Hb=0,qb=new WeakMap,Wc=new WeakMap,bb=new WeakMap,ca=new WeakMap,rb=new WeakMap,Ka=new WeakMap,cb=new WeakMap,L=new WeakMap,O=new WeakMap,V=new WeakMap,sa=new WeakMap,fa=new WeakMap,ha=new WeakMap,sb=new WeakMap,La=new WeakMap,la=new WeakMap,tb=new WeakMap,X=new WeakMap,Ma=new WeakMap,Na=new WeakMap,ub=new WeakMap,db=new WeakMap,Oa=new WeakMap,Da=new WeakMap,ma=new WeakMap,Pa=new WeakMap,eb=new WeakMap,fb=new WeakMap,N=new WeakMap,ia=new WeakMap,
ta=new WeakMap,Mb=new WeakMap,ua=new WeakMap,Ea=new WeakMap,J=new WeakMap,Qa=new WeakMap,Ra=new WeakMap,vb=new WeakMap,va=new WeakMap,gb=new WeakMap,na=new WeakMap,wa=new WeakMap,oa=new WeakMap,wb=new WeakMap,M=new WeakMap,xb=new WeakMap,vc=new WeakMap,Sa=new WeakMap,hb=new WeakMap,ib=new WeakMap,jb=new WeakMap,xa=new WeakMap,Nb=new WeakMap,pa=new WeakMap,Fa=new WeakMap,Ta=new WeakMap,kb=new WeakMap,Ob=new WeakMap,lb=new WeakMap,mb=new WeakMap,yb=new WeakMap,zb=new WeakMap,Pb=new WeakMap,Qb=new WeakMap,
nb=new WeakMap,Ua=new WeakMap,Rb=new WeakMap,K=new WeakMap,H=new WeakMap,Y=new WeakMap,Va=new WeakMap,ya=new WeakMap,za=new WeakMap,Sb=new WeakMap,Tb=new WeakMap,Ub=new WeakMap,Vb=new WeakMap,Wb=new WeakMap,Xb=new WeakMap,Yb=new WeakMap,wc=new WeakMap,Wa=new WeakMap,Ga=new WeakMap,Xa=new WeakMap,Ab=new WeakMap,Bb=new WeakMap,Cb=new WeakMap,Zb=new WeakMap,$b=new WeakMap,ac=new WeakMap,Xc=new WeakMap,xc=new WeakMap,da=new WeakMap,yc=new WeakMap,ja=new WeakMap,qa=new WeakMap,zc=new WeakMap,Ac=new WeakMap,
bc=new WeakMap,cc=new WeakMap,Bc=new WeakMap,Ha=new WeakMap,Yc=new WeakMap,dc=new WeakMap,Zc=new WeakMap,Cc=new WeakMap,$c=new WeakMap,ad=new WeakMap,ec=new WeakMap,Aa=new WeakMap,fc=new WeakMap,Dc=new WeakMap,gc=new WeakMap,bd=new WeakMap,Ec=new WeakMap,Ya=new WeakMap,W=new WeakMap,Db=new WeakMap,cd=new WeakMap,dd=new WeakMap,Ba=new WeakMap,hc=new WeakMap,ed=new WeakMap,Fc=new WeakMap,Eb=new WeakMap,Fb=new WeakMap,ic=new WeakMap,e=new WeakMap,ea=new WeakMap,Gc=new WeakMap,Hc=new WeakMap,jc=new WeakMap,
kc=new WeakMap,Ic=new WeakMap,lc=new WeakMap,fd=new WeakMap,Jc=new WeakMap,gd=new WeakMap,hd=new WeakMap,id=new WeakMap,jd=new WeakMap,Kc=new WeakMap,B=new WeakMap,y=new WeakMap,Z=new WeakMap,kd=new WeakMap,ld=new WeakMap,md=new WeakMap,nd=new WeakMap,ka=new WeakMap,od=function(m,q,v){return Object.defineProperty(m,"prototype",{writable:!1}),m}(function v(q){var a=this;if(!(this instanceof v))throw new TypeError("Cannot call a class as a function");p(this,qb,void 0);p(this,Wc,void 0);p(this,bb,void 0);
p(this,ca,void 0);p(this,rb,void 0);p(this,Ka,void 0);p(this,cb,void 0);p(this,L,void 0);p(this,O,void 0);p(this,V,void 0);p(this,sa,void 0);p(this,fa,void 0);p(this,ha,void 0);p(this,sb,void 0);p(this,La,void 0);p(this,la,void 0);p(this,tb,void 0);p(this,X,void 0);p(this,Ma,void 0);p(this,Na,void 0);p(this,ub,void 0);p(this,db,void 0);p(this,Oa,void 0);p(this,Da,void 0);p(this,ma,void 0);p(this,Pa,void 0);p(this,eb,void 0);p(this,fb,void 0);p(this,N,void 0);p(this,ia,void 0);p(this,ta,void 0);p(this,
Mb,void 0);p(this,ua,void 0);p(this,Ea,void 0);p(this,J,void 0);p(this,Qa,void 0);p(this,Ra,void 0);p(this,vb,void 0);p(this,va,void 0);p(this,gb,void 0);p(this,na,void 0);p(this,wa,void 0);p(this,oa,void 0);p(this,wb,void 0);p(this,M,void 0);p(this,xb,void 0);p(this,vc,void 0);p(this,Sa,void 0);p(this,hb,void 0);p(this,ib,void 0);p(this,jb,void 0);p(this,xa,void 0);p(this,Nb,void 0);p(this,pa,void 0);p(this,Fa,void 0);p(this,Ta,void 0);p(this,kb,void 0);p(this,Ob,void 0);p(this,lb,void 0);p(this,
mb,void 0);p(this,yb,void 0);p(this,zb,void 0);p(this,Pb,void 0);p(this,Qb,void 0);p(this,nb,void 0);p(this,Ua,void 0);p(this,Rb,void 0);p(this,K,void 0);p(this,H,void 0);p(this,Y,void 0);p(this,Va,void 0);p(this,ya,void 0);p(this,za,void 0);p(this,Sb,void 0);p(this,Tb,void 0);p(this,Ub,void 0);p(this,Vb,void 0);p(this,Wb,void 0);p(this,Xb,void 0);p(this,Yb,void 0);p(this,wc,void 0);p(this,Wa,void 0);p(this,Ga,void 0);p(this,Xa,void 0);p(this,Ab,void 0);p(this,Bb,void 0);p(this,Cb,void 0);p(this,
Zb,void 0);p(this,$b,function(){if("[CLY]_temp_id"===a.device_id)b(e,a).call(a,f.INFO,"server_config, Device ID is temporary, not fetching server config");else if(b(wc,a))b(e,a).call(a,f.INFO,"server_config, SDK behavior sync is disabled, not fetching server config");else{b(e,a).call(a,f.INFO,"server_config, Fetching server config");var c={};c.app_key=a.app_key;c.device_id=a.device_id;c.sdk_version=b(oa,a);c.sdk_name=b(wa,a);c.t=b(J,a);c.timestamp=$a();var d=new Date;c.hour=d.getHours();c.dow=d.getDay();
c.av=a.app_version;c.method="sc";b(ea,a).call(a,"server_config",a.url+b(Ka,a),c,function(g,h,n){if(!g)try{var l=JSON.parse(n);b(e,a).call(a,f.INFO,"server_config, Config fetched successfully:["+JSON.stringify(l)+"]");l&&b(ac,a).call(a,l);b(y,a).call(a,"cly_config",JSON.stringify(l))}catch(r){b(e,a).call(a,f.ERROR,"server_config, Had an issue while parsing the response: "+r)}},!0,!0);setTimeout(function(){b($b,a).call(a)},36E5*b(Ob,a))}});p(this,ac,function(c){c&&c.c&&"object"===U(c.c)&&(c=c.c,c.hasOwnProperty("networking")&&
k(Nb,a,c.networking),c.hasOwnProperty("tracking")&&k(lb,a,c.tracking),c.hasOwnProperty("rqs")&&k(pa,a,c.rqs),c.hasOwnProperty("eqs")&&k(Fa,a,c.eqs),c.hasOwnProperty("sui")&&k(Ta,a,c.sui),c.hasOwnProperty("czi")&&14<c.czi&&k(kb,a,1E3*c.czi),c.hasOwnProperty("ecz")&&(k(nb,a,c.ecz),!b(Xb,a)&&b(nb,a)&&b(Ha,a).call(a)),c.hasOwnProperty("cr")&&k(Ua,a,c.cr),c.hasOwnProperty("st")&&k(mb,a,c.st),c.hasOwnProperty("crt")&&k(zb,a,c.crt),c.hasOwnProperty("vt")&&k(yb,a,c.vt),c.hasOwnProperty("cet")&&k(Pb,a,c.cet),
c.hasOwnProperty("lkl")&&k(K,a,c.lkl),c.hasOwnProperty("lvs")&&k(H,a,c.lvs),c.hasOwnProperty("lsv")&&k(Y,a,c.lsv),c.hasOwnProperty("lbc")&&k(Va,a,c.lbc),c.hasOwnProperty("ltlpt")&&k(ya,a,c.ltlpt),c.hasOwnProperty("ltl")&&k(za,a,c.ltl),c.hasOwnProperty("scui")&&k(Ob,a,Math.max(c.scui,4)),c.hasOwnProperty("lt")&&k(Qb,a,c.lt),c.hasOwnProperty("rcz")&&k(Rb,a,c.rcz),c.hasOwnProperty("bom")&&k(Sb,a,c.bom),c.hasOwnProperty("bom_at")&&k(Tb,a,c.bom_at),c.hasOwnProperty("bom_rqp")&&k(Ub,a,c.bom_rqp),c.hasOwnProperty("bom_ra")&&
k(Vb,a,c.bom_ra),c.hasOwnProperty("bom_d")&&k(Wb,a,c.bom_d))});p(this,Xc,function(c){k(ha,a,w("ignore_referrers",c,[]));k(db,a,w("fail_timeout",c,60));k(Oa,a,w("inactivity_time",c,20));k(ma,a,w("use_session_cookie",c,!0));k(Pa,a,w("session_cookie_timeout",c,30));k(N,a,w("offline_mode",c,!1));k(wa,a,w("sdk_name",c,"javascript_native_web"));k(oa,a,w("sdk_version",c,"25.4.1"));k(cb,a,w("interval",c,500));a.getViewName=w("getViewName",c,t.getViewName);a.getViewUrl=w("getViewUrl",c,t.getViewUrl);a.getSearchQuery=
w("getSearchQuery",c,t.getSearchQuery);a.DeviceIdType=t.DeviceIdType;a.namespace=w("namespace",c,"");a.clearStoredId=w("clear_stored_id",c,!1);a.onload=w("onload",c,[]);a.utm=w("utm",c,{source:!0,medium:!0,campaign:!0,term:!0,content:!0});a.ignore_prefetch=w("ignore_prefetch",c,!0);a.rcAutoOptinAb=w("rc_automatic_optin_for_ab",c,!0);a.useExplicitRcApi=w("use_explicit_rc_api",c,!1);a.debug=w("debug",c,!1);a.test_mode=w("test_mode",c,!1);a.test_mode_eq=w("test_mode_eq",c,!1);a.metrics=w("metrics",c,
{});a.headers=w("headers",c,{});a.app_version=w("app_version",c,"0.0");a.country_code=w("country_code",c,null);a.city=w("city",c,null);a.ip_address=w("ip_address",c,null);a.ignore_bots=w("ignore_bots",c,!0);a.force_post=w("force_post",c,!1);a.remote_config=w("remote_config",c,!1);a.ignore_visitor=w("ignore_visitor",c,!1);a.track_domains=A?w("track_domains",c,!0):void 0;a.storage=w("storage",c,"default");a.enableOrientationTracking=A?w("enable_orientation_tracking",c,!0):void 0;a.heatmapWhitelist=
w("heatmap_whitelist",c,[]);a.contentWhitelist=w("content_whitelist",c,[]);a.salt=w("salt",c,null);a.hcErrorCount=b(B,a).call(a,Q.errorCount)||0;a.hcWarningCount=b(B,a).call(a,Q.warningCount)||0;a.hcStatusCode=b(B,a).call(a,Q.statusCode)||-1;a.hcErrorMessage=b(B,a).call(a,Q.errorMessage)||"";a.hcBackoffCount=b(B,a).call(a,Q.backoffCount)||0;a.hcConsecutiveBackoffCount=b(B,a).call(a,Q.consecutiveBackoffCount)||0;k(Bb,a,!1);k(jb,a,w("crash_filter_callback",c,null));"cookie"===a.storage&&k(ua,a,!1);
a.rcAutoOptinAb||a.useExplicitRcApi||(b(e,a).call(a,f.WARNING,"initialize, Auto opting is disabled, switching to explicit RC API"),a.useExplicitRcApi=!0);Array.isArray(b(ha,a))||k(ha,a,[]);""===a.url&&(b(e,a).call(a,f.ERROR,"initialize, Please provide server URL"),a.ignore_visitor=!0);b(B,a).call(a,"cly_ignore")&&(a.ignore_visitor=!0);b(Bc,a).call(a);if(A)if(window.name&&0===window.name.indexOf("cly:"))try{a.passed_data=JSON.parse(window.name.replace("cly:",""))}catch(D){b(e,a).call(a,f.ERROR,"initialize, Could not parse name: "+
window.name+", error: "+D)}else if(location.hash&&0===location.hash.indexOf("this.#cly:"))try{a.passed_data=JSON.parse(location.hash.replace("this.#cly:",""))}catch(D){b(e,a).call(a,f.ERROR,"initialize, Could not parse hash: "+location.hash+", error: "+D)}Array.isArray(a.contentWhitelist)&&(a.contentWhitelist.push(a.url),a.contentWhitelist=a.contentWhitelist.map(function(D){return Ja(D)}));if((a.passed_data&&a.passed_data.app_key&&a.passed_data.app_key===a.app_key||a.passed_data&&!a.passed_data.app_key&&
b(bb,a))&&a.passed_data.token&&a.passed_data.purpose){a.passed_data.token!==b(B,a).call(a,"cly_old_token")&&(b(Jc,a).call(a,a.passed_data.token),b(y,a).call(a,"cly_old_token",a.passed_data.token));var d=[];Array.isArray(a.heatmapWhitelist)?(a.heatmapWhitelist.push(a.url),d=a.heatmapWhitelist.map(function(D){return Ja(D)})):d=[a.url];d.includes(a.passed_data.url)&&"heatmap"===a.passed_data.purpose&&(a.ignore_visitor=!0,Sc(),Rc(a.passed_data.url+"/views/heatmap.js",Tc))}if(a.ignore_visitor)b(e,a).call(a,
f.WARNING,"initialize, ignore_visitor:["+a.ignore_visitor+"], this user will not be tracked");else{b(kd,a).call(a);k(L,a,b(B,a).call(a,"cly_queue")||[]);k(O,a,b(B,a).call(a,"cly_event")||[]);k(V,a,b(B,a).call(a,"cly_remote_configs")||{});d="[CLY]_temp_id"===b(B,a).call(a,"cly_id");a.clearStoredId&&(b(B,a).call(a,"cly_id")&&!d&&(a.device_id=b(B,a).call(a,"cly_id"),b(e,a).call(a,f.DEBUG,"initialize, temporarily using the previous device ID to flush existing events"),k(J,a,b(B,a).call(a,"cly_id_type")),
b(J,a)||(b(e,a).call(a,f.DEBUG,"initialize, No device ID type info from the previous session, falling back to DEVELOPER_SUPPLIED, for event flushing"),k(J,a,0)),b(Aa,a).call(a),a.device_id=void 0,k(J,a,1)),b(e,a).call(a,f.INFO,"initialize, Clearing the device ID storage"),b(Z,a).call(a,"cly_id"),b(Z,a).call(a,"cly_id_type"),b(Z,a).call(a,"cly_session"),d=!1);"javascript_native_web"===b(wa,a)&&"25.4.1"===b(oa,a)?b(e,a).call(a,f.DEBUG,"initialize, SDK name:["+b(wa,a)+"], version:["+b(oa,a)+"]"):b(e,
a).call(a,f.DEBUG,"initialize, SDK name:["+b(wa,a)+"], version:["+b(oa,a)+"], default name:[javascript_native_web] and default version:[25.4.1]");b(e,a).call(a,f.DEBUG,"initialize, stored server config:["+JSON.stringify(b(xa,a))+"]");b(e,a).call(a,f.DEBUG,"initialize, app_key:["+a.app_key+"], url:["+a.url+"]");b(e,a).call(a,f.DEBUG,"initialize, device_id:["+w("device_id",c,void 0)+"]");b(e,a).call(a,f.DEBUG,"initialize, require_consent is enabled:["+b(Ua,a)+"]");try{b(e,a).call(a,f.DEBUG,"initialize, metric override:["+
JSON.stringify(a.metrics)+"]"),b(e,a).call(a,f.DEBUG,"initialize, header override:["+JSON.stringify(a.headers)+"]"),b(e,a).call(a,f.DEBUG,"initialize, number of onload callbacks provided:["+a.onload.length+"]"),b(e,a).call(a,f.DEBUG,"initialize, utm tags:["+JSON.stringify(a.utm)+"]"),b(ha,a)&&b(e,a).call(a,f.DEBUG,"initialize, referrers to ignore :["+JSON.stringify(b(ha,a))+"]"),b(e,a).call(a,f.DEBUG,"initialize, salt given:["+!!a.salt+"]")}catch(D){b(e,a).call(a,f.ERROR,"initialize, Could not stringify some config object values")}b(e,
a).call(a,f.DEBUG,"initialize, app_version:["+a.app_version+"]");b(e,a).call(a,f.DEBUG,"initialize, provided location info; country_code:["+a.country_code+"], city:["+a.city+"], ip_address:["+a.ip_address+"]");""!==a.namespace&&b(e,a).call(a,f.DEBUG,"initialize, namespace given:["+a.namespace+"]");a.clearStoredId&&b(e,a).call(a,f.DEBUG,"initialize, clearStoredId flag set to:["+a.clearStoredId+"]");a.ignore_prefetch&&b(e,a).call(a,f.DEBUG,"initialize, ignoring pre-fetching and pre-rendering from counting as real website visits :["+
a.ignore_prefetch+"]");a.test_mode&&b(e,a).call(a,f.WARNING,"initialize, test_mode:["+a.test_mode+"], request queue won't be processed");a.test_mode_eq&&b(e,a).call(a,f.WARNING,"initialize, test_mode_eq:["+a.test_mode_eq+"], event queue won't be processed");a.heatmapWhitelist&&b(e,a).call(a,f.DEBUG,"initialize, heatmap whitelist:["+JSON.stringify(a.heatmapWhitelist)+"], these domains will be whitelisted");"default"!==a.storage&&b(e,a).call(a,f.DEBUG,"initialize, storage is set to:["+a.storage+"]");
a.ignore_bots&&b(e,a).call(a,f.DEBUG,"initialize, ignore traffic from bots :["+a.ignore_bots+"]");a.force_post&&b(e,a).call(a,f.DEBUG,"initialize, forced post method for all requests:["+a.force_post+"]");a.remote_config&&b(e,a).call(a,f.DEBUG,"initialize, remote_config callback provided:["+!!a.remote_config+"]");"boolean"===typeof a.rcAutoOptinAb&&b(e,a).call(a,f.DEBUG,"initialize, automatic RC optin is enabled:["+a.rcAutoOptinAb+"]");a.useExplicitRcApi||b(e,a).call(a,f.WARNING,"initialize, will use legacy RC API. Consider enabling new API during init with use_explicit_rc_api flag");
a.track_domains&&b(e,a).call(a,f.DEBUG,"initialize, tracking domain info:["+a.track_domains+"]");a.enableOrientationTracking&&b(e,a).call(a,f.DEBUG,"initialize, enableOrientationTracking:["+a.enableOrientationTracking+"]");b(ma,a)||b(e,a).call(a,f.WARNING,"initialize, use_session_cookie is enabled:["+b(ma,a)+"]");b(N,a)&&b(e,a).call(a,f.DEBUG,"initialize, offline_mode:["+b(N,a)+"], user info won't be send to the servers");b(V,a)&&b(e,a).call(a,f.DEBUG,"initialize, stored remote configs:["+JSON.stringify(b(V,
a))+"]");b(kb,a)&&b(e,a).call(a,f.DEBUG,"initialize, content_zone_timer_interval:["+b(kb,a)+"]");b(e,a).call(a,f.DEBUG,"initialize, 'getViewName' callback override provided:["+(a.getViewName!==t.getViewName)+"]");b(e,a).call(a,f.DEBUG,"initialize, 'getSearchQuery' callback override provided:["+(a.getSearchQuery!==t.getSearchQuery)+"]");128!==b(K,a)&&b(e,a).call(a,f.DEBUG,"initialize, maxKeyLength set to:["+b(K,a)+"] characters");256!==b(H,a)&&b(e,a).call(a,f.DEBUG,"initialize, maxValueSize set to:["+
b(H,a)+"] characters");100!==b(Y,a)&&b(e,a).call(a,f.DEBUG,"initialize, maxSegmentationValues set to:["+b(Y,a)+"] key/value pairs");100!==b(Va,a)&&b(e,a).call(a,f.DEBUG,"initialize, maxBreadcrumbCount for custom logs set to:["+b(Va,a)+"] entries");30!==b(ya,a)&&b(e,a).call(a,f.DEBUG,"initialize, maxStackTraceLinesPerThread set to:["+b(ya,a)+"] lines");200!==b(za,a)&&b(e,a).call(a,f.DEBUG,"initialize, maxStackTraceLineLength set to:["+b(za,a)+"] characters");500!==b(cb,a)&&b(e,a).call(a,f.DEBUG,"initialize, interval for heartbeats set to:["+
b(cb,a)+"] milliseconds");1E3!==b(pa,a)&&b(e,a).call(a,f.DEBUG,"initialize, queue_size set to:["+b(pa,a)+"] items max");60!==b(db,a)&&b(e,a).call(a,f.DEBUG,"initialize, fail_timeout set to:["+b(db,a)+"] seconds of wait time after a failed connection to server");20!==b(Oa,a)&&b(e,a).call(a,f.DEBUG,"initialize, inactivity_time set to:["+b(Oa,a)+"] minutes to consider a user as inactive after no observable action");60!==b(Ta,a)&&b(e,a).call(a,f.DEBUG,"initialize, session_update set to:["+b(Ta,a)+"] seconds to check if extending a session is needed while the user is active");
100!==b(Fa,a)&&b(e,a).call(a,f.DEBUG,"initialize, max_events set to:["+b(Fa,a)+"] events to send in one batch");30!==b(Pa,a)&&b(e,a).call(a,f.DEBUG,"initialize, session_cookie_timeout set to:["+b(Pa,a)+"] minutes to expire a cookies session");var g=null,h=a.getSearchQuery(),n=!1,l={};if(h){0===h.indexOf("?")&&(h=h.substring(1));h=h.split("&");for(var r=0;r<h.length;r++){var u=h[r].split("=");"cly_id"===u[0]?b(y,a).call(a,"cly_cmp_id",u[1]):"cly_uid"===u[0]?b(y,a).call(a,"cly_cmp_uid",u[1]):"cly_device_id"===
u[0]?g=u[1]:0===(u[0]+"").indexOf("utm_")&&a.utm[u[0].replace("utm_","")]&&(l[u[0].replace("utm_","")]=u[1],n=!0)}}h=w("device_id",c,void 0);"number"===typeof h&&(h=h.toString());b(B,a).call(a,"cly_id")&&!d?(a.device_id=b(B,a).call(a,"cly_id"),b(e,a).call(a,f.INFO,"initialize, Set the stored device ID"),k(J,a,b(B,a).call(a,"cly_id_type")),b(J,a)||(b(e,a).call(a,f.INFO,"initialize, No device ID type info from the previous session, falling back to DEVELOPER_SUPPLIED"),k(J,a,0)),k(N,a,!1)):null!==g?
(b(e,a).call(a,f.INFO,"initialize, Device ID set by URL"),a.device_id=g,k(J,a,3),k(N,a,!1)):h?(b(e,a).call(a,f.INFO,"initialize, Device ID set by developer"),a.device_id=h,c&&Object.keys(c).length?void 0!==c.device_id&&k(J,a,0):void 0!==t.device_id&&k(J,a,0),k(N,a,!1)):b(N,a)||d?(a.device_id="[CLY]_temp_id",k(J,a,2),b(N,a)&&d?b(e,a).call(a,f.INFO,"initialize, Temp ID set, continuing offline mode from previous app session"):b(N,a)&&!d?b(e,a).call(a,f.INFO,"initialize, Temp ID set, entering offline mode"):
(k(N,a,!0),b(e,a).call(a,f.INFO,"initialize, Temp ID set, enabling offline mode"))):(b(e,a).call(a,f.INFO,"initialize, Generating the device ID"),a.device_id=w("device_id",c,b(hc,a).call(a)),c&&Object.keys(c).length?void 0!==c.device_id&&k(J,a,0):void 0!==t.device_id&&k(J,a,0));b(y,a).call(a,"cly_id",a.device_id);b(y,a).call(a,"cly_id_type",b(J,a));if(n){k(na,a,{});for(var z in a.utm)l[z]?(a.userData.set("utm_"+z,l[z]),b(na,a)[z]=l[z]):a.userData.unset("utm_"+z);a.userData.save()}b($b,a).call(a)}});
p(this,xc,function(){b(qb,a)&&(clearTimeout(b(qb,a)),k(qb,a,null));k(qb,a,setTimeout(function(){for(var c={},d=0;d<t.features.length;d++)!0===b(M,a)[t.features[d]].optin?c[t.features[d]]=!0:c[t.features[d]]=!1;b(W,a).call(a,{consent:JSON.stringify(c)});b(e,a).call(a,f.DEBUG,"Consent update request has been sent to the queue.")},1E3))});x(this,"halt",function(){b(e,a).call(a,f.WARNING,"halt, Resetting Countly");t.i=void 0;t.q=[];t.noHeartBeat=void 0;k(bb,a,!t.i);k(ca,a,!1);k(rb,a,"/i");k(Ka,a,"/o/sdk");
k(cb,a,500);k(pa,a,1E3);k(L,a,[]);k(O,a,[]);k(V,a,{});k(sa,a,[]);k(fa,a,{});k(ha,a,[]);k(sb,a,null);k(La,a,!0);k(tb,a,0);k(X,a,null);k(Ma,a,0);k(Na,a,0);k(ub,a,0);k(db,a,60);k(Oa,a,20);k(Da,a,0);k(Ta,a,60);k(Fa,a,100);k(ma,a,!0);k(Pa,a,30);k(eb,a,!0);k(fb,a,!1);k(N,a,!1);k(ia,a,{});k(ta,a,!0);k(Mb,a,I());k(ua,a,!0);k(Ea,a,null);k(J,a,1);k(Qa,a,!1);k(Ra,a,0);k(vb,a,!1);k(va,a,null);k(gb,a,null);k(na,a,null);k(xb,a,[]);try{localStorage.setItem("cly_testLocal",!0),localStorage.removeItem("cly_testLocal"),
localStorage.removeItem("cly_old_token"),localStorage.removeItem("cly_cmp_id"),localStorage.removeItem("cly_cmp_uid"),localStorage.removeItem("cly_id"),localStorage.removeItem("cly_id_type"),localStorage.removeItem("cly_queue"),localStorage.removeItem("cly_session"),localStorage.removeItem("cly_remote_configs"),localStorage.removeItem("cly_event"),localStorage.removeItem("cly_ignore"),localStorage.removeItem("cly_fb_widgets"),localStorage.removeItem("cly_token"),localStorage.removeItem("cly_hc_error_count"),
localStorage.removeItem("cly_hc_warning_count"),localStorage.removeItem("cly_hc_status_code"),localStorage.removeItem("cly_hc_error_message"),localStorage.removeItem("cly_hc_backoff_count"),localStorage.removeItem("cly_hc_consecutive_backoff_count")}catch(d){b(e,a).call(a,f.ERROR,"halt, Local storage test failed, will fallback to cookies"),k(ua,a,!1)}t.features="sessions events views scrolls clicks forms crashes attribution users star-rating location apm feedback remote-config".split(" ");k(M,a,{});
for(var c=0;c<t.features.length;c++)b(M,a)[t.features[c]]={};a.app_key=void 0;a.device_id=void 0;a.onload=void 0;a.utm=void 0;a.ignore_prefetch=void 0;a.debug=void 0;a.test_mode=void 0;a.test_mode_eq=void 0;a.metrics=void 0;a.headers=void 0;a.url=void 0;a.app_version=void 0;a.country_code=void 0;a.city=void 0;a.ip_address=void 0;a.ignore_bots=void 0;a.force_post=void 0;a.rcAutoOptinAb=void 0;a.useExplicitRcApi=void 0;a.remote_config=void 0;a.ignore_visitor=void 0;k(Ua,a,void 0);a.track_domains=void 0;
a.storage=void 0;a.enableOrientationTracking=void 0;a.salt=void 0;k(K,a,void 0);k(H,a,void 0);k(Y,a,void 0);k(Va,a,void 0);k(ya,a,void 0);k(za,a,void 0)});x(this,"group_features",function(c){b(e,a).call(a,f.INFO,"group_features, Grouping features");if(c)for(var d in c)b(M,a)[d]?b(e,a).call(a,f.WARNING,"group_features, Feature name ["+d+"] is already reserved"):"string"===typeof c[d]?b(M,a)[d]={features:[c[d]]}:c[d]&&Array.isArray(c[d])&&c[d].length?b(M,a)[d]={features:c[d]}:b(e,a).call(a,f.ERROR,
"group_features, Incorrect feature list for ["+d+"] value: ["+c[d]+"]");else b(e,a).call(a,f.ERROR,"group_features, Incorrect features:["+c+"]")});x(this,"check_consent",function(c){b(e,a).call(a,f.INFO,"check_consent, Checking if consent is given for specific feature:["+c+"]");if(!b(Ua,a))return b(e,a).call(a,f.INFO,"check_consent, require_consent is off, no consent is necessary"),!0;if(b(M,a)[c])return!(!b(M,a)[c]||!b(M,a)[c].optin);b(e,a).call(a,f.ERROR,"check_consent, No feature available for ["+
c+"]");return!1});x(this,"get_device_id_type",function(){b(e,a).call(a,f.INFO,"check_device_id_type, Retrieving the current device id type.["+b(J,a)+"]");switch(b(J,a)){case 1:var c=a.DeviceIdType.SDK_GENERATED;break;case 3:case 0:c=a.DeviceIdType.DEVELOPER_SUPPLIED;break;case 2:c=a.DeviceIdType.TEMPORARY_ID;break;default:c=-1}return c});x(this,"get_device_id",function(){b(e,a).call(a,f.INFO,"get_device_id, Retrieving the device id: ["+a.device_id+"]");return a.device_id});x(this,"check_any_consent",
function(){b(e,a).call(a,f.INFO,"check_any_consent, Checking if any consent is given");if(!b(Ua,a))return b(e,a).call(a,f.INFO,"check_any_consent, require_consent is off, no consent is necessary"),!0;for(var c in b(M,a))if(b(M,a)[c]&&b(M,a)[c].optin)return!0;b(e,a).call(a,f.INFO,"check_any_consent, No consents given");return!1});x(this,"add_consent",function(c){b(e,a).call(a,f.INFO,"add_consent, Adding consent for ["+c+"]");if(Array.isArray(c))for(var d=0;d<c.length;d++)a.add_consent(c[d]);else b(M,
a)[c]?b(M,a)[c].features?(b(M,a)[c].optin=!0,a.add_consent(b(M,a)[c].features)):!0!==b(M,a)[c].optin&&(b(M,a)[c].optin=!0,b(xc,a).call(a),setTimeout(function(){"sessions"===c&&b(ia,a).begin_session?(a.begin_session.apply(a,b(ia,a).begin_session),b(ia,a).begin_session=null):"views"===c&&b(ia,a).track_pageview&&(k(X,a,null),a.track_pageview.apply(a,b(ia,a).track_pageview),b(ia,a).track_pageview=null)},1)):b(e,a).call(a,f.ERROR,"add_consent, No feature available for ["+c+"]")});x(this,"remove_consent",
function(c){b(e,a).call(a,f.INFO,"remove_consent, Removing consent for ["+c+"]");a.remove_consent_internal(c,!0)});x(this,"remove_consent_internal",function(c,d){d=d||!1;if(Array.isArray(c))for(var g=0;g<c.length;g++)a.remove_consent_internal(c[g],d);else b(M,a)[c]?b(M,a)[c].features?a.remove_consent_internal(b(M,a)[c].features,d):(b(M,a)[c].optin=!1,d&&!1!==b(M,a)[c].optin&&b(xc,a).call(a)):b(e,a).call(a,f.WARNING,"remove_consent, No feature available for ["+c+"]")});x(this,"enable_offline_mode",
function(){b(N,a)?b(e,a).call(a,f.WARNING,"enable_offline_mode, Countly is already in offline mode."):(b(e,a).call(a,f.INFO,"enable_offline_mode, Enabling offline mode"),a.remove_consent_internal(t.features,!1),k(N,a,!0),b(dc,a).call(a),a.device_id="[CLY]_temp_id",k(J,a,2))});x(this,"disable_offline_mode",function(c){if(b(N,a)){b(e,a).call(a,f.INFO,"disable_offline_mode, Disabling offline mode");k(N,a,!1);c&&a.device_id!==c?(a.device_id=c,k(J,a,0),b(y,a).call(a,"cly_id",a.device_id),b(y,a).call(a,
"cly_id_type",0),b(e,a).call(a,f.INFO,"disable_offline_mode, Changing id to: "+a.device_id)):(a.device_id=b(hc,a).call(a),"[CLY]_temp_id"===a.device_id&&(a.device_id=oc()),a.device_id!==b(B,a).call(a,"cly_id")&&(b(y,a).call(a,"cly_id",a.device_id),b(y,a).call(a,"cly_id_type",1)));c=!1;if(0<b(L,a).length)for(var d=0;d<b(L,a).length;d++)"[CLY]_temp_id"===b(L,a)[d].device_id&&(b(L,a)[d].device_id=a.device_id,b(L,a)[d].t=b(J,a),c=!0);c&&b(y,a).call(a,"cly_queue",b(L,a),!0);b(wb,a)&&(b(ka,a).sendInstantHCRequest(),
k(wb,a,!1));b($b,a).call(a);b(nb,a)&&(b(Ha,a).call(a),k(Xb,a,!0))}else b(e,a).call(a,f.WARNING,"disable_offline_mode, Countly was not in offline mode.")});x(this,"begin_session",function(c,d){if(b(mb,a))if(b(e,a).call(a,f.INFO,"begin_session, Starting the session. There was an ongoing session: ["+b(ca,a)+"]"),c&&b(e,a).call(a,f.INFO,"begin_session, Heartbeats are disabled"),d&&b(e,a).call(a,f.INFO,"begin_session, Session starts irrespective of session cookie"),a.check_consent("sessions")){if(!b(ca,
a)){if(a.enableOrientationTracking){b(yc,a).call(a);var g;E(window,"resize",function(){clearTimeout(g);g=setTimeout(function(){b(yc,a).call(a)},200)})}k(la,a,I());k(ca,a,!0);k(La,a,!c);c=b(B,a).call(a,"cly_session");b(e,a).call(a,f.VERBOSE,"begin_session, Session state, forced: ["+d+"], useSessionCookie: ["+b(ma,a)+"], seconds to expire: ["+(c-b(la,a))+"], expired: ["+(parseInt(c)<=I())+"] ");if(d||!b(ma,a)||!c||parseInt(c)<=I())b(e,a).call(a,f.INFO,"begin_session, Session started"),null===b(Ea,a)&&
k(Ea,a,!0),d={begin_session:1},d.metrics=JSON.stringify(b(Eb,a).call(a)),b(W,a).call(a,d);b(y,a).call(a,"cly_session",I()+60*b(Pa,a))}}else b(ia,a).begin_session=[c,d];else b(e,a).call(a,f.INFO,"begin_session, Session tracking is disabled by server config")});x(this,"session_duration",function(c){b(mb,a)?(b(e,a).call(a,f.INFO,"session_duration, Reporting session duration: ["+c+"]"),a.check_consent("sessions")&&(b(ca,a)?(b(e,a).call(a,f.INFO,"session_duration, Session extended: ["+c+"]"),b(W,a).call(a,
{session_duration:c}),b(Ec,a).call(a)):b(e,a).call(a,f.DEBUG,"session_duration, No session was started"))):b(e,a).call(a,f.INFO,"session_duration, Session tracking is disabled by server config")});x(this,"end_session",function(c,d){b(mb,a)||d?(b(e,a).call(a,f.INFO,"end_session, Ending the current session. There was an on going session:["+b(ca,a)+"]"),a.check_consent("sessions")&&b(ca,a)&&(c=c||I()-b(la,a),b(gc,a).call(a),!b(ma,a)||d?(b(e,a).call(a,f.INFO,"end_session, Session ended"),b(W,a).call(a,
{end_session:1,session_duration:c})):a.session_duration(c),k(ca,a,!1))):b(e,a).call(a,f.INFO,"end_session, Session tracking is disabled by server config")});x(this,"set_id",function(c){b(e,a).call(a,f.INFO,"set_id, Changing the device ID to:["+c+"]");null==c||""===c?b(e,a).call(a,f.WARNING,"set_id, The provided device is not a valid ID"):0===b(J,a)?a.change_id(c,!1):a.change_id(c,!0)});x(this,"change_id",function(c,d){b(e,a).call(a,f.INFO,"change_id, Changing the device ID to: ["+c+"] with merge:["+
d+"]");if(c&&"string"===typeof c&&0!==c.length)if(b(N,a))b(e,a).call(a,f.WARNING,"change_id, Offline mode was on, initiating disabling sequence instead."),a.disable_offline_mode(c);else if(a.device_id==c)b(e,a).call(a,f.DEBUG,"change_id, Provided device ID is equal to the current device ID. Aborting.");else{d||(b(Ba,a).call(a),b(Aa,a).call(a),a.end_session(null,!0),k(fa,a,{}),a.remove_consent_internal(t.features,!1));var g=a.device_id;a.device_id=c;a.device_id=a.device_id;k(J,a,0);b(y,a).call(a,"cly_id",
a.device_id);b(y,a).call(a,"cly_id_type",0);b(e,a).call(a,f.INFO,"change_id, Changing ID from:["+g+"] to ["+c+"]");d?b(W,a).call(a,{old_device_id:g}):a.begin_session(!b(La,a),!0);a.remote_config&&(k(V,a,{}),b(y,a).call(a,"cly_remote_configs",b(V,a)),a.fetch_remote_config(a.remote_config))}else b(e,a).call(a,f.WARNING,"change_id, The provided device ID is not a valid ID")});x(this,"add_event",function(c){b(e,a).call(a,f.INFO,"add_event, Adding event: ",c);switch(c.key){case R.NPS:var d=a.check_consent("feedback");
break;case R.SURVEY:d=a.check_consent("feedback");break;case R.STAR_RATING:d=a.check_consent("star-rating");break;case R.VIEW:d=a.check_consent("views");break;case R.ORIENTATION:d=a.check_consent("users");break;case R.ACTION:d=a.check_consent("clicks")||a.check_consent("scrolls");break;default:d=b(Pb,a)?a.check_consent("events"):!1}d&&b(da,a).call(a,c)});x(this,"attempt_to_send_stored_requests",function(){b(e,a).call(a,f.INFO,"attemptToSendStoredRequests, Attempting to send stored requests");b(Ba,
a).call(a);b(Aa,a).call(a)});x(this,"test_mode_rq",function(c){b(e,a).call(a,f.INFO,"test_mode_rq, Setting test mode to: ["+c+"]");a.test_mode=c});p(this,da,function(c,d){if(a.ignore_visitor||!b(lb,a))b(e,a).call(a,f.WARNING,"Not adding the event. Tracking is disabled by the server config:["+!b(lb,a)+"] or ignore_visitor is:["+a.ignore_visitor+"]");else if(c.key){c.count||(c.count=1);rd.includes(c.key)||(c.key=C(c.key,b(K,a),"add_cly_event",b(e,a)));c.segmentation=ra(c.segmentation,b(K,a),b(H,a),
b(Y,a),"add_cly_event",b(e,a));c=pb(c,["key","count","sum","dur","segmentation"]);c.timestamp=$a();var g=new Date;c.hour=g.getHours();c.dow=g.getDay();c.id=d||nc();c.key===R.VIEW?c.pvid=b(gb,a)||"":c.cvid=b(va,a)||"";b(O,a).push(c);b(y,a).call(a,"cly_event",b(O,a));b(e,a).call(a,f.INFO,"With event ID: ["+c.id+"], successfully adding the last event:",c)}else b(e,a).call(a,f.ERROR,"Adding event failed. Event must have a key property")});x(this,"start_event",function(c){c&&"string"===typeof c?(b(e,a).call(a,
f.INFO,"start_event, Starting timed event with key: ["+c+"]"),c=C(c,b(K,a),"start_event",b(e,a)),b(fa,a)[c]?b(e,a).call(a,f.WARNING,"start_event, Timed event with key: ["+c+"] already started"):b(fa,a)[c]=I()):b(e,a).call(a,f.WARNING,"start_event, you have to provide a valid string key instead of: ["+c+"]")});x(this,"cancel_event",function(c){if(!c||"string"!==typeof c)return b(e,a).call(a,f.WARNING,"cancel_event, you have to provide a valid string key instead of: ["+c+"]"),!1;b(e,a).call(a,f.INFO,
"cancel_event, Canceling timed event with key: ["+c+"]");c=C(c,b(K,a),"cancel_event",b(e,a));if(b(fa,a)[c])return delete b(fa,a)[c],b(e,a).call(a,f.INFO,"cancel_event, Timed event with key: ["+c+"] is canceled"),!0;b(e,a).call(a,f.WARNING,"cancel_event, Timed event with key: ["+c+"] was not found");return!1});x(this,"end_event",function(c){c?(b(e,a).call(a,f.INFO,"end_event, Ending timed event"),"string"===typeof c&&(c=C(c,b(K,a),"end_event",b(e,a)),c={key:c}),c.key?b(fa,a)[c.key]?(c.dur=I()-b(fa,
a)[c.key],a.add_event(c),delete b(fa,a)[c.key]):b(e,a).call(a,f.ERROR,"end_event, Timed event with key: ["+c.key+"] was not started"):b(e,a).call(a,f.ERROR,"end_event, Timed event must have a key property")):b(e,a).call(a,f.WARNING,"end_event, you have to provide a valid string key or event object instead of: ["+c+"]")});p(this,yc,function(c){b(e,a).call(a,f.INFO,"report_orientation, Reporting orientation");a.check_consent("users")&&b(da,a).call(a,{key:R.ORIENTATION,segmentation:{mode:c||(window.innerWidth>
window.innerHeight?"landscape":"portrait")}})});x(this,"report_conversion",function(c,d){b(e,a).call(a,f.WARNING,"report_conversion, Deprecated function call! Use 'recordDirectAttribution' in place of this call. Call will be redirected now!");a.recordDirectAttribution(c,d)});x(this,"recordDirectAttribution",function(c,d){b(e,a).call(a,f.INFO,"recordDirectAttribution, Recording the attribution for campaign ID: ["+c+"] and the user ID: ["+d+"]");a.check_consent("attribution")&&(c=c||b(B,a).call(a,"cly_cmp_id")||
"cly_organic",(d=d||b(B,a).call(a,"cly_cmp_uid"))?b(W,a).call(a,{campaign_id:c,campaign_user:d}):b(W,a).call(a,{campaign_id:c}))});x(this,"user_details",function(c){b(e,a).call(a,f.INFO,"user_details, Trying to add user details: ",c);a.check_consent("users")&&(b(Ba,a).call(a),b(Aa,a).call(a),b(e,a).call(a,f.INFO,"user_details, flushed the event queue"),c.name=C(c.name,b(H,a),"user_details",b(e,a)),c.username=C(c.username,b(H,a),"user_details",b(e,a)),c.email=C(c.email,b(H,a),"user_details",b(e,a)),
c.organization=C(c.organization,b(H,a),"user_details",b(e,a)),c.phone=C(c.phone,b(H,a),"user_details",b(e,a)),c.picture=C(c.picture,4096,"user_details",b(e,a)),c.gender=C(c.gender,b(H,a),"user_details",b(e,a)),c.byear=C(c.byear,b(H,a),"user_details",b(e,a)),c.custom=ra(c.custom,b(K,a),b(H,a),b(Y,a),"user_details",b(e,a)),b(W,a).call(a,{user_details:JSON.stringify(pb(c,"name username email organization phone picture gender byear custom".split(" ")))}))});p(this,ja,{});p(this,qa,function(c,d,g){a.check_consent("users")&&
(b(ja,a)[c]||(b(ja,a)[c]={}),"$push"===g||"$pull"===g||"$addToSet"===g?(b(ja,a)[c][g]||(b(ja,a)[c][g]=[]),b(ja,a)[c][g].push(d)):b(ja,a)[c][g]=d)});x(this,"userData",{set:function(c,d){b(e,a).call(a,f.INFO,"[userData] set, Setting user's custom property value: ["+d+"] under the key: ["+c+"]");c=C(c,b(K,a),"userData set",b(e,a));d=C(d,b(H,a),"userData set",b(e,a));b(ja,a)[c]=d},unset:function(c){b(e,a).call(a,f.INFO,"[userData] unset, Resetting user's custom property with key: ["+c+"] ");b(ja,a)[c]=
""},set_once:function(c,d){b(e,a).call(a,f.INFO,"[userData] set_once, Setting user's unique custom property value: ["+d+"] under the key: ["+c+"] ");c=C(c,b(K,a),"userData set_once",b(e,a));d=C(d,b(H,a),"userData set_once",b(e,a));b(qa,a).call(a,c,d,"$setOnce")},increment:function(c){b(e,a).call(a,f.INFO,"[userData] increment, Increasing user's custom property value under the key: ["+c+"] by one");c=C(c,b(K,a),"userData increment",b(e,a));b(qa,a).call(a,c,1,"$inc")},increment_by:function(c,d){b(e,
a).call(a,f.INFO,"[userData] increment_by, Increasing user's custom property value under the key: ["+c+"] by: ["+d+"]");c=C(c,b(K,a),"userData increment_by",b(e,a));d=C(d,b(H,a),"userData increment_by",b(e,a));b(qa,a).call(a,c,d,"$inc")},multiply:function(c,d){b(e,a).call(a,f.INFO,"[userData] multiply, Multiplying user's custom property value under the key: ["+c+"] by: ["+d+"]");c=C(c,b(K,a),"userData multiply",b(e,a));d=C(d,b(H,a),"userData multiply",b(e,a));b(qa,a).call(a,c,d,"$mul")},max:function(c,
d){b(e,a).call(a,f.INFO,"[userData] max, Saving user's maximum custom property value compared to the value: ["+d+"] under the key: ["+c+"]");c=C(c,b(K,a),"userData max",b(e,a));d=C(d,b(H,a),"userData max",b(e,a));b(qa,a).call(a,c,d,"$max")},min:function(c,d){b(e,a).call(a,f.INFO,"[userData] min, Saving user's minimum custom property value compared to the value: ["+d+"] under the key: ["+c+"]");c=C(c,b(K,a),"userData min",b(e,a));d=C(d,b(H,a),"userData min",b(e,a));b(qa,a).call(a,c,d,"$min")},push:function(c,
d){b(e,a).call(a,f.INFO,"[userData] push, Pushing a value: ["+d+"] under the key: ["+c+"] to user's custom property array");c=C(c,b(K,a),"userData push",b(e,a));d=C(d,b(H,a),"userData push",b(e,a));b(qa,a).call(a,c,d,"$push")},push_unique:function(c,d){b(e,a).call(a,f.INFO,"[userData] push_unique, Pushing a unique value: ["+d+"] under the key: ["+c+"] to user's custom property array");c=C(c,b(K,a),"userData push_unique",b(e,a));d=C(d,b(H,a),"userData push_unique",b(e,a));b(qa,a).call(a,c,d,"$addToSet")},
pull:function(c,d){b(e,a).call(a,f.INFO,"[userData] pull, Removing the value: ["+d+"] under the key: ["+c+"] from user's custom property array");b(qa,a).call(a,c,d,"$pull")},save:function(){b(e,a).call(a,f.INFO,"[userData] save, Saving changes to user's custom property");a.check_consent("users")&&(b(Ba,a).call(a),b(Aa,a).call(a),b(e,a).call(a,f.INFO,"user_details, flushed the event queue"),b(W,a).call(a,{user_details:JSON.stringify({custom:b(ja,a)})}));k(ja,a,{})}});x(this,"report_trace",function(c){b(e,
a).call(a,f.INFO,"report_trace, Reporting performance trace");if(a.check_consent("apm")){for(var d="type name stz etz apm_metrics apm_attr".split(" "),g=0;g<d.length;g++)if("apm_attr"!==d[g]&&"undefined"===typeof c[d[g]]){b(e,a).call(a,f.WARNING,"report_trace, APM trace don't have the property: "+d[g]);return}c.name=C(c.name,b(K,a),"report_trace",b(e,a));c.app_metrics=ra(c.app_metrics,b(K,a),b(H,a),b(Y,a),"report_trace",b(e,a));d=pb(c,d);d.timestamp=c.stz;c=new Date;d.hour=c.getHours();d.dow=c.getDay();
b(W,a).call(a,{apm:JSON.stringify(d)});b(e,a).call(a,f.INFO,"report_trace, Successfully adding APM trace: ",d)}});x(this,"track_errors",function(c){A?b(zb,a)?(b(e,a).call(a,f.INFO,"track_errors, Started tracking errors"),t.i[a.app_key].tracking_crashes=!0,window.cly_crashes||(window.cly_crashes=!0,k(sb,a,c),window.addEventListener("error",function(d){if(d.error)pc(d.error,!1);else{var g=d.filename||"",h=d.lineno||0,n=d.colno||0;d=(d.message||"Unknown error")+"\n";g&&(d+="at "+g);h&&(d+=":"+h);n&&
(d+=":"+n);d+="\n";pc(d+"",!1)}}),window.addEventListener("unhandledrejection",function(d){pc(Error("Unhandled rejection (reason: "+(d.reason&&d.reason.stack?d.reason.stack:d.reason)+")."),!0)}))):b(e,a).call(a,f.WARNING,"track_errors, Crash tracking is disabled by the server config. Not tracking errors."):b(e,a).call(a,f.WARNING,"track_errors, window object is not available. Not tracking errors.")});x(this,"log_error",function(c,d){b(e,a).call(a,f.INFO,"log_error, Logging errors");a.recordError(c,
!0,d)});x(this,"add_log",function(c){b(e,a).call(a,f.INFO,"add_log, Adding a new log of breadcrumbs: [ "+c+" ]");if(a.check_consent("crashes")){for(c=C(c,b(H,a),"add_log",b(e,a));b(sa,a).length>=b(Va,a);)b(sa,a).shift(),b(e,a).call(a,f.WARNING,"add_log, Reached maximum crashLogs size. Will erase the oldest one.");b(sa,a).push(c)}});x(this,"fetch_remote_config",function(c,d,g){var h=null,n=null,l=null;c&&(g||"function"!==typeof c?Array.isArray(c)&&(h=c):l=c);d&&(g||"function"!==typeof d?Array.isArray(d)&&
(n=d):l=d);l||"function"!==typeof g||(l=g);a.useExplicitRcApi?(b(e,a).call(a,f.INFO,"fetch_remote_config, Fetching remote config"),c=a.rcAutoOptinAb?1:0,b(zc,a).call(a,h,n,c,null,l)):(b(e,a).call(a,f.WARNING,"fetch_remote_config, Fetching remote config, with legacy API"),b(zc,a).call(a,h,n,null,"legacy",l))});p(this,zc,function(c,d,g,h,n){b(e,a).call(a,f.INFO,"fetch_remote_config_explicit, Fetching sequence initiated");var l={method:"rc",av:a.app_version};c&&(l.keys=JSON.stringify(c));d&&(l.omit_keys=
JSON.stringify(d));var r;"legacy"===h&&(l.method="fetch_remote_config");0===g&&(l.oi=0);1===g&&(l.oi=1);"function"===typeof n&&(r=n);a.check_consent("sessions")&&(l.metrics=JSON.stringify(b(Eb,a).call(a)));a.check_consent("remote-config")?(b(Ya,a).call(a,l),b(ea,a).call(a,"fetch_remote_config_explicit",a.url+b(Ka,a),l,function(u,z,D){if(!u){try{var S=JSON.parse(D);if(l.keys||l.omit_keys)for(var T in S)b(V,a)[T]=S[T];else k(V,a,S);b(y,a).call(a,"cly_remote_configs",b(V,a))}catch(Ca){b(e,a).call(a,
f.ERROR,"fetch_remote_config_explicit, Had an issue while parsing the response: "+Ca)}r&&(b(e,a).call(a,f.INFO,"fetch_remote_config_explicit, Callback function is provided"),r(u,b(V,a)))}},!0)):(b(e,a).call(a,f.ERROR,"fetch_remote_config_explicit, Remote config requires explicit consent"),r&&r(Error("Remote config requires explicit consent"),b(V,a)))});x(this,"enrollUserToAb",function(c){b(e,a).call(a,f.INFO,"enrollUserToAb, Providing AB test keys to opt in for");c&&Array.isArray(c)&&0!==c.length?
(c={method:"ab",keys:JSON.stringify(c),av:a.app_version},b(Ya,a).call(a,c),b(ea,a).call(a,"enrollUserToAb",a.url+b(Ka,a),c,function(d,g,h){if(!d)try{var n=JSON.parse(h);b(e,a).call(a,f.DEBUG,"enrollUserToAb, Parsed the response's result: ["+n.result+"]")}catch(l){b(e,a).call(a,f.ERROR,"enrollUserToAb, Had an issue while parsing the response: "+l)}},!0)):b(e,a).call(a,f.ERROR,"enrollUserToAb, No keys provided")});x(this,"get_remote_config",function(c){b(e,a).call(a,f.INFO,"get_remote_config, Getting remote config from storage");
return"undefined"!==typeof c?b(V,a)[c]:b(V,a)});p(this,Ac,function(){b(e,a).call(a,f.INFO,"stop_time, Stopping tracking duration");b(ta,a)&&(k(ta,a,!1),k(tb,a,I()-b(la,a)),k(Na,a,I()-b(Ma,a)))});p(this,bc,function(){b(e,a).call(a,f.INFO,"start_time, Starting tracking duration");b(ta,a)||(k(ta,a,!0),k(la,a,I()-b(tb,a)),k(Ma,a,I()-b(Na,a)),k(Na,a,0),b(Ec,a).call(a))});x(this,"track_sessions",function(){if(A){b(e,a).call(a,f.INFO,"track_session, Starting tracking user session");a.begin_session();b(bc,
a).call(a);E(window,"beforeunload",function(){b(Ba,a).call(a);b(Aa,a).call(a);a.end_session()});var c="hidden",d=function(){document[c]||!document.hasFocus()?b(Ac,a).call(a):b(bc,a).call(a)};E(window,"focus",d);E(window,"blur",d);E(window,"pageshow",d);E(window,"pagehide",d);"onfocusin"in document&&(E(window,"focusin",d),E(window,"focusout",d));c in document?document.addEventListener("visibilitychange",d):"mozHidden"in document?(c="mozHidden",document.addEventListener("mozvisibilitychange",d)):"webkitHidden"in
document?(c="webkitHidden",document.addEventListener("webkitvisibilitychange",d)):"msHidden"in document&&(c="msHidden",document.addEventListener("msvisibilitychange",d));d=function(){b(Da,a)>=b(Oa,a)&&b(bc,a).call(a);k(Da,a,0)};E(window,"mousemove",d);E(window,"click",d);E(window,"keydown",d);E(window,"scroll",d);setInterval(function(){var g;k(Da,a,(g=b(Da,a),g++,g));b(Da,a)>=b(Oa,a)&&b(Ac,a).call(a)},6E4)}else b(e,a).call(a,f.WARNING,"track_sessions, window object is not available. Not tracking sessions.")});
x(this,"track_pageview",function(c,d,g){if(A||c)if(b(yb,a))if(b(e,a).call(a,f.INFO,"track_pageview, Tracking page views"),b(e,a).call(a,f.VERBOSE,"track_pageview, last view is:["+b(X,a)+"], current view ID is:["+b(va,a)+"], previous view ID is:["+b(gb,a)+"]"),b(X,a)&&b(vb,a)&&(b(e,a).call(a,f.DEBUG,"track_pageview, Scroll registry triggered"),b(lc,a).call(a),k(Qa,a,!0),k(Ra,a,0)),b(gc,a).call(a),k(gb,a,b(va,a)),k(va,a,nc()),(c=C(c,b(K,a),"track_pageview",b(e,a)))&&Array.isArray(c)&&(d=c,c=null),c||
(c=a.getViewName()),void 0===c||""===c)b(e,a).call(a,f.ERROR,"track_pageview, No page name to track (it is either undefined or empty string). No page view can be tracked.");else if(null===c)b(e,a).call(a,f.ERROR,"track_pageview, View name returned as null. Page view will be ignored.");else{if(d&&d.length)for(var h=0;h<d.length;h++)try{if((new RegExp(d[h])).test(c)){b(e,a).call(a,f.INFO,"track_pageview, Ignoring the page: "+c);return}}catch(u){b(e,a).call(a,f.ERROR,"track_pageview, Problem with finding ignore list item: "+
d[h]+", error: "+u)}h={name:c,visit:1,view:a.getViewUrl()};h=ra(h,b(K,a),b(H,a),b(Y,a),"track_pageview",b(e,a));a.track_domains&&(h.domain=window.location.hostname);if(b(ma,a))if(b(ca,a))b(Ea,a)&&(k(Ea,a,!1),h.start=1);else{var n=b(B,a).call(a,"cly_session");if(!n||parseInt(n)<=I())k(Ea,a,!1),h.start=1}else A&&"undefined"!==typeof document.referrer&&document.referrer.length&&(n=Vc.exec(document.referrer))&&n[11]&&n[11]!==window.location.hostname&&(h.start=1);if(b(na,a)&&Object.keys(b(na,a)).length){b(e,
a).call(a,f.INFO,"track_pageview, Adding fresh utm tags to segmentation:["+JSON.stringify(b(na,a))+"]");for(var l in b(na,a))"undefined"===typeof h["utm_"+l]&&(h["utm_"+l]=b(na,a)[l])}A&&b(ic,a).call(a)&&(b(e,a).call(a,f.INFO,"track_pageview, Adding referrer to segmentation:["+document.referrer+"]"),h.referrer=document.referrer);if(g){g=ra(g,b(K,a),b(H,a),b(Y,a),"track_pageview",b(e,a));for(var r in g)"undefined"===typeof h[r]&&(h[r]=g[r])}a.check_consent("views")?(b(da,a).call(a,{key:R.VIEW,segmentation:h},
b(va,a)),k(X,a,c),k(Ma,a,I()),b(e,a).call(a,f.VERBOSE,"track_pageview, last view is assigned:["+b(X,a)+"]")):b(ia,a).track_pageview=[c,d,g]}else b(e,a).call(a,f.WARNING,"track_pageview, View tracking is disabled by the server config. Not tracking page views.");else b(e,a).call(a,f.WARNING,"track_pageview, window object is not available. Not tracking page views as page name is not provided.")});x(this,"track_view",function(c,d,g){b(e,a).call(a,f.INFO,"track_view, Initiating tracking page views");a.track_pageview(c,
d,g)});x(this,"track_clicks",function(c){if(A){b(e,a).call(a,f.INFO,"track_clicks, Starting to track clicks");c&&b(e,a).call(a,f.INFO,"track_clicks, Tracking the specified children:["+c+"]");c=c||document;var d=!0;E(c,"click",function(g){if(d){d=!1;tc(g);if("undefined"!==typeof g.pageX&&"undefined"!==typeof g.pageY){var h=Kb(),n=uc();a.check_consent("clicks")&&(g={type:"click",x:g.pageX,y:g.pageY,width:n,height:h,view:a.getViewUrl()},g=ra(g,b(K,a),b(H,a),b(Y,a),"processClick",b(e,a)),a.track_domains&&
(g.domain=window.location.hostname),b(da,a).call(a,{key:R.ACTION,segmentation:g}))}setTimeout(function(){d=!0},1E3)}})}else b(e,a).call(a,f.WARNING,"track_clicks, window object is not available. Not tracking clicks.")});x(this,"track_scrolls",function(c){A?(b(e,a).call(a,f.INFO,"track_scrolls, Starting to track scrolls"),c&&b(e,a).call(a,f.INFO,"track_scrolls, Tracking the specified children"),c=c||window,k(Qa,a,!0),k(vb,a,!0),E(c,"scroll",b(Ic,a)),E(c,"beforeunload",b(lc,a))):b(e,a).call(a,f.WARNING,
"track_scrolls, window object is not available. Not tracking scrolls.")});x(this,"track_links",function(c){A?(b(e,a).call(a,f.INFO,"track_links, Starting to track clicks to links"),c&&b(e,a).call(a,f.INFO,"track_links, Tracking the specified children"),c=c||document,E(c,"click",function(d){a:{var g=Jb(d);var h;for(h="A";g;){if(g.nodeName.toUpperCase()===h)break a;g=g.parentElement}g=void 0}g&&(tc(d),a.check_consent("clicks")&&b(da,a).call(a,{key:"linkClick",segmentation:{href:g.href,text:g.innerText,
id:g.id,view:a.getViewUrl()}}))})):b(e,a).call(a,f.WARNING,"track_links, window object is not available. Not tracking links.")});x(this,"track_forms",function(c,d){if(A){b(e,a).call(a,f.INFO,"track_forms, Starting to track form submissions. DOM object provided:["+!!c+"] Tracking hidden inputs :["+!!d+"]");c=c||document;var g=function(h){return h.name||h.id||h.type||h.nodeName};E(c,"submit",function(h){h=Jb(h);var n={id:h.attributes.id&&h.attributes.id.nodeValue,name:h.attributes.name&&h.attributes.name.nodeValue,
action:h.attributes.action&&h.attributes.action.nodeValue,method:h.attributes.method&&h.attributes.method.nodeValue,view:a.getViewUrl()},l;if("undefined"!==typeof h.elements){for(var r=0;r<h.elements.length;r++)(l=h.elements[r])&&"password"!==l.type&&-1===l.className.indexOf("cly_user_ignore")&&("undefined"===typeof n["input:"+g(l)]&&(n["input:"+g(l)]=[]),"select"===l.nodeName.toLowerCase()?"undefined"!==typeof l.multiple?n["input:"+g(l)].push(Lc(l)):n["input:"+g(l)].push(l.options[l.selectedIndex].value):
"input"===l.nodeName.toLowerCase()?"undefined"!==typeof l.type?"checkbox"===l.type.toLowerCase()||"radio"===l.type.toLowerCase()?l.checked&&n["input:"+g(l)].push(l.value):("hidden"!==l.type.toLowerCase()||d)&&n["input:"+g(l)].push(l.value):n["input:"+g(l)].push(l.value):"textarea"===l.nodeName.toLowerCase()?n["input:"+g(l)].push(l.value):"undefined"!==typeof l.value&&n["input:"+g(l)].push(l.value));for(var u in n)n[u]&&"function"===typeof n[u].join&&(n[u]=n[u].join(", "))}a.check_consent("forms")&&
b(da,a).call(a,{key:"formSubmit",segmentation:n})})}else b(e,a).call(a,f.WARNING,"track_forms, window object is not available. Not tracking forms.")});x(this,"collect_from_forms",function(c,d){A?(b(e,a).call(a,f.INFO,"collect_from_forms, Starting to collect possible user data. DOM object provided:["+!!c+"] Submitting custom user property:["+!!d+"]"),c=c||document,E(c,"submit",function(g){g=Jb(g);var h={},n=!1,l;if("undefined"!==typeof g.elements){var r={},u=c.getElementsByTagName("LABEL"),z;for(z=
0;z<u.length;z++)u[z].htmlFor&&""!==u[z].htmlFor&&(r[u[z].htmlFor]=u[z].innerText||u[z].textContent||u[z].innerHTML);for(z=0;z<g.elements.length;z++)if((l=g.elements[z])&&"password"!==l.type&&-1===l.className.indexOf("cly_user_ignore"))if(u="","select"===l.nodeName.toLowerCase()?u="undefined"!==typeof l.multiple?Lc(l):l.options[l.selectedIndex].value:"input"===l.nodeName.toLowerCase()?"undefined"!==typeof l.type?"checkbox"===l.type.toLowerCase()||"radio"===l.type.toLowerCase()?l.checked&&(u=l.value):
u=l.value:u=l.value:"textarea"===l.nodeName.toLowerCase()?u=l.value:"undefined"!==typeof l.value&&(u=l.value),l.className&&-1!==l.className.indexOf("cly_user_")){var D=l.className.split(" ");for(l=0;l<D.length;l++)if(0===D[l].indexOf("cly_user_")){h[D[l].replace("cly_user_","")]=u;n=!0;break}}else if(l.type&&"email"===l.type.toLowerCase()||l.name&&-1!==l.name.toLowerCase().indexOf("email")||l.id&&-1!==l.id.toLowerCase().indexOf("email")||l.id&&r[l.id]&&-1!==r[l.id].toLowerCase().indexOf("email")||
/[^@\s]+@[^@\s]+\.[^@\s]+/.test(u))h.email||(h.email=u),n=!0;else if(l.name&&-1!==l.name.toLowerCase().indexOf("username")||l.id&&-1!==l.id.toLowerCase().indexOf("username")||l.id&&r[l.id]&&-1!==r[l.id].toLowerCase().indexOf("username"))h.username||(h.username=u),n=!0;else if(l.name&&(-1!==l.name.toLowerCase().indexOf("tel")||-1!==l.name.toLowerCase().indexOf("phone")||-1!==l.name.toLowerCase().indexOf("number"))||l.id&&(-1!==l.id.toLowerCase().indexOf("tel")||-1!==l.id.toLowerCase().indexOf("phone")||
-1!==l.id.toLowerCase().indexOf("number"))||l.id&&r[l.id]&&(-1!==r[l.id].toLowerCase().indexOf("tel")||-1!==r[l.id].toLowerCase().indexOf("phone")||-1!==r[l.id].toLowerCase().indexOf("number")))h.phone||(h.phone=u),n=!0;else if(l.name&&(-1!==l.name.toLowerCase().indexOf("org")||-1!==l.name.toLowerCase().indexOf("company"))||l.id&&(-1!==l.id.toLowerCase().indexOf("org")||-1!==l.id.toLowerCase().indexOf("company"))||l.id&&r[l.id]&&(-1!==r[l.id].toLowerCase().indexOf("org")||-1!==r[l.id].toLowerCase().indexOf("company")))h.organization||
(h.organization=u),n=!0;else if(l.name&&-1!==l.name.toLowerCase().indexOf("name")||l.id&&-1!==l.id.toLowerCase().indexOf("name")||l.id&&r[l.id]&&-1!==r[l.id].toLowerCase().indexOf("name"))h.name||(h.name=""),h.name+=u+" ",n=!0}n&&(b(e,a).call(a,f.INFO,"collect_from_forms, Gathered user data",h),d?a.user_details({custom:h}):a.user_details(h))})):b(e,a).call(a,f.WARNING,"collect_from_forms, window object is not available. Not collecting from forms.")});x(this,"collect_from_facebook",function(c){A?"undefined"!==
typeof FB&&FB&&FB.api?(b(e,a).call(a,f.INFO,"collect_from_facebook, Starting to collect possible user data"),FB.api("/me",function(d){var g={};d.name&&(g.name=d.name);d.email&&(g.email=d.email);"male"===d.gender?g.gender="M":"female"===d.gender&&(g.gender="F");if(d.birthday){var h=d.birthday.split("/").pop();h&&4===h.length&&(g.byear=h)}d.work&&d.work[0]&&d.work[0].employer&&d.work[0].employer.name&&(g.organization=d.work[0].employer.name);if(c){g.custom={};for(var n in c){h=c[n].split(".");for(var l=
d,r=0;r<h.length&&(l=l[h[r]],"undefined"!==typeof l);r++);"undefined"!==typeof l&&(g.custom[n]=l)}}a.user_details(g)})):b(e,a).call(a,f.ERROR,"collect_from_facebook, Facebook SDK is not available"):b(e,a).call(a,f.WARNING,"collect_from_facebook, window object is not available. Not collecting from Facebook.")});x(this,"opt_out",function(){b(e,a).call(a,f.WARNING,"opt_out, Opting out the user. Deprecated function call! Use 'consent' in place of this call.");a.ignore_visitor=!0;b(y,a).call(a,"cly_ignore",
!0)});x(this,"opt_in",function(){b(e,a).call(a,f.WARNING,"opt_in, Opting in the user. Deprecated function call! Use 'consent' in place of this call.");b(y,a).call(a,"cly_ignore",!1);a.ignore_visitor=!1;b(Bc,a).call(a);a.ignore_visitor||b(fb,a)||b(Db,a).call(a)});x(this,"report_feedback",function(c){b(e,a).call(a,f.WARNING,"report_feedback, Deprecated function call! Use 'recordRatingWidgetWithID' or 'reportFeedbackWidgetManually' in place of this call. Call will be redirected to 'recordRatingWidgetWithID' now!");
a.recordRatingWidgetWithID(c)});x(this,"recordRatingWidgetWithID",function(c){b(e,a).call(a,f.INFO,"recordRatingWidgetWithID, Providing information about user with ID: [ "+c.widget_id+" ]");if(a.check_consent("star-rating"))if(c.widget_id)if(c.rating){var d={key:R.STAR_RATING,count:1,segmentation:{}};d.segmentation=pb(c,"widget_id contactMe platform app_version rating email comment".split(" "));d.segmentation.app_version||(d.segmentation.app_version=a.metrics._app_version||a.app_version);5<d.segmentation.rating?
(b(e,a).call(a,f.WARNING,"recordRatingWidgetWithID, You have entered a rating higher than 5. Changing it back to 5 now."),d.segmentation.rating=5):1>d.segmentation.rating&&(b(e,a).call(a,f.WARNING,"recordRatingWidgetWithID, You have entered a rating lower than 1. Changing it back to 1 now."),d.segmentation.rating=1);b(e,a).call(a,f.INFO,"recordRatingWidgetWithID, Reporting Rating Widget: ",d);b(da,a).call(a,d)}else b(e,a).call(a,f.ERROR,"recordRatingWidgetWithID, Rating Widget must contain rating property");
else b(e,a).call(a,f.ERROR,"recordRatingWidgetWithID, Rating Widget must contain widget_id property")});x(this,"reportFeedbackWidgetManually",function(c,d,g){if(a.check_consent("feedback"))if(c&&d)if(c._id)if(b(N,a))b(e,a).call(a,f.ERROR,"reportFeedbackWidgetManually, Feedback Widgets can not be reported in offline mode");else{b(e,a).call(a,f.INFO,"reportFeedbackWidgetManually, Providing information about user with, provided result of the widget with  ID: [ "+c._id+" ] and type: ["+c.type+"]");var h=
[];d=c.type;if("nps"===d){if(g){if(!g.rating){b(e,a).call(a,f.ERROR,"reportFeedbackWidgetManually, Widget must contain rating property");return}g.rating=Math.round(g.rating);10<g.rating?(b(e,a).call(a,f.WARNING,"reportFeedbackWidgetManually, You have entered a rating higher than 10. Changing it back to 10 now."),g.rating=10):0>g.rating&&(b(e,a).call(a,f.WARNING,"reportFeedbackWidgetManually, You have entered a rating lower than 0. Changing it back to 0 now."),g.rating=0);h=["rating","comment"]}var n=
R.NPS}else if("survey"===d){if(g){if(1>Object.keys(g).length){b(e,a).call(a,f.ERROR,"reportFeedbackWidgetManually, Widget should have answers to be reported");return}h=Object.keys(g)}n=R.SURVEY}else if("rating"===d){if(g){if(!g.rating){b(e,a).call(a,f.ERROR,"reportFeedbackWidgetManually, Widget must contain rating property");return}g.rating=Math.round(g.rating);5<g.rating?(b(e,a).call(a,f.WARNING,"reportFeedbackWidgetManually, You have entered a rating higher than 5. Changing it back to 5 now."),
g.rating=5):1>g.rating&&(b(e,a).call(a,f.WARNING,"reportFeedbackWidgetManually, You have entered a rating lower than 1. Changing it back to 1 now."),g.rating=1);h=["rating","comment","email","contactMe"]}n=R.STAR_RATING}else{b(e,a).call(a,f.ERROR,"reportFeedbackWidgetManually, Widget has an unacceptable type");return}c={key:n,count:1,segmentation:{widget_id:c._id,platform:a.platform,app_version:a.metrics._app_version||a.app_version}};if(null===g)c.segmentation.closed=1;else{n=c.segmentation;if(h){for(var l,
r=0,u=h.length;r<u;r++)l=h[r],"undefined"!==typeof g[l]&&(n[l]=g[l]);g=n}else g=void 0;c.segmentation=g}b(e,a).call(a,f.INFO,"reportFeedbackWidgetManually, Reporting "+d+": ",c);b(da,a).call(a,c)}else b(e,a).call(a,f.ERROR,"reportFeedbackWidgetManually, Feedback Widgets must contain _id property");else b(e,a).call(a,f.ERROR,"reportFeedbackWidgetManually, Widget data and/or Widget object not provided. Aborting.")});x(this,"show_feedback_popup",function(c){A?(b(e,a).call(a,f.WARNING,"show_feedback_popup, Deprecated function call! Use 'presentRatingWidgetWithID' in place of this call. Call will be redirected now!"),
presentRatingWidgetWithID(c)):b(e,a).call(a,f.WARNING,"show_feedback_popup, window object is not available. Not showing feedback popup.")});x(this,"presentRatingWidgetWithID",function(c){A?(b(e,a).call(a,f.INFO,"presentRatingWidgetWithID, Showing rating widget popup for the widget with ID: [ "+c+" ]"),a.check_consent("star-rating")&&(b(N,a)?b(e,a).call(a,f.ERROR,"presentRatingWidgetWithID, Cannot show ratingWidget popup in offline mode"):b(ea,a).call(a,"presentRatingWidgetWithID,",a.url+"/o/feedback/widget",
{widget_id:c,av:a.app_version},function(d,g,h){if(!d)try{var n=JSON.parse(h);b(fc,a).call(a,n,!1)}catch(l){b(e,a).call(a,f.ERROR,"presentRatingWidgetWithID, JSON parse failed: "+l)}},!0))):b(e,a).call(a,f.WARNING,"presentRatingWidgetWithID, window object is not available. Not showing rating widget popup.")});x(this,"initialize_feedback_popups",function(c){A?(b(e,a).call(a,f.WARNING,"initialize_feedback_popups, Deprecated function call! Use 'initializeRatingWidgets' in place of this call. Call will be redirected now!"),
a.initializeRatingWidgets(c)):b(e,a).call(a,f.WARNING,"initialize_feedback_popups, window object is not available. Not initializing feedback popups.")});x(this,"initializeRatingWidgets",function(c){if(A){if(b(e,a).call(a,f.INFO,"initializeRatingWidgets, Initializing rating widget with provided widget IDs:[ "+c+"]"),a.check_consent("star-rating")){c||(c=b(B,a).call(a,"cly_fb_widgets"));for(var d=document.getElementsByClassName("countly-feedback-sticker");0<d.length;)d[0].remove();b(ea,a).call(a,"initializeRatingWidgets,",
a.url+"/o/feedback/multiple-widgets-by-id",{widgets:JSON.stringify(c),av:a.app_version},function(g,h,n){if(!g)try{var l=JSON.parse(n);for(g=0;g<l.length;g++)if("true"===l[g].is_active){var r=l[g].target_devices,u=sc();if(r[u])if("string"===typeof l[g].hide_sticker&&(l[g].hide_sticker="true"===l[g].hide_sticker),"all"!==l[g].target_page||l[g].hide_sticker){var z=l[g].target_pages;for(h=0;h<z.length;h++){var D=z[h].substr(0,z[h].length-1)===window.location.pathname.substr(0,z[h].length-1),S=z[h]===
window.location.pathname;(z[h].includes("*")&&D||S)&&!l[g].hide_sticker&&b(fc,a).call(a,l[g],!0)}}else b(fc,a).call(a,l[g],!0)}}catch(T){b(e,a).call(a,f.ERROR,"initializeRatingWidgets, JSON parse error: "+T)}},!0)}}else b(e,a).call(a,f.WARNING,"initializeRatingWidgets, window object is not available. Not initializing rating widgets.")});x(this,"enable_feedback",function(c){A?(b(e,a).call(a,f.WARNING,"enable_feedback, Deprecated function call! Use 'enableRatingWidgets' in place of this call. Call will be redirected now!"),
a.enableRatingWidgets(c)):b(e,a).call(a,f.WARNING,"enable_feedback, window object is not available. Not enabling feedback.")});x(this,"enableRatingWidgets",function(c){A?(b(e,a).call(a,f.INFO,"enableRatingWidgets, Enabling rating widget with params:",c),a.check_consent("star-rating")&&(b(N,a)?b(e,a).call(a,f.ERROR,"enableRatingWidgets, Cannot enable rating widgets in offline mode"):(b(y,a).call(a,"cly_fb_widgets",c.popups||c.widgets),Lb(a.url+"/star-rating/stylesheets/countly-feedback-web.css"),c=
c.popups||c.widgets,0<c.length?(document.body.insertAdjacentHTML("beforeend",'<div id="cfbg"></div>'),a.initializeRatingWidgets(c)):b(e,a).call(a,f.ERROR,"enableRatingWidgets, You should provide at least one widget id as param. Read documentation for more detail. https://resources.count.ly/plugins/feedback")))):b(e,a).call(a,f.WARNING,"enableRatingWidgets, window object is not available. Not enabling rating widgets.")});p(this,cc,function(c,d){b(e,a).call(a,f.INFO,"showWidget, Showing ".concat(c,
" widget, nameIDorTag:[").concat(d,"]"));a.get_available_feedback_widgets(function(g,h){h?b(e,a).call(a,f.ERROR,"showWidget, Error while getting feedback widgets list: ".concat(h)):(h=g.find(function(n){return n.type===c}),d&&"string"===typeof d&&(g=g.find(function(n){return n.type===c&&(n.name===d||n._id===d||n.tg.includes(d))}))&&(h=g,b(e,a).call(a,f.VERBOSE,"showWidget, Found ".concat(c," widget by name, id, or tag: [").concat(JSON.stringify(g),"]"))),h?a.present_feedback_widget(h,null,null,null):
b(e,a).call(a,f.ERROR,"showWidget, No ".concat(c," widget found.")))})});x(this,"feedback",{showNPS:function(c){return b(cc,a).call(a,"nps",c)},showSurvey:function(c){return b(cc,a).call(a,"survey",c)},showRating:function(c){return b(cc,a).call(a,"rating",c)}});x(this,"get_available_feedback_widgets",function(c){b(e,a).call(a,f.INFO,"get_available_feedback_widgets, Getting the feedback list, callback function is provided:["+!!c+"]");if(a.check_consent("feedback"))if(b(N,a))b(e,a).call(a,f.ERROR,"get_available_feedback_widgets, Cannot enable feedback widgets in offline mode.");
else{var d=a.url+b(Ka,a),g={method:"feedback",device_id:a.device_id,app_key:a.app_key,av:a.app_version};b(ea,a).call(a,"get_available_feedback_widgets,",d,g,function(h,n,l){if(h)c&&c(null,h);else try{var r=JSON.parse(l).result||[];c&&c(r,null)}catch(u){b(e,a).call(a,f.ERROR,"get_available_feedback_widgets, Error while parsing feedback widgets list: "+u),c&&c(null,u)}},!1)}else c&&c(null,Error("Consent for feedback not provided."))});x(this,"getFeedbackWidgetData",function(c,d){if(c.type)if(b(e,a).call(a,
f.INFO,"getFeedbackWidgetData, Retrieving data for: ["+JSON.stringify(c)+"], callback function is provided:["+!!d+"]"),a.check_consent("feedback"))if(b(N,a))b(e,a).call(a,f.ERROR,"getFeedbackWidgetData, Cannot enable feedback widgets in offline mode.");else{var g=a.url,h={widget_id:c._id,shown:1,sdk_version:b(oa,a),sdk_name:b(wa,a),platform:a.platform,app_version:a.app_version};if("nps"===c.type)g+="/o/surveys/nps/widget";else if("survey"===c.type)g+="/o/surveys/survey/widget";else if("rating"===
c.type)g+="/o/surveys/rating/widget";else{b(e,a).call(a,f.ERROR,"getFeedbackWidgetData, Unknown type info: ["+c.type+"]");return}b(ea,a).call(a,"getFeedbackWidgetData,",g,h,n,!0);var n=function(l,r,u){if(l)d&&d(null,l);else try{var z=JSON.parse(u);d&&d(z,null)}catch(D){b(e,a).call(a,f.ERROR,"getFeedbackWidgetData, Error while parsing feedback widgets list: "+D),d&&d(null,D)}}}else d&&d(null,Error("Consent for feedback not provided."));else b(e,a).call(a,f.ERROR,"getFeedbackWidgetData, Expected the provided widget object to have a type but got: ["+
JSON.stringify(c)+"], aborting.")});x(this,"present_feedback_widget",function(c,d,g,h){if(A){if(b(e,a).call(a,f.INFO,"present_feedback_widget, Presenting the feedback widget by appending to the element with ID: [ "+d+" ] and className: [ "+g+" ]"),a.check_consent("feedback"))if(!c||"object"!==U(c)||Array.isArray(c))b(e,a).call(a,f.ERROR,"present_feedback_widget, Please provide at least one feedback widget object.");else{b(e,a).call(a,f.INFO,"present_feedback_widget, Adding segmentation to feedback widgets:["+
JSON.stringify(h)+"]");h&&"object"===U(h)&&0!==Object.keys(h).length||(b(e,a).call(a,f.DEBUG,"present_feedback_widget, Segmentation is not an object or empty"),h=null);try{var n=a.url;if("nps"===c.type)b(e,a).call(a,f.DEBUG,"present_feedback_widget, Widget type: nps."),n+="/feedback/nps";else if("survey"===c.type)b(e,a).call(a,f.DEBUG,"present_feedback_widget, Widget type: survey."),n+="/feedback/survey";else if("rating"===c.type)b(e,a).call(a,f.DEBUG,"present_feedback_widget, Widget type: rating."),
n+="/feedback/rating";else{b(e,a).call(a,f.ERROR,"present_feedback_widget, Feedback widget only accepts nps, rating and survey types.");return}var l=window.origin||window.location.origin;if("rating"===c.type){b(e,a).call(a,f.DEBUG,"present_feedback_widget, Loading css for rating widget.");var r="ratings";Lb(a.url+"/star-rating/stylesheets/countly-feedback-web.css")}else b(e,a).call(a,f.DEBUG,"present_feedback_widget, Loading css for survey or nps."),Lb(a.url+"/surveys/stylesheets/countly-surveys.css"),
r="surveys";n+="?widget_id="+c._id;n+="&app_key="+a.app_key;n+="&device_id="+a.device_id;n+="&sdk_name="+b(wa,a);n+="&platform="+a.platform;n+="&app_version="+a.app_version;n+="&sdk_version="+b(oa,a);var u={tc:1};h&&(u.sg=h);n+="&custom="+JSON.stringify(u);n+="&origin="+l;n+="&widget_v=web";var z=document.createElement("iframe");z.src=n;z.name="countly-"+r+"-iframe";z.id="countly-"+r+"-iframe";var D=!1;z.onload=function(){D&&(document.getElementById("countly-"+r+"-wrapper-"+c._id).style.display="none",
document.getElementById("csbg").style.display="none");D=!0;b(e,a).call(a,f.DEBUG,"present_feedback_widget, Loaded iframe.")};for(var S=document.getElementById("csbg");S;)S.remove(),S=document.getElementById("csbg"),b(e,a).call(a,f.DEBUG,"present_feedback_widget, Removing past overlay.");var T=document.getElementsByClassName("countly-"+r+"-wrapper");for(h=0;h<T.length;h++)T[h].remove(),b(e,a).call(a,f.DEBUG,"present_feedback_widget, Removed a wrapper.");T=document.createElement("div");h="countly-"+
r+"-wrapper";T.className=h+" "+h+"--"+c.type;T.id="countly-"+r+"-wrapper-"+c._id;"survey"===c.type&&(T.className=T.className+" "+c.appearance.position);var Ca=document.body;h=!1;d&&(document.getElementById(d)?(Ca=document.getElementById(d),h=!0):b(e,a).call(a,f.ERROR,"present_feedback_widget, Provided ID not found."));h||g&&(document.getElementsByClassName(g)[0]?Ca=document.getElementsByClassName(g)[0]:b(e,a).call(a,f.ERROR,"present_feedback_widget, Provided class not found."));Ca.insertAdjacentHTML("beforeend",
'<div id="csbg"></div>');Ca.appendChild(T);if("rating"===c.type){var ob=document.createElement("div");ob.className="countly-ratings-overlay";ob.id="countly-ratings-overlay-"+c._id;T.appendChild(ob);b(e,a).call(a,f.DEBUG,"present_feedback_widget, appended the rating overlay to wrapper");E(document.getElementById("countly-ratings-overlay-"+c._id),"click",function(){document.getElementById("countly-ratings-wrapper-"+c._id).style.display="none"})}T.appendChild(z);b(e,a).call(a,f.DEBUG,"present_feedback_widget, Appended the iframe");
E(window,"message",function(F){var aa={};try{aa=JSON.parse(F.data)}catch(sd){b(e,a).call(a,f.ERROR,"present_feedback_widget, Error while parsing message body "+sd)}!0===aa.close&&(b(e,a).call(a,f.DEBUG,"present_feedback_widget, Received message from widget with origin: ["+F.origin+"] and data: ["+F.data+"]"),document.getElementById("countly-"+r+"-wrapper-"+c._id).style.display="none",document.getElementById("csbg").style.display="none",b(e,a).call(a,f.DEBUG,"present_feedback_widget, Closed the widget"))});
var P=function(F){document.getElementById("countly-surveys-wrapper-"+F._id).style.display="block";document.getElementById("csbg").style.display="block"},Gb=function(F){for(var aa=document.getElementsByClassName("countly-feedback-sticker");0<aa.length;)b(e,a).call(a,f.VERBOSE,"present_feedback_widget, Removing old stickers"),aa[0].remove();F.appearance.hideS||(b(e,a).call(a,f.DEBUG,"present_feedback_widget, handling the sticker as it was not set to hidden"),aa=document.createElement("div"),aa.innerText=
F.appearance.text,aa.style.color=7>F.appearance.text_color.length?"#"+F.appearance.text_color:F.appearance.text_color,aa.style.backgroundColor=7>F.appearance.bg_color.length?"#"+F.appearance.bg_color:F.appearance.bg_color,aa.className="countly-feedback-sticker  "+F.appearance.position+"-"+F.appearance.size,aa.id="countly-feedback-sticker-"+F._id,document.body.appendChild(aa),E(document.getElementById("countly-feedback-sticker-"+F._id),"click",function(){document.getElementById("countly-ratings-wrapper-"+
F._id).style.display="flex";document.getElementById("csbg").style.display="block"}));E(document.getElementById("countly-feedback-close-icon-"+F._id),"click",function(){document.getElementById("countly-ratings-wrapper-"+F._id).style.display="none";document.getElementById("csbg").style.display="none"})};if("survey"===c.type){var ba=!1;switch(c.showPolicy){case "afterPageLoad":"complete"===document.readyState?ba||(ba=!0,P(c)):E(document,"readystatechange",function(F){"complete"!==F.target.readyState||
ba||(ba=!0,P(c))});break;case "afterConstantDelay":setTimeout(function(){ba||(ba=!0,P(c))},1E4);break;case "onAbandon":"complete"===document.readyState?E(document,"mouseleave",function(){ba||(ba=!0,P(c))}):E(document,"readystatechange",function(F){"complete"===F.target.readyState&&E(document,"mouseleave",function(){ba||(ba=!0,P(c))})});break;case "onScrollHalfwayDown":E(window,"scroll",function(){if(!ba){var F=Math.max(window.scrollY,document.body.scrollTop,document.documentElement.scrollTop),aa=
Kb();F>=aa/2&&(ba=!0,P(c))}});break;default:ba||(ba=!0,P(c))}}else if("nps"===c.type)document.getElementById("countly-"+r+"-wrapper-"+c._id).style.display="block",document.getElementById("csbg").style.display="block";else if("rating"===c.type){var mc=!1;"complete"===document.readyState?mc||(mc=!0,Gb(c)):E(document,"readystatechange",function(F){"complete"!==F.target.readyState||mc||(mc=!0,Gb(c))})}}catch(F){b(e,a).call(a,f.ERROR,"present_feedback_widget, Something went wrong while presenting the widget: "+
F)}}}else b(e,a).call(a,f.WARNING,"present_feedback_widget, window object is not available. Not presenting feedback widget.")});x(this,"recordError",function(c,d,g){if(b(zb,a)){if(b(e,a).call(a,f.INFO,"recordError, Recording error"),a.check_consent("crashes")&&c){g=g||b(sb,a);var h="";"object"===U(c)?"undefined"!==typeof c.stack?h=c.stack:("undefined"!==typeof c.name&&(h+=c.name+":"),"undefined"!==typeof c.message&&(h+=c.message+"\n"),"undefined"!==typeof c.fileName&&(h+="in "+c.fileName+"\n"),"undefined"!==
typeof c.lineNumber&&(h+="on "+c.lineNumber),"undefined"!==typeof c.columnNumber&&(h+=":"+c.columnNumber)):h=c+"";if(h.length>b(za,a)*b(ya,a)){b(e,a).call(a,f.DEBUG,"record_error, Error stack is too long will be truncated");c=h.split("\n");c.length>b(ya,a)&&(c=c.splice(0,b(ya,a)));h=0;for(var n=c.length;h<n;h++)c[h].length>b(za,a)&&(c[h]=c[h].substring(0,b(za,a)));h=c.join("\n")}d=!!d;c=b(Eb,a).call(a);h={_resolution:c._resolution,_error:h,_app_version:c._app_version,_run:I()-b(Mb,a),_not_os_specific:!0,
_javascript:!0};if(n=navigator.battery||navigator.webkitBattery||navigator.mozBattery||navigator.msBattery)h._bat=Math.floor(100*n.level);"undefined"!==typeof navigator.onLine&&(h._online=!!navigator.onLine);A&&(h._background=!document.hasFocus());0<b(sa,a).length&&(h._logs=b(sa,a).join("\n"));k(sa,a,[]);h._nonfatal=d;h._view=a.getViewName();"undefined"!==typeof g&&(g=ra(g,b(K,a),b(H,a),b(Y,a),"record_error",b(e,a)),h._custom=g);try{var l=document.createElement("canvas").getContext("experimental-webgl");
h._opengl=l.getParameter(l.VERSION)}catch(r){b(e,a).call(a,f.ERROR,"Could not get the experimental-webgl context: "+r)}d={};d.metrics=JSON.stringify({_ua:c._ua});b(jb,a)&&"function"===typeof b(jb,a)&&(b(e,a).call(a,f.VERBOSE,"recordError, Applying crash filter to:["+JSON.stringify(h)+"]"),h=b(jb,a).call(a,h),b(e,a).call(a,f.VERBOSE,"recordError, Filtered crash object:["+JSON.stringify(h)+"]"));h?(d.crash=JSON.stringify(h),b(W,a).call(a,d)):b(e,a).call(a,f.DEBUG,"recordError, Crash object was filtered out")}}else b(e,
a).call(a,f.WARNING,"recordError, Crash tracking is disabled by the server config. Not tracking errors.")});p(this,Bc,function(){b(e,a).call(a,f.INFO,"checkIgnore, Checking if user or visit should be ignored");a.ignore_prefetch&&A&&"undefined"!==typeof document.visibilityState&&"prerender"===document.visibilityState&&(a.ignore_visitor=!0,b(e,a).call(a,f.DEBUG,"checkIgnore, Ignoring visit due to prerendering"));a.ignore_bots&&Oc()&&(a.ignore_visitor=!0,b(e,a).call(a,f.DEBUG,"checkIgnore, Ignoring visit due to bot"))});
x(this,"content",{enterContentZone:function(){b(Ha,a).call(a)},refreshContentZone:function(){b(Yc,a).call(a)},exitContentZone:function(){b(dc,a).call(a)}});p(this,Ha,function(c){A?b(Sa,a)&&!c?b(e,a).call(a,f.DEBUG,"content.enterContentZone, Already in content zone"):!b(Yb,a)||4E3>$a()-b(Yb,a)?(b(e,a).call(a,f.DEBUG,"content.enterContentZone, Not enough time passed since initialization"),setTimeout(function(){b(Ha,a).call(a)},4001)):(b(e,a).call(a,f.INFO,"content.enterContentZone, Entering content zone"),
k(Sa,a,!0),c||b(Cc,a).call(a),k(hb,a,setInterval(function(){b(Cc,a).call(a)},b(kb,a)))):b(e,a).call(a,f.WARNING,"content.enterContentZone, window object is not available. Not entering content zone.")});p(this,Yc,function(){b(Rb,a)?(b(e,a).call(a,f.INFO,"content.refreshContentZone, Refreshing content zone"),b(dc,a).call(a),b(Ba,a).call(a),b(Aa,a).call(a),setTimeout(function(){b(Ha,a).call(a)},1E3)):b(e,a).call(a,f.DEBUG,"content.refreshContentZone, Refresh content zone is disabled")});p(this,dc,function(){b(Sa,
a)?(b(e,a).call(a,f.INFO,"content.exitContentZone, Exiting content zone"),k(Sa,a,!1),b(hb,a)&&(clearInterval(b(hb,a)),b(e,a).call(a,f.DEBUG,"content.exitContentZone, content zone exited"))):b(e,a).call(a,f.DEBUG,"content.exitContentZone, Not in content zone")});p(this,Zc,function(){b(e,a).call(a,f.DEBUG,"prepareContentRequest, forming content request");var c=b(Fb,a).call(a,!0),d={l:{},p:{}},g=Math.max(c.width,c.height);c=Math.min(c.width,c.height);d.l.w=g;d.l.h=c;d.p.w=c;d.p.h=g;d={method:"queue",
la:(navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage).split("-")[0],resolution:JSON.stringify(d),cly_ws:1,cly_origin:window.location.origin,dt:sc()};b(Ya,a).call(a,d);return d});p(this,Cc,function(){b(e,a).call(a,f.DEBUG,"sendContentRequest, sending content request");var c=b(Zc,a).call(a);b(ea,a).call(a,"sendContentRequest,",a.url+b(vc,a),c,function(d,g,h){if(!d)if(h){try{var n=JSON.parse(h)}catch(r){b(e,a).call(a,f.VERBOSE,"sendContentRequest, No content to display or an error while parsing content: "+
r);return}if(n.html&&n.geo){b($c,a).call(a,n);clearInterval(b(hb,a));window.addEventListener("message",function(r){b(ad,a).call(a,r)});var l;window.addEventListener("resize",function(){clearTimeout(l);l=setTimeout(function(){var r=window.innerWidth,u=window.innerHeight,z=document.getElementById(b(ib,a));z&&z.contentWindow.postMessage({type:"resize",width:r,height:u},"*")},200)})}else b(e,a).call(a,f.VERBOSE,"sendContentRequest, no html content or orientation to display")}else b(e,a).call(a,f.VERBOSE,
"sendContentRequest, no content to display")},!0)});p(this,$c,function(c){try{var d=document.createElement("iframe");d.id=b(ib,a);d.src=c.html;d.style.position="absolute";var g=c.geo.p,h=b(Fb,a).call(a,!0);h.width>=h.height&&(g=c.geo.l);d.style.left=g.x+"px";d.style.top=g.y+"px";d.style.width=g.w+"px";d.style.height=g.h+"px";d.style.border="none";d.style.zIndex="999999";document.body.appendChild(d)}catch(n){b(e,a).call(a,f.ERROR,"displayContent, Error while creating iframe for the content: "+n)}});
p(this,ad,function(c){if(-1!==a.contentWhitelist.indexOf(c.origin)){b(e,a).call(a,f.DEBUG,"interpretContentMessage, Received message from: ["+c.origin+"] with data: ["+JSON.stringify(c.data)+"]");var d=c.data;c=d.close;var g=d.link,h=d.event;d=d.resize_me;if(h){b(e,a).call(a,f.DEBUG,"interpretContentMessage, Received event");1===c&&(b(e,a).call(a,f.DEBUG,"interpretContentMessage, Closing content frame for event"),b(ec,a).call(a));if(!Array.isArray(h)){if("object"===U(h))throw new TypeError('"event" is read-only');
b(e,a).call(a,f.ERROR,"interpretContentMessage, Invalid event type: ["+U(h)+"]");return}for(var n=0;n<h.length;n++)b(da,a).call(a,h[n])}g&&(1===c&&(b(e,a).call(a,f.DEBUG,"interpretContentMessage, Closing content frame for link"),b(ec,a).call(a)),window.open(g,"_blank"),b(e,a).call(a,f.DEBUG,"interpretContentMessage, Opened link in new tab: [".concat(g,"]")));if(d){b(e,a).call(a,f.DEBUG,"interpretContentMessage, Resizing iframe");h=b(Fb,a).call(a,!0);if(!d.l||!d.p){b(e,a).call(a,f.ERROR,"interpretContentMessage, Invalid resize object");
return}g=d.p;h.width>=h.height&&(g=d.l);d=document.getElementById(b(ib,a));d.style.left=g.x+"px";d.style.top=g.y+"px";d.style.width=g.w+"px";d.style.height=g.h+"px"}1===c&&b(ec,a).call(a)}});p(this,ec,function(){var c=document.getElementById(b(ib,a));c&&(c.remove(),b(e,a).call(a,f.DEBUG,"interpretContentMessage, removed iframe"),b(Sa,a)&&b(Ha,a).call(a,!0))});p(this,Aa,function(){0<b(O,a).length&&(b(e,a).call(a,f.DEBUG,"Flushing events"),b(W,a).call(a,{events:JSON.stringify(b(O,a))}),k(O,a,[]),b(y,
a).call(a,"cly_event",b(O,a)))});p(this,fc,function(c,d){if(A)if(document.getElementById("countly-feedback-sticker-"+c._id))b(e,a).call(a,f.ERROR,"Widget with same ID exists");else try{var g=document.createElement("div");g.className="countly-iframe-wrapper";g.id="countly-iframe-wrapper-"+c._id;var h=document.createElement("span");h.className="countly-feedback-close-icon";h.id="countly-feedback-close-icon-"+c._id;h.innerText="x";var n=document.createElement("iframe");n.name="countly-feedback-iframe";
n.id="countly-feedback-iframe";n.src=a.url+"/feedback?widget_id="+c._id+"&app_key="+a.app_key+"&device_id="+a.device_id+"&sdk_version="+b(oa,a);document.body.appendChild(g);g.appendChild(h);g.appendChild(n);E(document.getElementById("countly-feedback-close-icon-"+c._id),"click",function(){document.getElementById("countly-iframe-wrapper-"+c._id).style.display="none";document.getElementById("cfbg").style.display="none"});if(d){var l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.id=
"feedback-sticker-svg";l.setAttribute("aria-hidden","true");l.setAttribute("data-prefix","far");l.setAttribute("data-icon","grin");l.setAttribute("class","svg-inline--fa fa-grin fa-w-16");l.setAttribute("role","img");l.setAttribute("xmlns","http://www.w3.org/2000/svg");l.setAttribute("viewBox","0 0 496 512");var r=document.createElementNS("http://www.w3.org/2000/svg","path");r.id="smileyPathInStickerSvg";r.setAttribute("fill","white");r.setAttribute("d","M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm105.6-151.4c-25.9 8.3-64.4 13.1-105.6 13.1s-79.6-4.8-105.6-13.1c-9.9-3.1-19.4 5.4-17.7 15.3 7.9 47.1 71.3 80 123.3 80s115.3-32.9 123.3-80c1.6-9.8-7.7-18.4-17.7-15.3zM168 240c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm160 0c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32z");
var u=document.createElement("span");u.innerText=c.trigger_button_text;var z=document.createElement("div");z.style.color=7>c.trigger_font_color.length?"#"+c.trigger_font_color:c.trigger_font_color;z.style.backgroundColor=7>c.trigger_bg_color.length?"#"+c.trigger_bg_color:c.trigger_bg_color;z.className="countly-feedback-sticker  "+c.trigger_position+"-"+c.trigger_size;z.id="countly-feedback-sticker-"+c._id;l.appendChild(r);z.appendChild(l);z.appendChild(u);document.body.appendChild(z);var D=document.getElementById("smileyPathInStickerSvg");
D&&(D.style.fill=7>c.trigger_font_color.length?"#"+c.trigger_font_color:c.trigger_font_color);E(document.getElementById("countly-feedback-sticker-"+c._id),"click",function(){document.getElementById("countly-iframe-wrapper-"+c._id).style.display="block";document.getElementById("cfbg").style.display="block"})}else document.getElementById("countly-iframe-wrapper-"+c._id).style.display="block",document.getElementById("cfbg").style.display="block"}catch(S){b(e,a).call(a,f.ERROR,"Somethings went wrong while element injecting process: "+
S)}else b(e,a).call(a,f.WARNING,"processWidget, window object is not available. Not processing widget.")});p(this,Dc,function(){var c;if("undefined"!==typeof a.onload&&0<a.onload.length){for(c=0;c<a.onload.length;c++)if("function"===typeof a.onload[c])a.onload[c](a);a.onload=[]}});p(this,gc,function(){if(b(X,a))if(b(yb,a)){b(e,a).call(a,f.INFO,"reportViewDuration, Reporting view duration for: ["+b(X,a)+"]");var c={name:b(X,a)};a.check_consent("views")&&(b(da,a).call(a,{key:R.VIEW,dur:b(ta,a)?I()-
b(Ma,a):b(Na,a),segmentation:c},b(va,a)),k(X,a,null))}else b(e,a).call(a,f.INFO,"reportViewDuration, View tracking is disabled by the server config. Not tracking view duration");else b(e,a).call(a,f.INFO,"reportViewDuration, No last view, will not report view duration")});p(this,bd,function(){b(e,a).call(a,f.INFO,"getLastView, Getting last view: ["+b(X,a)+"]");return b(X,a)});p(this,Ec,function(){if(b(ma,a)){b(e,a).call(a,f.DEBUG,"Extending session");var c=b(B,a).call(a,"cly_session");if(!c||parseInt(c)<=
I())k(ca,a,!1),a.begin_session(!b(La,a));b(y,a).call(a,"cly_session",I()+60*b(Pa,a))}else b(e,a).call(a,f.DEBUG,"Will not extend the session as session cookie is disabled")});p(this,Ya,function(c){c.app_key=a.app_key;c.device_id=a.device_id;c.sdk_name=b(wa,a);c.sdk_version=b(oa,a);c.t=b(J,a);c.av=a.app_version;var d=b(Fc,a).call(a);if(c.metrics){var g=JSON.parse(c.metrics);g._ua||(g._ua=d,c.metrics=JSON.stringify(g))}else c.metrics=JSON.stringify({_ua:d});a.check_consent("location")&&b(Qb,a)?(a.country_code&&
(c.country_code=a.country_code),a.city&&(c.city=a.city),null!==a.ip_address&&(c.ip_address=a.ip_address)):c.location="";c.timestamp=$a();b(Cb,a)&&(b(e,a).call(a,f.DEBUG,"prepareRequest, testing timestamp is set to: "+b(Cb,a)),c.timestamp=b(Cb,a));d=new Date;c.hour=d.getHours();c.dow=d.getDay();c.tz=-d.getTimezoneOffset()});p(this,W,function(c){a.ignore_visitor?b(e,a).call(a,f.DEBUG,"User is opt_out will ignore the request: "+c):b(lb,a)?a.app_key&&a.device_id?(b(Ya,a).call(a,c),b(L,a).length>b(pa,
a)&&b(L,a).shift(),b(L,a).push(c),b(y,a).call(a,"cly_queue",b(L,a),!0)):b(e,a).call(a,f.ERROR,"app_key or device_id is missing ",a.app_key,a.device_id):b(e,a).call(a,f.DEBUG,"Tracking is disabled by server config, will not track the request: "+JSON.stringify(c))});p(this,Db,function(){b(Dc,a).call(a);if(a.ignore_visitor)k(fb,a,!1),b(e,a).call(a,f.WARNING,"User opt_out:["+a.ignore_visitor+"], no heartbeat");else{k(fb,a,!0);b(bb,a)&&"undefined"!==typeof t.q&&0<t.q.length&&b(Ba,a).call(a);if(b(ca,a)&&
b(La,a)&&b(ta,a)){var c=I();c-b(la,a)>b(Ta,a)&&(a.session_duration(c-b(la,a)),k(la,a,c),0<a.hcErrorCount&&b(y,a).call(a,Q.errorCount,a.hcErrorCount),0<a.hcWarningCount&&b(y,a).call(a,Q.warningCount,a.hcWarningCount))}0<b(O,a).length&&!a.test_mode_eq&&(b(O,a).length<=b(Fa,a)?(b(W,a).call(a,{events:JSON.stringify(b(O,a))}),k(O,a,[])):(c=b(O,a).splice(0,b(Fa,a)),b(W,a).call(a,{events:JSON.stringify(c)})),b(y,a).call(a,"cly_event",b(O,a)));c=I();var d=!1;b(Xa,a)&&c<b(Ga,a)?(d=!0,b(Ab,a)||(b(e,a).call(a,
f.VERBOSE,"Request back-off active, suspending requests until: "+b(Ga,a)+", current time: "+c),k(Ab,a,!0))):b(Xa,a)&&c>=b(Ga,a)&&(b(e,a).call(a,f.INFO,"Request back-off period ended, resuming normal request processing"),k(Xa,a,!1),k(Ga,a,0),d=!1,k(Ab,a,!1));!d&&!b(N,a)&&0<b(L,a).length&&b(eb,a)&&I()>b(ub,a)&&(k(eb,a,!1),c=b(L,a)[0],c.rr=b(L,a).length,b(e,a).call(a,f.DEBUG,"Processing request",c),b(y,a).call(a,"cly_queue",b(L,a),!0),a.test_mode||b(ea,a).call(a,"send_request_queue",a.url+b(rb,a),c,
function(g,h){g?k(ub,a,I()+b(db,a)):(b(L,a).shift(),b(cd,a).call(a,h));b(y,a).call(a,"cly_queue",b(L,a),!0);k(eb,a,!0)},!1));setTimeout(function(){b(Db,a).call(a)},b(cb,a))}});p(this,cd,function(c){if(b(Sb,a)&&!b(Xa,a)){var d=b(Wa,a)>b(Tb,a);if(d){var g=b(L,a).length<b(pa,a)*b(Ub,a),h=I();c=h-(c&&c.timestamp?c.timestamp:h);var n=c<3600*b(Vb,a);d&&g&&n?(b(e,a).call(a,f.INFO,"Activating request back-off: response time ["+b(Wa,a)+"s], queue size ["+b(L,a).length+"/"+b(pa,a)+"], request age ["+c+"s]"),
k(Xa,a,!0),k(Ga,a,h+b(Wb,a)),b(ka,a).incrementBackoffCount(),b(e,a).call(a,f.INFO,"Request back-off activated until: "+b(Ga,a))):(b(e,a).call(a,f.DEBUG,"No back-off conditions met: response time ["+b(Wa,a)+"s], queue size ["+b(L,a).length+"/"+b(pa,a)+"], request age ["+c+"s]"),b(ka,a).resetLastRequestBackoffStatus())}}});p(this,dd,function(){return b(xb,a)});p(this,Ba,function(){if("undefined"===typeof t||"undefined"===typeof t.i)b(e,a).call(a,f.DEBUG,"Countly is not finished initialization yet, will process the queue after initialization is done");
else{var c=t.q;t.q=[];for(var d=0;d<c.length;d++){var g=c[d];b(e,a).call(a,f.DEBUG,"Processing queued calls:"+g);if("function"===typeof g)g();else if(Array.isArray(g)&&0<g.length){var h=a,n=0;try{t.i[g[n]]&&(h=t.i[g[n]],n++)}catch(r){b(e,a).call(a,f.DEBUG,"No instance found for the provided key while processing async queue");t.q.push(g);continue}if("function"===typeof h[g[n]])h[g[n]].apply(h,g.slice(n+1));else if(0===g[n].indexOf("userData.")){var l=g[n].replace("userData.","");"function"===typeof h.userData[l]&&
h.userData[l].apply(h,g.slice(n+1))}else 0===g[n].indexOf("content.")?(l=g[n].replace("content.",""),"function"===typeof h.content[l]&&h.content[l].apply(h,g.slice(n+1))):0===g[n].indexOf("feedback.")?(l=g[n].replace("feedback.",""),"function"===typeof h.feedback[l]&&h.feedback[l].apply(h,g.slice(n+1))):"function"===typeof t[g[n]]&&t[g[n]].apply(t,g.slice(n+1))}}}});p(this,hc,function(){var c=b(B,a).call(a,"cly_id");return c?(k(J,a,b(B,a).call(a,"cly_id_type")),c):oc()});p(this,ed,function(c){return/[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-4[0-9a-fA-F]{3}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}/.test(c)});
p(this,Fc,function(){return a.metrics&&a.metrics._ua?a.metrics._ua:ab()});p(this,Eb,function(){var c=JSON.parse(JSON.stringify(a.metrics||{}));c._app_version=c._app_version||a.app_version;c._ua=c._ua||ab();var d=b(Fb,a).call(a);d&&(d=""+d.width+"x"+d.height,c._resolution=c._resolution||d);A&&window.devicePixelRatio&&(c._density=c._density||window.devicePixelRatio);d=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;"undefined"!==typeof d&&(c._locale=c._locale||
d);b(ic,a).call(a)&&(c._store=c._store||document.referrer);b(e,a).call(a,f.DEBUG,"Got metrics",c);return c});p(this,Fb,function(c){b(e,a).call(a,f.DEBUG,"Getting the resolution of the device");if(!A||!screen)return b(e,a).call(a,f.DEBUG,"No screen available"),null;var d=screen.width?parseInt(screen.width):0,g=screen.height?parseInt(screen.height):0;if(c){c=Math.min(window.innerWidth,document.documentElement.clientWidth);var h=Math.min(window.innerHeight,document.documentElement.clientHeight);d=c?
parseInt(c):d;g=h?parseInt(h):g}if(0===d||0===g)return b(e,a).call(a,f.DEBUG,"Screen width or height is non existent"),null;navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)&&window.devicePixelRatio&&(b(e,a).call(a,f.VERBOSE,"Mobile Mac device detected, adjusting resolution"),d=Math.round(d*window.devicePixelRatio),g=Math.round(g*window.devicePixelRatio));return{width:d,height:g}});p(this,ic,function(c){if(!A)return!1;c=c||document.referrer;var d=!1;if("undefined"===typeof c||0===c.length)b(e,
a).call(a,f.DEBUG,"Invalid referrer:["+c+"], ignoring.");else{var g=Vc.exec(c);if(g)if(g[11])if(g[11]===window.location.hostname)b(e,a).call(a,f.DEBUG,"Referrer is current host:["+c+"], ignoring.");else if(b(ha,a)&&b(ha,a).length)for(d=!0,g=0;g<b(ha,a).length;g++){if(0<=c.indexOf(b(ha,a)[g])){b(e,a).call(a,f.DEBUG,"Referrer in ignore list:["+c+"], ignoring.");d=!1;break}}else b(e,a).call(a,f.DEBUG,"Valid referrer:["+c+"]"),d=!0;else b(e,a).call(a,f.DEBUG,"No path found in referrer:["+c+"], ignoring.");
else b(e,a).call(a,f.DEBUG,"Referrer is corrupt:["+c+"], ignoring.")}return d});p(this,e,function(c,d,g){if(a.debug&&"undefined"!==typeof console){g&&"object"===U(g)&&(g=JSON.stringify(g));b(bb,a)||(d="["+a.app_key+"] "+d);c||(c=f.DEBUG);var h="";g&&(h=" "+g);d=c+"[Countly] "+d+h;c===f.ERROR?(console.error(d),b(ka,a).incrementErrorCount()):c===f.WARNING?(console.warn(d),b(ka,a).incrementWarningCount()):c===f.INFO?console.info(d):c===f.VERBOSE?console.log(d):console.debug(d)}});p(this,ea,function(c,
d,g,h,n,l){b(Nb,a)||l?(b(xb,a).push({functionName:c,url:d,params:g}),A?b(Gc,a).call(a,c,d,g,h,n):b(Hc,a).call(a,c,d,g,h,n)):b(e,a).call(a,f.DEBUG,"Network request is disabled by the SCNetwork")});p(this,Gc,function(c,d,g,h,n){n=n||!1;try{b(e,a).call(a,f.DEBUG,"Sending XML HTTP request");var l=new XMLHttpRequest;l.timeout=b(Zb,a);l.ontimeout=function(){b(e,a).call(a,f.ERROR,c+" timed out after 30 seconds");"function"===typeof h&&h(!0,g,"timeout")};g=g||{};qc(g,a.salt).then(function(r){var u="POST";
if(a.force_post||2E3<=r.length)u="POST";"GET"===u?l.open("GET",d+"?"+r,!0):(l.open("POST",d,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"));for(var z in a.headers)l.setRequestHeader(z,a.headers[z]);var D=I();l.onreadystatechange=function(){if(4===l.readyState){var S=I()-D;k(Wa,a,S);b(e,a).call(a,f.DEBUG,c+" HTTP request completed with status code: ["+l.status+"] and response: ["+l.responseText+"], duration: ["+S+"] seconds");(n?b(kc,a).call(a,l.status,l.responseText):b(jc,
a).call(a,l.status,l.responseText))?"function"===typeof h&&h(!1,g,l.responseText):(b(e,a).call(a,f.ERROR,c+" Invalid response from server"),"send_request_queue"===c&&b(ka,a).saveRequestCounters(l.status,l.responseText),"function"===typeof h&&h(!0,g,l.status,l.responseText))}};"GET"===u?l.send():l.send(r)})}catch(r){b(e,a).call(a,f.ERROR,c+" Something went wrong while making an XML HTTP request: "+r),"function"===typeof h&&h(!0,g)}});p(this,Hc,function(c,d,g,h,n){n=n||!1;var l;try{b(e,a).call(a,f.DEBUG,
"Sending Fetch request");var r="POST",u={"Content-type":"application/x-www-form-urlencoded"},z=null;g=g||{};qc(g,a.salt).then(function(D){a.force_post||2E3<=D.length?(r="POST",z=D):d+="?"+D;for(var S in a.headers)u[S]=a.headers[S];var T=I(),Ca=new AbortController;D=Ca.signal;var ob=setTimeout(function(){return Ca.abort()},b(Zb,a));fetch(d,{method:r,headers:u,body:z,signal:D}).then(function(P){clearTimeout(ob);l=P;return l.text()}).then(function(P){var Gb=I()-T;k(Wa,a,Gb);b(e,a).call(a,f.DEBUG,c+" Fetch request completed wit status code: ["+
l.status+"] and response: ["+P+"], duration: ["+Gb+"] seconds");(n?b(kc,a).call(a,l.status,P):b(jc,a).call(a,l.status,P))?"function"===typeof h&&h(!1,g,P):(b(e,a).call(a,f.ERROR,c+" Invalid response from server"),"send_request_queue"===c&&b(ka,a).saveRequestCounters(l.status,P),"function"===typeof h&&h(!0,g,l.status,P))})["catch"](function(P){clearTimeout(ob);"AbortError"===P.name?(b(e,a).call(a,f.ERROR,c+" timed out after 30 seconds"),"function"===typeof h&&h(!0,g,"timeout")):(b(e,a).call(a,f.ERROR,
c+" Failed Fetch request: "+P),"function"===typeof h&&h(!0,g))})})}catch(D){b(e,a).call(a,f.ERROR,c+" Something went wrong with the Fetch request attempt: "+D),"function"===typeof h&&h(!0,g)}});p(this,jc,function(c,d){if(!(200<=c&&300>c))return b(e,a).call(a,f.ERROR,"Http response status code:["+c+"] is not within the expected range"),!1;try{var g=JSON.parse(d);return"[object Object]"!==Object.prototype.toString.call(g)?(b(e,a).call(a,f.ERROR,"Http response is not JSON Object"),!1):!!g.result}catch(h){return b(e,
a).call(a,f.ERROR,"Http response is not JSON: "+h),!1}});p(this,kc,function(c,d){if(!(200<=c&&300>c))return b(e,a).call(a,f.ERROR,"Http response status code:["+c+"] is not within the expected range"),!1;try{var g=JSON.parse(d);return"[object Object]"===Object.prototype.toString.call(g)||Array.isArray(g)||"No content block found!"===g?!0:(b(e,a).call(a,f.ERROR,"Http response is not JSON Object nor JSON Array"),!1)}catch(h){return b(e,a).call(a,f.ERROR,"Http response is not JSON: "+h),!1}});p(this,
Ic,function(){A?k(Ra,a,Math.max(b(Ra,a),window.scrollY,document.body.scrollTop,document.documentElement.scrollTop)):b(e,a).call(a,f.WARNING,"processScroll, window object is not available. Not processing scroll.")});p(this,lc,function(){if(!A)b(e,a).call(a,f.WARNING,"processScrollView, window object is not available. Not processing scroll view.");else if(b(Qa,a)){k(Qa,a,!1);var c=Kb(),d=uc(),g=Pc();a.check_consent("scrolls")&&(c={type:"scroll",y:b(Ra,a)+g,width:d,height:c,view:a.getViewUrl()},c=ra(c,
b(K,a),b(H,a),b(Y,a),"processScrollView",b(e,a)),a.track_domains&&(c.domain=window.location.hostname),b(da,a).call(a,{key:R.ACTION,segmentation:c}))}});p(this,fd,function(){return b(J,a)});p(this,Jc,function(c){b(y,a).call(a,"cly_token",c)});p(this,gd,function(){var c=b(B,a).call(a,"cly_token");b(Z,a).call(a,"cly_token");return c});p(this,hd,function(){return b(O,a)});p(this,id,function(){return b(L,a)});p(this,jd,function(c){c+="=";for(var d=document.cookie.split(";"),g=0,h=d.length;g<h;g++){for(var n=
d[g];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(c))return n.substring(c.length,n.length)}return null});p(this,Kc,function(c,d,g){var h=new Date;h.setTime(h.getTime()+864E5*g);g="; expires="+h.toGMTString();document.cookie=c+"="+d+g+"; path=/"});p(this,B,function(c,d,g){if("none"===a.storage||"object"!==U(a.storage)&&!A)b(e,a).call(a,f.DEBUG,"Storage is disabled. Value with key: ["+c+"] won't be retrieved");else{g||(c=a.app_key+"/"+c,a.namespace&&(c=Ja(a.namespace)+"/"+c));if(a.storage&&
"object"===U(a.storage)&&"function"===typeof a.storage.getItem){var h=a.storage.getItem(c);return c.endsWith("cly_id")?h:a.deserialize(h)}void 0===d&&(d=b(ua,a));try{return d?h=localStorage.getItem(c):"localstorage"!==a.storage&&(h=b(jd,a).call(a,c)),c.endsWith("cly_id")?h:a.deserialize(h)}catch(n){}}});p(this,y,function(c,d,g,h){if("none"===a.storage||"object"!==U(a.storage)&&!A)b(e,a).call(a,f.DEBUG,"Storage is disabled. Value with key: "+c+" won't be stored");else{h||(c=a.app_key+"/"+c,a.namespace&&
(c=Ja(a.namespace)+"/"+c));try{"undefined"!==typeof d&&null!==d&&("object"===U(a.storage)&&"function"===typeof a.storage.setItem?a.storage.setItem(c,d):(void 0===g&&(g=b(ua,a)),d=a.serialize(d),g?localStorage.setItem(c,d):"localstorage"!==a.storage&&b(Kc,a).call(a,c,d,30)))}catch(n){}}});p(this,Z,function(c,d,g){if("none"===a.storage||"object"!==U(a.storage)&&!A)b(e,a).call(a,f.DEBUG,"Storage is disabled. Value with key: "+c+" won't be removed");else{g||(c=a.app_key+"/"+c,a.namespace&&(c=Ja(a.namespace)+
"/"+c));try{"object"===U(a.storage)&&"function"===typeof a.storage.removeItem?a.storage.removeItem(c):(void 0===d&&(d=b(ua,a)),d?localStorage.removeItem(c):"localstorage"!==a.storage&&b(Kc,a).call(a,c,"",-1))}catch(h){}}});p(this,kd,function(){if(b(B,a).call(a,a.namespace+"cly_id",!1,!0)){b(y,a).call(a,"cly_id",b(B,a).call(a,a.namespace+"cly_id",!1,!0));b(y,a).call(a,"cly_id_type",b(B,a).call(a,a.namespace+"cly_id_type",!1,!0));b(y,a).call(a,"cly_event",b(B,a).call(a,a.namespace+"cly_event",!1,!0));
b(y,a).call(a,"cly_session",b(B,a).call(a,a.namespace+"cly_session",!1,!0));var c=b(B,a).call(a,a.namespace+"cly_queue",!1,!0);Array.isArray(c)&&(c=c.filter(function(d){return d.app_key===a.app_key}),b(y,a).call(a,"cly_queue",c));b(B,a).call(a,a.namespace+"cly_cmp_id",!1,!0)&&(b(y,a).call(a,"cly_cmp_id",b(B,a).call(a,a.namespace+"cly_cmp_id",!1,!0)),b(y,a).call(a,"cly_cmp_uid",b(B,a).call(a,a.namespace+"cly_cmp_uid",!1,!0)));b(B,a).call(a,a.namespace+"cly_ignore",!1,!0)&&b(y,a).call(a,"cly_ignore",
b(B,a).call(a,a.namespace+"cly_ignore",!1,!0));b(Z,a).call(a,"cly_id",!1,!0);b(Z,a).call(a,"cly_id_type",!1,!0);b(Z,a).call(a,"cly_event",!1,!0);b(Z,a).call(a,"cly_session",!1,!0);b(Z,a).call(a,"cly_queue",!1,!0);b(Z,a).call(a,"cly_cmp_id",!1,!0);b(Z,a).call(a,"cly_cmp_uid",!1,!0);b(Z,a).call(a,"cly_ignore",!1,!0)}});p(this,ld,function(c,d){b(e,a).call(a,f.DEBUG,"onStorageChange, Applying storage changes for key:",c);b(e,a).call(a,f.DEBUG,"onStorageChange, Applying storage changes for value:",d);
switch(c){case "cly_queue":k(L,a,a.deserialize(d||"[]"));break;case "cly_event":k(O,a,a.deserialize(d||"[]"));break;case "cly_remote_configs":k(V,a,a.deserialize(d||"{}"));break;case "cly_ignore":a.ignore_visitor=a.deserialize(d);break;case "cly_config":k(xa,a,a.deserialize(d||"{}"));b(ac,a).call(a,b(xa,a));break;case "cly_id":a.device_id=d;break;case "cly_id_type":k(J,a,a.deserialize(d))}});p(this,md,function(){k(L,a,[]);b(y,a).call(a,"cly_queue",[]);k(O,a,[]);b(y,a).call(a,"cly_event",[])});p(this,
nd,function(){return{eventQ:b(O,a),requestQ:b(L,a)}});x(this,"_internals",{store:b(y,this),getDocWidth:uc,getDocHeight:Kb,getViewportHeight:Pc,get_page_coord:tc,get_event_target:Jb,add_event_listener:E,createNewObjectFromProperties:pb,truncateObject:ra,truncateSingleValue:C,stripTrailingSlash:Ja,prepareParams:qc,sendXmlHttpRequest:b(Gc,this),isResponseValid:b(jc,this),getInternalDeviceIdType:b(fd,this),getMsTimestamp:$a,getTimestamp:I,isResponseValidBroad:b(kc,this),secureRandom:nc,log:b(e,this),
checkIfLoggingIsOn:Ib,getMetrics:b(Eb,this),getUA:b(Fc,this),prepareRequest:b(Ya,this),generateUUID:oc,sendEventsForced:b(Aa,this),isUUID:b(ed,this),calculateChecksum:Nc,isReferrerUsable:b(ic,this),getId:b(hc,this),heartBeat:b(Db,this),toRequestQueue:b(W,this),reportViewDuration:b(gc,this),loadJS:Rc,loadCSS:Lb,getLastView:b(bd,this),setToken:b(Jc,this),getToken:b(gd,this),showLoader:Sc,hideLoader:Tc,setValueInStorage:b(y,this),getValueFromStorage:b(B,this),removeValueFromStorage:b(Z,this),add_cly_events:b(da,
this),processScrollView:b(lc,this),processScroll:b(Ic,this),currentUserAgentString:ab,currentUserAgentDataString:rc,userAgentDeviceDetection:sc,userAgentSearchBotDetection:Oc,getRequestQueue:b(id,this),getEventQueue:b(hd,this),sendFetchRequest:b(Hc,this),processAsyncQueue:b(Ba,this),makeNetworkRequest:b(ea,this),onStorageChange:b(ld,this),clearQueue:b(md,this),getLocalQueues:b(nd,this),testingGetRequests:b(dd,this)});p(this,ka,{sendInstantHCRequest:function(){if(b(N,a))b(e,a).call(a,f.DEBUG,"sendInstantHCRequest, Offline mode is active. Not sending health check request."),
k(wb,a,!0);else{var c=C(a.hcErrorMessage,1E3,"healthCheck",b(e,a));""!==c&&(c=JSON.stringify(c));c={hc:JSON.stringify({el:a.hcErrorCount,wl:a.hcWarningCount,sc:a.hcStatusCode,em:c,bom:a.hcBackoffCount,cbom:a.hcConsecutiveBackoffCount}),metrics:JSON.stringify({_app_version:a.app_version})};b(Ya,a).call(a,c);b(ea,a).call(a,"[healthCheck]",a.url+b(rb,a),c,function(d){d||b(ka,a).resetAndSaveCounters()},!0)}},resetAndSaveCounters:function(){b(ka,a).resetCounters();b(y,a).call(a,Q.errorCount,a.hcErrorCount);
b(y,a).call(a,Q.warningCount,a.hcWarningCount);b(y,a).call(a,Q.statusCode,a.hcStatusCode);b(y,a).call(a,Q.errorMessage,a.hcErrorMessage);b(y,a).call(a,Q.backoffCount,a.hcBackoffCount);b(y,a).call(a,Q.consecutiveBackoffCount,a.hcConsecutiveBackoffCount)},incrementErrorCount:function(){a.hcErrorCount++},incrementWarningCount:function(){a.hcWarningCount++},incrementBackoffCount:function(){a.hcBackoffCount++;b(Bb,a)&&a.hcConsecutiveBackoffCount++;k(Bb,a,!0);b(y,a).call(a,Q.backoffCount,a.hcBackoffCount);
b(y,a).call(a,Q.consecutiveBackoffCount,a.hcConsecutiveBackoffCount)},resetLastRequestBackoffStatus:function(){k(Bb,a,!1)},resetCounters:function(){a.hcErrorCount=0;a.hcWarningCount=0;a.hcStatusCode=-1;a.hcErrorMessage="";a.hcBackoffCount=0;a.hcConsecutiveBackoffCount=0},saveRequestCounters:function(c,d){a.hcStatusCode=c;a.hcErrorMessage=d;b(y,a).call(a,Q.statusCode,a.hcStatusCode);b(y,a).call(a,Q.errorMessage,a.hcErrorMessage)}});k(Wc,this,this);k(bb,this,!t.i);k(ca,this,!1);k(rb,this,"/i");k(Ka,
this,"/o/sdk");k(L,this,[]);k(O,this,[]);k(V,this,{});k(sa,this,[]);k(fa,this,{});k(sb,this,null);k(La,this,!0);b(la,this);k(tb,this,0);k(X,this,null);k(Ma,this,0);k(Na,this,0);k(ub,this,0);k(Da,this,0);k(eb,this,!0);k(Wa,this,0);k(Ga,this,0);k(Xa,this,!1);k(fb,this,!1);k(ia,this,{});k(ta,this,!0);k(Mb,this,I());k(ua,this,!0);k(Ea,this,null);k(J,this,1);k(Qa,this,!1);k(Ra,this,0);k(vb,this,!1);k(va,this,null);k(gb,this,null);k(na,this,null);k(wb,this,!1);k(xb,this,[]);k(vc,this,"/o/sdk/content");
k(Sa,this,!1);k(hb,this,null);k(ib,this,"cly-content-iframe");k(jb,this,null);k(Nb,this,!0);k(pa,this,w("queue_size",q,1E3));k(Fa,this,w("max_events",q,100));k(Ta,this,w("session_update",q,60));k(kb,this,1E3*Math.max(w("content_zone_timer_interval",q,30),15));k(Ob,this,4);k(lb,this,!0);k(mb,this,!0);k(zb,this,!0);k(yb,this,!0);k(Pb,this,!0);k(Qb,this,!0);k(nb,this,!1);k(Rb,this,!0);k(Ua,this,w("require_consent",q,!1));k(K,this,w("max_key_length",q,128));k(H,this,w("max_value_size",q,256));k(Y,this,
w("max_segmentation_values",q,100));k(Va,this,w("max_breadcrumb_count",q,100));k(ya,this,w("max_stack_trace_lines_per_thread",q,30));k(za,this,w("max_stack_trace_line_length",q,200));k(Sb,this,!w("disable_backoff_mechanism",q,!1));k(Tb,this,10);k(Ub,this,.5);k(Vb,this,24);k(Wb,this,60);k(Zb,this,3E4);this.app_key=w("app_key",q,null);this.url=Ja(w("url",q,""));this.serialize=w("serialize",q,t.serialize);this.deserialize=w("deserialize",q,t.deserialize);k(wc,this,w("disable_sdk_behavior_settings_updates",
q,!1));k(Ab,this,!1);k(Cb,this,w("test_mode_time",q,0));try{localStorage.setItem("cly_testLocal",!0),localStorage.removeItem("cly_testLocal")}catch(c){b(e,this).call(this,f.ERROR,"Local storage test failed, Halting local storage support: "+c),k(ua,this,!1)}k(xa,this,b(B,this).call(this,"cly_config"));b(xa,this)||(k(xa,this,w("behavior_settings",q,{})),b(y,this).call(this,"cly_config",JSON.stringify(b(xa,this))));b(ac,this).call(this,b(xa,this));k(M,this,{});for(var G=0;G<t.features.length;G++)b(M,
this)[t.features[G]]={};b(Xc,this).call(this,q);b(Dc,this).call(this);setTimeout(function(){t.noHeartBeat?b(e,a).call(a,f.WARNING,"initialize, Heartbeat disabled. This is for testing purposes only!"):b(Db,a).call(a);a.remote_config&&a.fetch_remote_config(a.remote_config)},1);A&&document.documentElement.setAttribute("data-countly-useragent",ab());k(Yb,this,$a());b(ka,this).sendInstantHCRequest();b(nb,this)&&(b(Ha,this).call(this),k(Xb,this,!0));b(e,this).call(this,f.INFO,"initialize, Countly initialized")}),
pd=!0;t.features="apm attribution clicks crashes events feedback forms location remote-config scrolls sessions star-rating users views".split(" ");t.q=t.q||[];t.onload=t.onload||[];t.CountlyClass=od;t.init=function(q){q=q||{};if(t.loadAPMScriptsAsync&&pd)pd=!1,qd(q);else{var v=q.app_key||t.app_key;if(!t.i||!t.i[v]){q=new od(q);if(!t.i){t.i={};for(var a in q)t[a]=q[a]}t.i[v]=q}return t.i[v]}};t.serialize=function(q){try{"object"===U(q)&&(q=JSON.stringify(q))}catch(v){}return q};t.deserialize=function(q){if(""===
q)return q;try{q=JSON.parse(q)}catch(v){}return q};t.getViewName=function(){return A?window.location.pathname:"web_worker"};t.getViewUrl=function(){return A?window.location.pathname:"web_worker"};t.getSearchQuery=function(){if(A)return window.location.search};t.DeviceIdType={DEVELOPER_SUPPLIED:0,SDK_GENERATED:1,TEMPORARY_ID:2};A&&window.addEventListener("storage",function(q){var v=(q.key+"").split("/"),a=v.pop();v=v.pop();if(t.i&&t.i[v])t.i[v]._internals.onStorageChange(a,q.newValue)});Ia.default=
t;Object.defineProperty(Ia,"__esModule",{value:!0})});
