(function(Ea,Va){"object"===typeof exports&&"undefined"!==typeof module?Va(exports):"function"===typeof define&&define.amd?define(["exports"],Va):(Ea="undefined"!==typeof globalThis?globalThis:Ea||self,Va(Ea.Countly=Ea.Countly||{}))})(this,function(Ea){function Va(m,q,v){if("function"==typeof m?m===q:m.has(q))return 3>arguments.length?q:v;throw new TypeError("Private element is not present on this object");}function b(m,q){return m.get(Va(m,q))}function p(m,q,v){if(q.has(m))throw new TypeError("Cannot initialize the same private elements twice on an object");
q.set(m,v)}function k(m,q,v){return m.set(Va(m,q),v),v}function w(m,q,v){a:{var a=q;if("object"==typeof a&&a){var G=a[Symbol.toPrimitive];if(void 0!==G){a=G.call(a,"string");if("object"!=typeof a)break a;throw new TypeError("@@toPrimitive must return a primitive value.");}a=String(a)}}return(q="symbol"==typeof a?a:a+"")in m?Object.defineProperty(m,q,{value:v,enumerable:!0,configurable:!0,writable:!0}):m[q]=v,m}function R(m){"@babel/helpers - typeof";return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?
function(q){return typeof q}:function(q){return q&&"function"==typeof Symbol&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},R(m)}function xc(m){var q=[];if("undefined"!==typeof m.options)for(var v=0;v<m.options.length;v++)m.options[v].selected&&q.push(m.options[v].value);return q.join(", ")}function $b(){var m=yc("xxxxxxxx","[x]");var q=Date.now().toString();return m+q}function ac(){return yc("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx","[xy]")}function yc(m,q){var v=(new Date).getTime();
return m.replace(new RegExp(q,"g"),function(a){var G=(v+16*Math.random())%16|0;return("x"===a?G:G&3|8).toString(16)})}function O(){return Math.floor((new Date).getTime()/1E3)}function Wa(){var m=(new Date).getTime();zb>=m?zb++:zb=m;return zb}function x(m,q,v){if(q&&Object.keys(q).length){if("undefined"!==typeof q[m])return q[m]}else if("undefined"!==typeof t[m])return t[m];return v}function bc(m,q,v){for(var a in t.i)t.i[a].tracking_crashes&&t.i[a].recordError(m,q,v)}function cc(m,q){var v=[],a;for(a in m)v.push(a+
"="+encodeURIComponent(m[a]));var G=v.join("&");return q?zc(G,q).then(function(c){return G+="&checksum256="+c}):Promise.resolve(G)}function Fa(m){return"string"===typeof m&&"/"===m.substring(m.length-1)?m.substring(0,m.length-1):m}function lb(m,q){for(var v={},a,G=0,c=q.length;G<c;G++)a=q[G],"undefined"!==typeof m[a]&&(v[a]=m[a]);return v}function oa(m,q,v,a,G,c){var d={};if(m){if(Object.keys(m).length>a){var g={},h=0,n;for(n in m)h<a&&(g[n]=m[n],h++);m=g}for(var l in m)a=C(l,q,G,c),g=C(m[l],v,G,
c),d[a]=g}return d}function C(m,q,v,a){var G=m;"number"===typeof m&&(m=m.toString());"string"===typeof m&&m.length>q&&(G=m.substring(0,q),a(f.DEBUG,v+", Key: [ "+m+" ] is longer than accepted length. It will be truncated."));return G}function zc(m,q){m=(new TextEncoder).encode(m+q);return crypto.subtle.digest("SHA-256",m).then(function(v){return Array.from(new Uint8Array(v)).map(function(a){return a.toString(16).padStart(2,"0")}).join("")})}function D(m,q,v){A&&(null===m||"undefined"===typeof m?Ab()&&
console.warn("[WARNING] [Countly] add_event_listener, Can't bind ["+q+"] event to nonexisting element"):"undefined"!==typeof m.addEventListener?m.addEventListener(q,v,!1):m.attachEvent("on"+q,v))}function Bb(m){return m?"undefined"!==typeof m.target?m.target:m.srcElement:window.event.srcElement}function Xa(m){if(m)return m;(m=navigator.userAgent)||(m=dc());return m}function dc(m){if(m)return m;m="";navigator.userAgentData&&(m=navigator.userAgentData.brands.map(function(q){return q.brand+":"+q.version}).join(),
m+=navigator.userAgentData.mobile?" mobi ":" ",m+=navigator.userAgentData.platform);return m}function ec(m){if(!m){if(navigator.userAgentData&&navigator.userAgentData.mobile)return"phone";m=Xa()}m=m.toLowerCase();var q="desktop",v=/(mobi|ipod|phone|blackberry|opera mini|fennec|minimo|symbian|psp|nintendo ds|archos|skyfire|puffin|blazer|bolt|gobrowser|iris|maemo|semc|teashark|uzard)/;/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(m)?
q="tablet":v.test(m)&&(q="phone");return q}function Ac(m){var q=/(CountlySiteBot|nuhk|Googlebot|GoogleSecurityScanner|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver|bingbot|Google Web Preview|Mediapartners-Google|AdsBot-Google|Baiduspider|Ezooms|YahooSeeker|AltaVista|AVSearch|Mercator|Scooter|InfoSeek|Ultraseek|Lycos|Wget|YandexBot|Yandex|YaDirectFetcher|SiteBot|Exabot|AhrefsBot|MJ12bot|TurnitinBot|magpie-crawler|Nutch Crawler|CMS Crawler|rogerbot|Domnutch|ssearch_bot|XoviBot|netseer|digincore|fr-crawler|wesee|AliasIO|contxbot|PingdomBot|BingPreview|HeadlessChrome|Lighthouse)/;
if(m)return q.test(m);m=q.test(Xa());q=q.test(dc());return m||q}function fc(m){"undefined"===typeof m.pageY&&"number"===typeof m.clientX&&document.documentElement&&(m.pageX=m.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,m.pageY=m.clientY+document.body.scrollTop+document.documentElement.scrollTop);return m}function Cb(){var m=document;return Math.max(Math.max(m.body.scrollHeight,m.documentElement.scrollHeight),Math.max(m.body.offsetHeight,m.documentElement.offsetHeight),Math.max(m.body.clientHeight,
m.documentElement.clientHeight))}function gc(){var m=document;return Math.max(Math.max(m.body.scrollWidth,m.documentElement.scrollWidth),Math.max(m.body.offsetWidth,m.documentElement.offsetWidth),Math.max(m.body.clientWidth,m.documentElement.clientWidth))}function Bc(){var m=document;return Math.min(Math.min(m.body.clientHeight,m.documentElement.clientHeight),Math.min(m.body.offsetHeight,m.documentElement.offsetHeight),window.innerHeight)}function Cc(m,q,v,a,G,c){m=document.createElement(m);var d;
m.setAttribute(q,v);m.setAttribute(a,G);q=function(){d||c();d=!0};c&&(m.onreadystatechange=q,m.onload=q);document.getElementsByTagName("head")[0].appendChild(m)}function Dc(m,q){Cc("script","type","text/javascript","src",m,q)}function Db(m,q){Cc("link","rel","stylesheet","href",m,q)}function Ec(){if(A){var m=document.getElementById("cly-loader");if(!m){var q=document.head||document.getElementsByTagName("head")[0],v=document.createElement("style");v.type="text/css";v.styleSheet?v.styleSheet.cssText=
"#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}":v.appendChild(document.createTextNode("#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}"));
q.appendChild(v);m=document.createElement("div");m.setAttribute("id","cly-loader");window.addEventListener("load",function(){if(t.showLoaderProtection)Ab()&&console.warn("[WARNING] [Countly] showLoader, Loader is already on");else try{document.body.appendChild(m)}catch(a){Ab()&&console.error("[ERROR] [Countly] showLoader, Body is not loaded for loader to append: "+a)}})}m.style.display="block"}}function Ab(){return t&&t.debug&&"undefined"!==typeof console?!0:!1}function Fc(){if(A){t.showLoaderProtection=
!0;var m=document.getElementById("cly-loader");m&&(m.style.display="none")}}function cd(m){var q=document.createElement("script"),v=document.createElement("script");q.async=!0;v.async=!0;q.src=t.customSourceBoomerang||Gc.BOOMERANG_SRC;v.src=t.customSourceCountlyBoomerang||Gc.CLY_BOOMERANG_SRC;document.getElementsByTagName("head")[0].appendChild(q);document.getElementsByTagName("head")[0].appendChild(v);var a=!1,G=!1;q.onload=function(){a=!0};v.onload=function(){G=!0};var c=0,d=setInterval(function(){c+=
50;if(a&&G||1500<=c){if(t.debug){var g="BoomerangJS loaded:["+a+"], countly_boomerang loaded:["+G+"].";a&&G?console.log("[DEBUG] "+g):console.warn("[WARNING] "+g+" Initializing without APM.")}t.init(m);clearInterval(d)}},50)}var Q={NPS:"[CLY]_nps",SURVEY:"[CLY]_survey",STAR_RATING:"[CLY]_star_rating",VIEW:"[CLY]_view",ORIENTATION:"[CLY]_orientation",ACTION:"[CLY]_action"},dd=Object.values(Q),f={ERROR:"[ERROR] ",WARNING:"[WARNING] ",INFO:"[INFO] ",DEBUG:"[DEBUG] ",VERBOSE:"[VERBOSE] "},Gc={BOOMERANG_SRC:"https://cdn.jsdelivr.net/npm/countly-sdk-web@latest/plugin/boomerang/boomerang.min.js",
CLY_BOOMERANG_SRC:"https://cdn.jsdelivr.net/npm/countly-sdk-web@latest/plugin/boomerang/countly_boomerang.js"},ca=Object.freeze({errorCount:"cly_hc_error_count",warningCount:"cly_hc_warning_count",statusCode:"cly_hc_status_code",errorMessage:"cly_hc_error_message"}),Hc=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?::([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?::([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,A="undefined"!==typeof window,t=globalThis.Countly||{},
zb=0,mb=new WeakMap,Ic=new WeakMap,Ya=new WeakMap,aa=new WeakMap,nb=new WeakMap,Ga=new WeakMap,Za=new WeakMap,M=new WeakMap,P=new WeakMap,S=new WeakMap,pa=new WeakMap,ea=new WeakMap,fa=new WeakMap,ob=new WeakMap,Ha=new WeakMap,ja=new WeakMap,pb=new WeakMap,U=new WeakMap,Ia=new WeakMap,Ja=new WeakMap,qb=new WeakMap,$a=new WeakMap,Ka=new WeakMap,ya=new WeakMap,ka=new WeakMap,La=new WeakMap,ab=new WeakMap,bb=new WeakMap,N=new WeakMap,ha=new WeakMap,qa=new WeakMap,Eb=new WeakMap,ra=new WeakMap,za=new WeakMap,
I=new WeakMap,Ma=new WeakMap,Na=new WeakMap,rb=new WeakMap,sa=new WeakMap,cb=new WeakMap,la=new WeakMap,ta=new WeakMap,ma=new WeakMap,sb=new WeakMap,K=new WeakMap,tb=new WeakMap,hc=new WeakMap,Oa=new WeakMap,db=new WeakMap,eb=new WeakMap,fb=new WeakMap,ua=new WeakMap,Fb=new WeakMap,Pa=new WeakMap,Aa=new WeakMap,Qa=new WeakMap,gb=new WeakMap,Gb=new WeakMap,hb=new WeakMap,ib=new WeakMap,ub=new WeakMap,vb=new WeakMap,Hb=new WeakMap,Ib=new WeakMap,jb=new WeakMap,Ra=new WeakMap,Jb=new WeakMap,J=new WeakMap,
H=new WeakMap,V=new WeakMap,Sa=new WeakMap,va=new WeakMap,wa=new WeakMap,Kb=new WeakMap,Lb=new WeakMap,Mb=new WeakMap,Nb=new WeakMap,Jc=new WeakMap,ic=new WeakMap,ba=new WeakMap,jc=new WeakMap,ia=new WeakMap,na=new WeakMap,kc=new WeakMap,lc=new WeakMap,Ob=new WeakMap,Pb=new WeakMap,mc=new WeakMap,Ba=new WeakMap,Kc=new WeakMap,Qb=new WeakMap,Lc=new WeakMap,nc=new WeakMap,Mc=new WeakMap,Nc=new WeakMap,Rb=new WeakMap,Ca=new WeakMap,Sb=new WeakMap,oc=new WeakMap,Tb=new WeakMap,Oc=new WeakMap,pc=new WeakMap,
Ta=new WeakMap,T=new WeakMap,wb=new WeakMap,Pc=new WeakMap,Da=new WeakMap,Ub=new WeakMap,Qc=new WeakMap,qc=new WeakMap,xb=new WeakMap,yb=new WeakMap,Vb=new WeakMap,e=new WeakMap,da=new WeakMap,rc=new WeakMap,sc=new WeakMap,Wb=new WeakMap,Xb=new WeakMap,tc=new WeakMap,Yb=new WeakMap,Rc=new WeakMap,uc=new WeakMap,Sc=new WeakMap,Tc=new WeakMap,Uc=new WeakMap,Vc=new WeakMap,vc=new WeakMap,B=new WeakMap,z=new WeakMap,W=new WeakMap,Wc=new WeakMap,Xc=new WeakMap,Yc=new WeakMap,Zc=new WeakMap,xa=new WeakMap,
ad=function(m,q,v){return Object.defineProperty(m,"prototype",{writable:!1}),m}(function v(q){var a=this;if(!(this instanceof v))throw new TypeError("Cannot call a class as a function");p(this,mb,void 0);p(this,Ic,void 0);p(this,Ya,void 0);p(this,aa,void 0);p(this,nb,void 0);p(this,Ga,void 0);p(this,Za,void 0);p(this,M,void 0);p(this,P,void 0);p(this,S,void 0);p(this,pa,void 0);p(this,ea,void 0);p(this,fa,void 0);p(this,ob,void 0);p(this,Ha,void 0);p(this,ja,void 0);p(this,pb,void 0);p(this,U,void 0);
p(this,Ia,void 0);p(this,Ja,void 0);p(this,qb,void 0);p(this,$a,void 0);p(this,Ka,void 0);p(this,ya,void 0);p(this,ka,void 0);p(this,La,void 0);p(this,ab,void 0);p(this,bb,void 0);p(this,N,void 0);p(this,ha,void 0);p(this,qa,void 0);p(this,Eb,void 0);p(this,ra,void 0);p(this,za,void 0);p(this,I,void 0);p(this,Ma,void 0);p(this,Na,void 0);p(this,rb,void 0);p(this,sa,void 0);p(this,cb,void 0);p(this,la,void 0);p(this,ta,void 0);p(this,ma,void 0);p(this,sb,void 0);p(this,K,void 0);p(this,tb,void 0);
p(this,hc,void 0);p(this,Oa,void 0);p(this,db,void 0);p(this,eb,void 0);p(this,fb,void 0);p(this,ua,void 0);p(this,Fb,void 0);p(this,Pa,void 0);p(this,Aa,void 0);p(this,Qa,void 0);p(this,gb,void 0);p(this,Gb,void 0);p(this,hb,void 0);p(this,ib,void 0);p(this,ub,void 0);p(this,vb,void 0);p(this,Hb,void 0);p(this,Ib,void 0);p(this,jb,void 0);p(this,Ra,void 0);p(this,Jb,void 0);p(this,J,void 0);p(this,H,void 0);p(this,V,void 0);p(this,Sa,void 0);p(this,va,void 0);p(this,wa,void 0);p(this,Kb,void 0);
p(this,Lb,void 0);p(this,Mb,function(){if("[CLY]_temp_id"===a.device_id)b(e,a).call(a,f.INFO,"server_config, Device ID is temporary, not fetching server config");else{b(e,a).call(a,f.INFO,"server_config, Fetching server config");var c={};c.app_key=a.app_key;c.device_id=a.device_id;c.sdk_version=b(ma,a);c.sdk_name=b(ta,a);c.t=b(I,a);c.timestamp=Wa();var d=new Date;c.hour=d.getHours();c.dow=d.getDay();c.av=a.app_version;c.method="sc";b(da,a).call(a,"server_config",a.url+b(Ga,a),c,function(g,h,n){if(!g)try{var l=
JSON.parse(n);b(e,a).call(a,f.INFO,"server_config, Config fetched successfully:["+JSON.stringify(l)+"]");l&&b(Nb,a).call(a,l);b(z,a).call(a,"cly_config",JSON.stringify(l))}catch(r){b(e,a).call(a,f.ERROR,"server_config, Had an issue while parsing the response: "+r)}},!0,!0);setTimeout(function(){b(Mb,a).call(a)},36E5*b(Gb,a))}});p(this,Nb,function(c){c&&c.c&&"object"===R(c.c)&&((c=c.c)&&c.hasOwnProperty("networking")&&k(Fb,a,c.networking),c&&c.hasOwnProperty("tracking")&&k(hb,a,c.tracking),c&&c.hasOwnProperty("rqs")&&
k(Pa,a,c.rqs),c&&c.hasOwnProperty("eqs")&&k(Aa,a,c.eqs),c&&c.hasOwnProperty("sui")&&k(Qa,a,c.sui),c&&c.hasOwnProperty("czi")&&14<c.czi&&k(gb,a,1E3*c.czi),c&&c.hasOwnProperty("ecz")&&(k(jb,a,c.ecz),!b(Kb,a)&&b(jb,a)&&b(Ba,a).call(a)),c&&c.hasOwnProperty("cr")&&k(Ra,a,c.cr),c&&c.hasOwnProperty("st")&&k(ib,a,c.st),c&&c.hasOwnProperty("crt")&&k(vb,a,c.crt),c&&c.hasOwnProperty("vt")&&k(ub,a,c.vt),c&&c.hasOwnProperty("cet")&&k(Hb,a,c.cet),c&&c.hasOwnProperty("lkl")&&k(J,a,c.lkl),c&&c.hasOwnProperty("lvs")&&
k(H,a,c.lvs),c&&c.hasOwnProperty("lsv")&&k(V,a,c.lsv),c&&c.hasOwnProperty("lbc")&&k(Sa,a,c.lbc),c&&c.hasOwnProperty("ltlpt")&&k(va,a,c.ltlpt),c&&c.hasOwnProperty("ltl")&&k(wa,a,c.ltl),c&&c.hasOwnProperty("scui")&&k(Gb,a,Math.max(c.scui,4)),c&&c.hasOwnProperty("lt")&&k(Ib,a,c.lt),c&&c.hasOwnProperty("rcz")&&k(Jb,a,c.rcz))});p(this,Jc,function(c){k(fa,a,x("ignore_referrers",c,[]));k($a,a,x("fail_timeout",c,60));k(Ka,a,x("inactivity_time",c,20));k(ka,a,x("use_session_cookie",c,!0));k(La,a,x("session_cookie_timeout",
c,30));k(N,a,x("offline_mode",c,!1));k(ta,a,x("sdk_name",c,"javascript_native_web"));k(ma,a,x("sdk_version",c,"25.4.0"));k(Za,a,x("interval",c,500));a.getViewName=x("getViewName",c,t.getViewName);a.getViewUrl=x("getViewUrl",c,t.getViewUrl);a.getSearchQuery=x("getSearchQuery",c,t.getSearchQuery);a.DeviceIdType=t.DeviceIdType;a.namespace=x("namespace",c,"");a.clearStoredId=x("clear_stored_id",c,!1);a.onload=x("onload",c,[]);a.utm=x("utm",c,{source:!0,medium:!0,campaign:!0,term:!0,content:!0});a.ignore_prefetch=
x("ignore_prefetch",c,!0);a.rcAutoOptinAb=x("rc_automatic_optin_for_ab",c,!0);a.useExplicitRcApi=x("use_explicit_rc_api",c,!1);a.debug=x("debug",c,!1);a.test_mode=x("test_mode",c,!1);a.test_mode_eq=x("test_mode_eq",c,!1);a.metrics=x("metrics",c,{});a.headers=x("headers",c,{});a.app_version=x("app_version",c,"0.0");a.country_code=x("country_code",c,null);a.city=x("city",c,null);a.ip_address=x("ip_address",c,null);a.ignore_bots=x("ignore_bots",c,!0);a.force_post=x("force_post",c,!1);a.remote_config=
x("remote_config",c,!1);a.ignore_visitor=x("ignore_visitor",c,!1);a.track_domains=A?x("track_domains",c,!0):void 0;a.storage=x("storage",c,"default");a.enableOrientationTracking=A?x("enable_orientation_tracking",c,!0):void 0;a.heatmapWhitelist=x("heatmap_whitelist",c,[]);a.contentWhitelist=x("content_whitelist",c,[]);a.salt=x("salt",c,null);a.hcErrorCount=b(B,a).call(a,ca.errorCount)||0;a.hcWarningCount=b(B,a).call(a,ca.warningCount)||0;a.hcStatusCode=b(B,a).call(a,ca.statusCode)||-1;a.hcErrorMessage=
b(B,a).call(a,ca.errorMessage)||"";k(fb,a,x("crash_filter_callback",c,null));"cookie"===a.storage&&k(ra,a,!1);a.rcAutoOptinAb||a.useExplicitRcApi||(b(e,a).call(a,f.WARNING,"initialize, Auto opting is disabled, switching to explicit RC API"),a.useExplicitRcApi=!0);Array.isArray(b(fa,a))||k(fa,a,[]);""===a.url&&(b(e,a).call(a,f.ERROR,"initialize, Please provide server URL"),a.ignore_visitor=!0);b(B,a).call(a,"cly_ignore")&&(a.ignore_visitor=!0);b(mc,a).call(a);if(A)if(window.name&&0===window.name.indexOf("cly:"))try{a.passed_data=
JSON.parse(window.name.replace("cly:",""))}catch(E){b(e,a).call(a,f.ERROR,"initialize, Could not parse name: "+window.name+", error: "+E)}else if(location.hash&&0===location.hash.indexOf("this.#cly:"))try{a.passed_data=JSON.parse(location.hash.replace("this.#cly:",""))}catch(E){b(e,a).call(a,f.ERROR,"initialize, Could not parse hash: "+location.hash+", error: "+E)}Array.isArray(a.contentWhitelist)&&(a.contentWhitelist.push(a.url),a.contentWhitelist=a.contentWhitelist.map(function(E){return Fa(E)}));
if((a.passed_data&&a.passed_data.app_key&&a.passed_data.app_key===a.app_key||a.passed_data&&!a.passed_data.app_key&&b(Ya,a))&&a.passed_data.token&&a.passed_data.purpose){a.passed_data.token!==b(B,a).call(a,"cly_old_token")&&(b(uc,a).call(a,a.passed_data.token),b(z,a).call(a,"cly_old_token",a.passed_data.token));var d=[];Array.isArray(a.heatmapWhitelist)?(a.heatmapWhitelist.push(a.url),d=a.heatmapWhitelist.map(function(E){return Fa(E)})):d=[a.url];d.includes(a.passed_data.url)&&"heatmap"===a.passed_data.purpose&&
(a.ignore_visitor=!0,Ec(),Dc(a.passed_data.url+"/views/heatmap.js",Fc))}if(a.ignore_visitor)b(e,a).call(a,f.WARNING,"initialize, ignore_visitor:["+a.ignore_visitor+"], this user will not be tracked");else{b(Wc,a).call(a);k(M,a,b(B,a).call(a,"cly_queue")||[]);k(P,a,b(B,a).call(a,"cly_event")||[]);k(S,a,b(B,a).call(a,"cly_remote_configs")||{});d="[CLY]_temp_id"===b(B,a).call(a,"cly_id");a.clearStoredId&&(b(B,a).call(a,"cly_id")&&!d&&(a.device_id=b(B,a).call(a,"cly_id"),b(e,a).call(a,f.DEBUG,"initialize, temporarily using the previous device ID to flush existing events"),
k(I,a,b(B,a).call(a,"cly_id_type")),b(I,a)||(b(e,a).call(a,f.DEBUG,"initialize, No device ID type info from the previous session, falling back to DEVELOPER_SUPPLIED, for event flushing"),k(I,a,0)),b(Ca,a).call(a),a.device_id=void 0,k(I,a,1)),b(e,a).call(a,f.INFO,"initialize, Clearing the device ID storage"),b(W,a).call(a,"cly_id"),b(W,a).call(a,"cly_id_type"),b(W,a).call(a,"cly_session"),d=!1);"javascript_native_web"===b(ta,a)&&"25.4.0"===b(ma,a)?b(e,a).call(a,f.DEBUG,"initialize, SDK name:["+b(ta,
a)+"], version:["+b(ma,a)+"]"):b(e,a).call(a,f.DEBUG,"initialize, SDK name:["+b(ta,a)+"], version:["+b(ma,a)+"], default name:[javascript_native_web] and default version:[25.4.0]");b(e,a).call(a,f.DEBUG,"initialize, stored server config:["+JSON.stringify(b(ua,a))+"]");b(e,a).call(a,f.DEBUG,"initialize, app_key:["+a.app_key+"], url:["+a.url+"]");b(e,a).call(a,f.DEBUG,"initialize, device_id:["+x("device_id",c,void 0)+"]");b(e,a).call(a,f.DEBUG,"initialize, require_consent is enabled:["+b(Ra,a)+"]");
try{b(e,a).call(a,f.DEBUG,"initialize, metric override:["+JSON.stringify(a.metrics)+"]"),b(e,a).call(a,f.DEBUG,"initialize, header override:["+JSON.stringify(a.headers)+"]"),b(e,a).call(a,f.DEBUG,"initialize, number of onload callbacks provided:["+a.onload.length+"]"),b(e,a).call(a,f.DEBUG,"initialize, utm tags:["+JSON.stringify(a.utm)+"]"),b(fa,a)&&b(e,a).call(a,f.DEBUG,"initialize, referrers to ignore :["+JSON.stringify(b(fa,a))+"]"),b(e,a).call(a,f.DEBUG,"initialize, salt given:["+!!a.salt+"]")}catch(E){b(e,
a).call(a,f.ERROR,"initialize, Could not stringify some config object values")}b(e,a).call(a,f.DEBUG,"initialize, app_version:["+a.app_version+"]");b(e,a).call(a,f.DEBUG,"initialize, provided location info; country_code:["+a.country_code+"], city:["+a.city+"], ip_address:["+a.ip_address+"]");""!==a.namespace&&b(e,a).call(a,f.DEBUG,"initialize, namespace given:["+a.namespace+"]");a.clearStoredId&&b(e,a).call(a,f.DEBUG,"initialize, clearStoredId flag set to:["+a.clearStoredId+"]");a.ignore_prefetch&&
b(e,a).call(a,f.DEBUG,"initialize, ignoring pre-fetching and pre-rendering from counting as real website visits :["+a.ignore_prefetch+"]");a.test_mode&&b(e,a).call(a,f.WARNING,"initialize, test_mode:["+a.test_mode+"], request queue won't be processed");a.test_mode_eq&&b(e,a).call(a,f.WARNING,"initialize, test_mode_eq:["+a.test_mode_eq+"], event queue won't be processed");a.heatmapWhitelist&&b(e,a).call(a,f.DEBUG,"initialize, heatmap whitelist:["+JSON.stringify(a.heatmapWhitelist)+"], these domains will be whitelisted");
"default"!==a.storage&&b(e,a).call(a,f.DEBUG,"initialize, storage is set to:["+a.storage+"]");a.ignore_bots&&b(e,a).call(a,f.DEBUG,"initialize, ignore traffic from bots :["+a.ignore_bots+"]");a.force_post&&b(e,a).call(a,f.DEBUG,"initialize, forced post method for all requests:["+a.force_post+"]");a.remote_config&&b(e,a).call(a,f.DEBUG,"initialize, remote_config callback provided:["+!!a.remote_config+"]");"boolean"===typeof a.rcAutoOptinAb&&b(e,a).call(a,f.DEBUG,"initialize, automatic RC optin is enabled:["+
a.rcAutoOptinAb+"]");a.useExplicitRcApi||b(e,a).call(a,f.WARNING,"initialize, will use legacy RC API. Consider enabling new API during init with use_explicit_rc_api flag");a.track_domains&&b(e,a).call(a,f.DEBUG,"initialize, tracking domain info:["+a.track_domains+"]");a.enableOrientationTracking&&b(e,a).call(a,f.DEBUG,"initialize, enableOrientationTracking:["+a.enableOrientationTracking+"]");b(ka,a)||b(e,a).call(a,f.WARNING,"initialize, use_session_cookie is enabled:["+b(ka,a)+"]");b(N,a)&&b(e,a).call(a,
f.DEBUG,"initialize, offline_mode:["+b(N,a)+"], user info won't be send to the servers");b(S,a)&&b(e,a).call(a,f.DEBUG,"initialize, stored remote configs:["+JSON.stringify(b(S,a))+"]");b(gb,a)&&b(e,a).call(a,f.DEBUG,"initialize, content_zone_timer_interval:["+b(gb,a)+"]");b(e,a).call(a,f.DEBUG,"initialize, 'getViewName' callback override provided:["+(a.getViewName!==t.getViewName)+"]");b(e,a).call(a,f.DEBUG,"initialize, 'getSearchQuery' callback override provided:["+(a.getSearchQuery!==t.getSearchQuery)+
"]");128!==b(J,a)&&b(e,a).call(a,f.DEBUG,"initialize, maxKeyLength set to:["+b(J,a)+"] characters");256!==b(H,a)&&b(e,a).call(a,f.DEBUG,"initialize, maxValueSize set to:["+b(H,a)+"] characters");100!==b(V,a)&&b(e,a).call(a,f.DEBUG,"initialize, maxSegmentationValues set to:["+b(V,a)+"] key/value pairs");100!==b(Sa,a)&&b(e,a).call(a,f.DEBUG,"initialize, maxBreadcrumbCount for custom logs set to:["+b(Sa,a)+"] entries");30!==b(va,a)&&b(e,a).call(a,f.DEBUG,"initialize, maxStackTraceLinesPerThread set to:["+
b(va,a)+"] lines");200!==b(wa,a)&&b(e,a).call(a,f.DEBUG,"initialize, maxStackTraceLineLength set to:["+b(wa,a)+"] characters");500!==b(Za,a)&&b(e,a).call(a,f.DEBUG,"initialize, interval for heartbeats set to:["+b(Za,a)+"] milliseconds");1E3!==b(Pa,a)&&b(e,a).call(a,f.DEBUG,"initialize, queue_size set to:["+b(Pa,a)+"] items max");60!==b($a,a)&&b(e,a).call(a,f.DEBUG,"initialize, fail_timeout set to:["+b($a,a)+"] seconds of wait time after a failed connection to server");20!==b(Ka,a)&&b(e,a).call(a,
f.DEBUG,"initialize, inactivity_time set to:["+b(Ka,a)+"] minutes to consider a user as inactive after no observable action");60!==b(Qa,a)&&b(e,a).call(a,f.DEBUG,"initialize, session_update set to:["+b(Qa,a)+"] seconds to check if extending a session is needed while the user is active");100!==b(Aa,a)&&b(e,a).call(a,f.DEBUG,"initialize, max_events set to:["+b(Aa,a)+"] events to send in one batch");30!==b(La,a)&&b(e,a).call(a,f.DEBUG,"initialize, session_cookie_timeout set to:["+b(La,a)+"] minutes to expire a cookies session");
var g=null,h=a.getSearchQuery(),n=!1,l={};if(h){0===h.indexOf("?")&&(h=h.substring(1));h=h.split("&");for(var r=0;r<h.length;r++){var u=h[r].split("=");"cly_id"===u[0]?b(z,a).call(a,"cly_cmp_id",u[1]):"cly_uid"===u[0]?b(z,a).call(a,"cly_cmp_uid",u[1]):"cly_device_id"===u[0]?g=u[1]:0===(u[0]+"").indexOf("utm_")&&a.utm[u[0].replace("utm_","")]&&(l[u[0].replace("utm_","")]=u[1],n=!0)}}h=x("device_id",c,void 0);"number"===typeof h&&(h=h.toString());b(B,a).call(a,"cly_id")&&!d?(a.device_id=b(B,a).call(a,
"cly_id"),b(e,a).call(a,f.INFO,"initialize, Set the stored device ID"),k(I,a,b(B,a).call(a,"cly_id_type")),b(I,a)||(b(e,a).call(a,f.INFO,"initialize, No device ID type info from the previous session, falling back to DEVELOPER_SUPPLIED"),k(I,a,0)),k(N,a,!1)):null!==g?(b(e,a).call(a,f.INFO,"initialize, Device ID set by URL"),a.device_id=g,k(I,a,3),k(N,a,!1)):h?(b(e,a).call(a,f.INFO,"initialize, Device ID set by developer"),a.device_id=h,c&&Object.keys(c).length?void 0!==c.device_id&&k(I,a,0):void 0!==
t.device_id&&k(I,a,0),k(N,a,!1)):b(N,a)||d?(a.device_id="[CLY]_temp_id",k(I,a,2),b(N,a)&&d?b(e,a).call(a,f.INFO,"initialize, Temp ID set, continuing offline mode from previous app session"):b(N,a)&&!d?b(e,a).call(a,f.INFO,"initialize, Temp ID set, entering offline mode"):(k(N,a,!0),b(e,a).call(a,f.INFO,"initialize, Temp ID set, enabling offline mode"))):(b(e,a).call(a,f.INFO,"initialize, Generating the device ID"),a.device_id=x("device_id",c,b(Ub,a).call(a)),c&&Object.keys(c).length?void 0!==c.device_id&&
k(I,a,0):void 0!==t.device_id&&k(I,a,0));b(z,a).call(a,"cly_id",a.device_id);b(z,a).call(a,"cly_id_type",b(I,a));if(n){k(la,a,{});for(var y in a.utm)l[y]?(a.userData.set("utm_"+y,l[y]),b(la,a)[y]=l[y]):a.userData.unset("utm_"+y);a.userData.save()}b(Mb,a).call(a)}});p(this,ic,function(){b(mb,a)&&(clearTimeout(b(mb,a)),k(mb,a,null));k(mb,a,setTimeout(function(){for(var c={},d=0;d<t.features.length;d++)!0===b(K,a)[t.features[d]].optin?c[t.features[d]]=!0:c[t.features[d]]=!1;b(T,a).call(a,{consent:JSON.stringify(c)});
b(e,a).call(a,f.DEBUG,"Consent update request has been sent to the queue.")},1E3))});w(this,"halt",function(){b(e,a).call(a,f.WARNING,"halt, Resetting Countly");t.i=void 0;t.q=[];t.noHeartBeat=void 0;k(Ya,a,!t.i);k(aa,a,!1);k(nb,a,"/i");k(Ga,a,"/o/sdk");k(Za,a,500);k(Pa,a,1E3);k(M,a,[]);k(P,a,[]);k(S,a,{});k(pa,a,[]);k(ea,a,{});k(fa,a,[]);k(ob,a,null);k(Ha,a,!0);k(pb,a,0);k(U,a,null);k(Ia,a,0);k(Ja,a,0);k(qb,a,0);k($a,a,60);k(Ka,a,20);k(ya,a,0);k(Qa,a,60);k(Aa,a,100);k(ka,a,!0);k(La,a,30);k(ab,a,
!0);k(bb,a,!1);k(N,a,!1);k(ha,a,{});k(qa,a,!0);k(Eb,a,O());k(ra,a,!0);k(za,a,null);k(I,a,1);k(Ma,a,!1);k(Na,a,0);k(rb,a,!1);k(sa,a,null);k(cb,a,null);k(la,a,null);k(tb,a,[]);try{localStorage.setItem("cly_testLocal",!0),localStorage.removeItem("cly_testLocal"),localStorage.removeItem("cly_old_token"),localStorage.removeItem("cly_cmp_id"),localStorage.removeItem("cly_cmp_uid"),localStorage.removeItem("cly_id"),localStorage.removeItem("cly_id_type"),localStorage.removeItem("cly_queue"),localStorage.removeItem("cly_session"),
localStorage.removeItem("cly_remote_configs"),localStorage.removeItem("cly_event"),localStorage.removeItem("cly_ignore"),localStorage.removeItem("cly_fb_widgets"),localStorage.removeItem("cly_token"),localStorage.removeItem("cly_hc_error_count"),localStorage.removeItem("cly_hc_warning_count"),localStorage.removeItem("cly_hc_status_code"),localStorage.removeItem("cly_hc_error_message")}catch(d){b(e,a).call(a,f.ERROR,"halt, Local storage test failed, will fallback to cookies"),k(ra,a,!1)}t.features=
"sessions events views scrolls clicks forms crashes attribution users star-rating location apm feedback remote-config".split(" ");k(K,a,{});for(var c=0;c<t.features.length;c++)b(K,a)[t.features[c]]={};a.app_key=void 0;a.device_id=void 0;a.onload=void 0;a.utm=void 0;a.ignore_prefetch=void 0;a.debug=void 0;a.test_mode=void 0;a.test_mode_eq=void 0;a.metrics=void 0;a.headers=void 0;a.url=void 0;a.app_version=void 0;a.country_code=void 0;a.city=void 0;a.ip_address=void 0;a.ignore_bots=void 0;a.force_post=
void 0;a.rcAutoOptinAb=void 0;a.useExplicitRcApi=void 0;a.remote_config=void 0;a.ignore_visitor=void 0;k(Ra,a,void 0);a.track_domains=void 0;a.storage=void 0;a.enableOrientationTracking=void 0;a.salt=void 0;k(J,a,void 0);k(H,a,void 0);k(V,a,void 0);k(Sa,a,void 0);k(va,a,void 0);k(wa,a,void 0)});w(this,"group_features",function(c){b(e,a).call(a,f.INFO,"group_features, Grouping features");if(c)for(var d in c)b(K,a)[d]?b(e,a).call(a,f.WARNING,"group_features, Feature name ["+d+"] is already reserved"):
"string"===typeof c[d]?b(K,a)[d]={features:[c[d]]}:c[d]&&Array.isArray(c[d])&&c[d].length?b(K,a)[d]={features:c[d]}:b(e,a).call(a,f.ERROR,"group_features, Incorrect feature list for ["+d+"] value: ["+c[d]+"]");else b(e,a).call(a,f.ERROR,"group_features, Incorrect features:["+c+"]")});w(this,"check_consent",function(c){b(e,a).call(a,f.INFO,"check_consent, Checking if consent is given for specific feature:["+c+"]");if(!b(Ra,a))return b(e,a).call(a,f.INFO,"check_consent, require_consent is off, no consent is necessary"),
!0;if(b(K,a)[c])return!(!b(K,a)[c]||!b(K,a)[c].optin);b(e,a).call(a,f.ERROR,"check_consent, No feature available for ["+c+"]");return!1});w(this,"get_device_id_type",function(){b(e,a).call(a,f.INFO,"check_device_id_type, Retrieving the current device id type.["+b(I,a)+"]");switch(b(I,a)){case 1:var c=a.DeviceIdType.SDK_GENERATED;break;case 3:case 0:c=a.DeviceIdType.DEVELOPER_SUPPLIED;break;case 2:c=a.DeviceIdType.TEMPORARY_ID;break;default:c=-1}return c});w(this,"get_device_id",function(){b(e,a).call(a,
f.INFO,"get_device_id, Retrieving the device id: ["+a.device_id+"]");return a.device_id});w(this,"check_any_consent",function(){b(e,a).call(a,f.INFO,"check_any_consent, Checking if any consent is given");if(!b(Ra,a))return b(e,a).call(a,f.INFO,"check_any_consent, require_consent is off, no consent is necessary"),!0;for(var c in b(K,a))if(b(K,a)[c]&&b(K,a)[c].optin)return!0;b(e,a).call(a,f.INFO,"check_any_consent, No consents given");return!1});w(this,"add_consent",function(c){b(e,a).call(a,f.INFO,
"add_consent, Adding consent for ["+c+"]");if(Array.isArray(c))for(var d=0;d<c.length;d++)a.add_consent(c[d]);else b(K,a)[c]?b(K,a)[c].features?(b(K,a)[c].optin=!0,a.add_consent(b(K,a)[c].features)):!0!==b(K,a)[c].optin&&(b(K,a)[c].optin=!0,b(ic,a).call(a),setTimeout(function(){"sessions"===c&&b(ha,a).begin_session?(a.begin_session.apply(a,b(ha,a).begin_session),b(ha,a).begin_session=null):"views"===c&&b(ha,a).track_pageview&&(k(U,a,null),a.track_pageview.apply(a,b(ha,a).track_pageview),b(ha,a).track_pageview=
null)},1)):b(e,a).call(a,f.ERROR,"add_consent, No feature available for ["+c+"]")});w(this,"remove_consent",function(c){b(e,a).call(a,f.INFO,"remove_consent, Removing consent for ["+c+"]");a.remove_consent_internal(c,!0)});w(this,"remove_consent_internal",function(c,d){d=d||!1;if(Array.isArray(c))for(var g=0;g<c.length;g++)a.remove_consent_internal(c[g],d);else b(K,a)[c]?b(K,a)[c].features?a.remove_consent_internal(b(K,a)[c].features,d):(b(K,a)[c].optin=!1,d&&!1!==b(K,a)[c].optin&&b(ic,a).call(a)):
b(e,a).call(a,f.WARNING,"remove_consent, No feature available for ["+c+"]")});w(this,"enable_offline_mode",function(){b(N,a)?b(e,a).call(a,f.WARNING,"enable_offline_mode, Countly is already in offline mode."):(b(e,a).call(a,f.INFO,"enable_offline_mode, Enabling offline mode"),a.remove_consent_internal(t.features,!1),k(N,a,!0),b(Qb,a).call(a),a.device_id="[CLY]_temp_id",k(I,a,2))});w(this,"disable_offline_mode",function(c){if(b(N,a)){b(e,a).call(a,f.INFO,"disable_offline_mode, Disabling offline mode");
k(N,a,!1);c&&a.device_id!==c?(a.device_id=c,k(I,a,0),b(z,a).call(a,"cly_id",a.device_id),b(z,a).call(a,"cly_id_type",0),b(e,a).call(a,f.INFO,"disable_offline_mode, Changing id to: "+a.device_id)):(a.device_id=b(Ub,a).call(a),"[CLY]_temp_id"===a.device_id&&(a.device_id=ac()),a.device_id!==b(B,a).call(a,"cly_id")&&(b(z,a).call(a,"cly_id",a.device_id),b(z,a).call(a,"cly_id_type",1)));c=!1;if(0<b(M,a).length)for(var d=0;d<b(M,a).length;d++)"[CLY]_temp_id"===b(M,a)[d].device_id&&(b(M,a)[d].device_id=a.device_id,
b(M,a)[d].t=b(I,a),c=!0);c&&b(z,a).call(a,"cly_queue",b(M,a),!0);b(sb,a)&&(b(xa,a).sendInstantHCRequest(),k(sb,a,!1));b(Mb,a).call(a);b(jb,a)&&(b(Ba,a).call(a),k(Kb,a,!0))}else b(e,a).call(a,f.WARNING,"disable_offline_mode, Countly was not in offline mode.")});w(this,"begin_session",function(c,d){if(b(ib,a))if(b(e,a).call(a,f.INFO,"begin_session, Starting the session. There was an ongoing session: ["+b(aa,a)+"]"),c&&b(e,a).call(a,f.INFO,"begin_session, Heartbeats are disabled"),d&&b(e,a).call(a,f.INFO,
"begin_session, Session starts irrespective of session cookie"),a.check_consent("sessions")){if(!b(aa,a)){if(a.enableOrientationTracking){b(jc,a).call(a);var g;D(window,"resize",function(){clearTimeout(g);g=setTimeout(function(){b(jc,a).call(a)},200)})}k(ja,a,O());k(aa,a,!0);k(Ha,a,!c);c=b(B,a).call(a,"cly_session");b(e,a).call(a,f.VERBOSE,"begin_session, Session state, forced: ["+d+"], useSessionCookie: ["+b(ka,a)+"], seconds to expire: ["+(c-b(ja,a))+"], expired: ["+(parseInt(c)<=O())+"] ");if(d||
!b(ka,a)||!c||parseInt(c)<=O())b(e,a).call(a,f.INFO,"begin_session, Session started"),null===b(za,a)&&k(za,a,!0),d={begin_session:1},d.metrics=JSON.stringify(b(xb,a).call(a)),b(T,a).call(a,d);b(z,a).call(a,"cly_session",O()+60*b(La,a))}}else b(ha,a).begin_session=[c,d];else b(e,a).call(a,f.INFO,"begin_session, Session tracking is disabled by server config")});w(this,"session_duration",function(c){b(ib,a)?(b(e,a).call(a,f.INFO,"session_duration, Reporting session duration: ["+c+"]"),a.check_consent("sessions")&&
(b(aa,a)?(b(e,a).call(a,f.INFO,"session_duration, Session extended: ["+c+"]"),b(T,a).call(a,{session_duration:c}),b(pc,a).call(a)):b(e,a).call(a,f.DEBUG,"session_duration, No session was started"))):b(e,a).call(a,f.INFO,"session_duration, Session tracking is disabled by server config")});w(this,"end_session",function(c,d){b(ib,a)||d?(b(e,a).call(a,f.INFO,"end_session, Ending the current session. There was an on going session:["+b(aa,a)+"]"),a.check_consent("sessions")&&b(aa,a)&&(c=c||O()-b(ja,a),
b(Tb,a).call(a),!b(ka,a)||d?(b(e,a).call(a,f.INFO,"end_session, Session ended"),b(T,a).call(a,{end_session:1,session_duration:c})):a.session_duration(c),k(aa,a,!1))):b(e,a).call(a,f.INFO,"end_session, Session tracking is disabled by server config")});w(this,"set_id",function(c){b(e,a).call(a,f.INFO,"set_id, Changing the device ID to:["+c+"]");null==c||""===c?b(e,a).call(a,f.WARNING,"set_id, The provided device is not a valid ID"):0===b(I,a)?a.change_id(c,!1):a.change_id(c,!0)});w(this,"change_id",
function(c,d){b(e,a).call(a,f.INFO,"change_id, Changing the device ID to: ["+c+"] with merge:["+d+"]");if(c&&"string"===typeof c&&0!==c.length)if(b(N,a))b(e,a).call(a,f.WARNING,"change_id, Offline mode was on, initiating disabling sequence instead."),a.disable_offline_mode(c);else if(a.device_id==c)b(e,a).call(a,f.DEBUG,"change_id, Provided device ID is equal to the current device ID. Aborting.");else{d||(b(Da,a).call(a),b(Ca,a).call(a),a.end_session(null,!0),k(ea,a,{}),a.remove_consent_internal(t.features,
!1));var g=a.device_id;a.device_id=c;a.device_id=a.device_id;k(I,a,0);b(z,a).call(a,"cly_id",a.device_id);b(z,a).call(a,"cly_id_type",0);b(e,a).call(a,f.INFO,"change_id, Changing ID from:["+g+"] to ["+c+"]");d?b(T,a).call(a,{old_device_id:g}):a.begin_session(!b(Ha,a),!0);a.remote_config&&(k(S,a,{}),b(z,a).call(a,"cly_remote_configs",b(S,a)),a.fetch_remote_config(a.remote_config))}else b(e,a).call(a,f.WARNING,"change_id, The provided device ID is not a valid ID")});w(this,"add_event",function(c){b(e,
a).call(a,f.INFO,"add_event, Adding event: ",c);switch(c.key){case Q.NPS:var d=a.check_consent("feedback");break;case Q.SURVEY:d=a.check_consent("feedback");break;case Q.STAR_RATING:d=a.check_consent("star-rating");break;case Q.VIEW:d=a.check_consent("views");break;case Q.ORIENTATION:d=a.check_consent("users");break;case Q.ACTION:d=a.check_consent("clicks")||a.check_consent("scrolls");break;default:d=b(Hb,a)?a.check_consent("events"):!1}d&&b(ba,a).call(a,c)});p(this,ba,function(c,d){if(a.ignore_visitor||
!b(hb,a))b(e,a).call(a,f.WARNING,"Not adding the event. Tracking is disabled by the server config:["+!b(hb,a)+"] or ignore_visitor is:["+a.ignore_visitor+"]");else if(c.key){c.count||(c.count=1);dd.includes(c.key)||(c.key=C(c.key,b(J,a),"add_cly_event",b(e,a)));c.segmentation=oa(c.segmentation,b(J,a),b(H,a),b(V,a),"add_cly_event",b(e,a));c=lb(c,["key","count","sum","dur","segmentation"]);c.timestamp=Wa();var g=new Date;c.hour=g.getHours();c.dow=g.getDay();c.id=d||$b();c.key===Q.VIEW?c.pvid=b(cb,a)||
"":c.cvid=b(sa,a)||"";b(P,a).push(c);b(z,a).call(a,"cly_event",b(P,a));b(e,a).call(a,f.INFO,"With event ID: ["+c.id+"], successfully adding the last event:",c)}else b(e,a).call(a,f.ERROR,"Adding event failed. Event must have a key property")});w(this,"start_event",function(c){c&&"string"===typeof c?(b(e,a).call(a,f.INFO,"start_event, Starting timed event with key: ["+c+"]"),c=C(c,b(J,a),"start_event",b(e,a)),b(ea,a)[c]?b(e,a).call(a,f.WARNING,"start_event, Timed event with key: ["+c+"] already started"):
b(ea,a)[c]=O()):b(e,a).call(a,f.WARNING,"start_event, you have to provide a valid string key instead of: ["+c+"]")});w(this,"cancel_event",function(c){if(!c||"string"!==typeof c)return b(e,a).call(a,f.WARNING,"cancel_event, you have to provide a valid string key instead of: ["+c+"]"),!1;b(e,a).call(a,f.INFO,"cancel_event, Canceling timed event with key: ["+c+"]");c=C(c,b(J,a),"cancel_event",b(e,a));if(b(ea,a)[c])return delete b(ea,a)[c],b(e,a).call(a,f.INFO,"cancel_event, Timed event with key: ["+
c+"] is canceled"),!0;b(e,a).call(a,f.WARNING,"cancel_event, Timed event with key: ["+c+"] was not found");return!1});w(this,"end_event",function(c){c?(b(e,a).call(a,f.INFO,"end_event, Ending timed event"),"string"===typeof c&&(c=C(c,b(J,a),"end_event",b(e,a)),c={key:c}),c.key?b(ea,a)[c.key]?(c.dur=O()-b(ea,a)[c.key],a.add_event(c),delete b(ea,a)[c.key]):b(e,a).call(a,f.ERROR,"end_event, Timed event with key: ["+c.key+"] was not started"):b(e,a).call(a,f.ERROR,"end_event, Timed event must have a key property")):
b(e,a).call(a,f.WARNING,"end_event, you have to provide a valid string key or event object instead of: ["+c+"]")});p(this,jc,function(c){b(e,a).call(a,f.INFO,"report_orientation, Reporting orientation");a.check_consent("users")&&b(ba,a).call(a,{key:Q.ORIENTATION,segmentation:{mode:c||(window.innerWidth>window.innerHeight?"landscape":"portrait")}})});w(this,"report_conversion",function(c,d){b(e,a).call(a,f.WARNING,"report_conversion, Deprecated function call! Use 'recordDirectAttribution' in place of this call. Call will be redirected now!");
a.recordDirectAttribution(c,d)});w(this,"recordDirectAttribution",function(c,d){b(e,a).call(a,f.INFO,"recordDirectAttribution, Recording the attribution for campaign ID: ["+c+"] and the user ID: ["+d+"]");a.check_consent("attribution")&&(c=c||b(B,a).call(a,"cly_cmp_id")||"cly_organic",(d=d||b(B,a).call(a,"cly_cmp_uid"))?b(T,a).call(a,{campaign_id:c,campaign_user:d}):b(T,a).call(a,{campaign_id:c}))});w(this,"user_details",function(c){b(e,a).call(a,f.INFO,"user_details, Trying to add user details: ",
c);a.check_consent("users")&&(b(Da,a).call(a),b(Ca,a).call(a),b(e,a).call(a,f.INFO,"user_details, flushed the event queue"),c.name=C(c.name,b(H,a),"user_details",b(e,a)),c.username=C(c.username,b(H,a),"user_details",b(e,a)),c.email=C(c.email,b(H,a),"user_details",b(e,a)),c.organization=C(c.organization,b(H,a),"user_details",b(e,a)),c.phone=C(c.phone,b(H,a),"user_details",b(e,a)),c.picture=C(c.picture,4096,"user_details",b(e,a)),c.gender=C(c.gender,b(H,a),"user_details",b(e,a)),c.byear=C(c.byear,b(H,
a),"user_details",b(e,a)),c.custom=oa(c.custom,b(J,a),b(H,a),b(V,a),"user_details",b(e,a)),b(T,a).call(a,{user_details:JSON.stringify(lb(c,"name username email organization phone picture gender byear custom".split(" ")))}))});p(this,ia,{});p(this,na,function(c,d,g){a.check_consent("users")&&(b(ia,a)[c]||(b(ia,a)[c]={}),"$push"===g||"$pull"===g||"$addToSet"===g?(b(ia,a)[c][g]||(b(ia,a)[c][g]=[]),b(ia,a)[c][g].push(d)):b(ia,a)[c][g]=d)});w(this,"userData",{set:function(c,d){b(e,a).call(a,f.INFO,"[userData] set, Setting user's custom property value: ["+
d+"] under the key: ["+c+"]");c=C(c,b(J,a),"userData set",b(e,a));d=C(d,b(H,a),"userData set",b(e,a));b(ia,a)[c]=d},unset:function(c){b(e,a).call(a,f.INFO,"[userData] unset, Resetting user's custom property with key: ["+c+"] ");b(ia,a)[c]=""},set_once:function(c,d){b(e,a).call(a,f.INFO,"[userData] set_once, Setting user's unique custom property value: ["+d+"] under the key: ["+c+"] ");c=C(c,b(J,a),"userData set_once",b(e,a));d=C(d,b(H,a),"userData set_once",b(e,a));b(na,a).call(a,c,d,"$setOnce")},
increment:function(c){b(e,a).call(a,f.INFO,"[userData] increment, Increasing user's custom property value under the key: ["+c+"] by one");c=C(c,b(J,a),"userData increment",b(e,a));b(na,a).call(a,c,1,"$inc")},increment_by:function(c,d){b(e,a).call(a,f.INFO,"[userData] increment_by, Increasing user's custom property value under the key: ["+c+"] by: ["+d+"]");c=C(c,b(J,a),"userData increment_by",b(e,a));d=C(d,b(H,a),"userData increment_by",b(e,a));b(na,a).call(a,c,d,"$inc")},multiply:function(c,d){b(e,
a).call(a,f.INFO,"[userData] multiply, Multiplying user's custom property value under the key: ["+c+"] by: ["+d+"]");c=C(c,b(J,a),"userData multiply",b(e,a));d=C(d,b(H,a),"userData multiply",b(e,a));b(na,a).call(a,c,d,"$mul")},max:function(c,d){b(e,a).call(a,f.INFO,"[userData] max, Saving user's maximum custom property value compared to the value: ["+d+"] under the key: ["+c+"]");c=C(c,b(J,a),"userData max",b(e,a));d=C(d,b(H,a),"userData max",b(e,a));b(na,a).call(a,c,d,"$max")},min:function(c,d){b(e,
a).call(a,f.INFO,"[userData] min, Saving user's minimum custom property value compared to the value: ["+d+"] under the key: ["+c+"]");c=C(c,b(J,a),"userData min",b(e,a));d=C(d,b(H,a),"userData min",b(e,a));b(na,a).call(a,c,d,"$min")},push:function(c,d){b(e,a).call(a,f.INFO,"[userData] push, Pushing a value: ["+d+"] under the key: ["+c+"] to user's custom property array");c=C(c,b(J,a),"userData push",b(e,a));d=C(d,b(H,a),"userData push",b(e,a));b(na,a).call(a,c,d,"$push")},push_unique:function(c,d){b(e,
a).call(a,f.INFO,"[userData] push_unique, Pushing a unique value: ["+d+"] under the key: ["+c+"] to user's custom property array");c=C(c,b(J,a),"userData push_unique",b(e,a));d=C(d,b(H,a),"userData push_unique",b(e,a));b(na,a).call(a,c,d,"$addToSet")},pull:function(c,d){b(e,a).call(a,f.INFO,"[userData] pull, Removing the value: ["+d+"] under the key: ["+c+"] from user's custom property array");b(na,a).call(a,c,d,"$pull")},save:function(){b(e,a).call(a,f.INFO,"[userData] save, Saving changes to user's custom property");
a.check_consent("users")&&(b(Da,a).call(a),b(Ca,a).call(a),b(e,a).call(a,f.INFO,"user_details, flushed the event queue"),b(T,a).call(a,{user_details:JSON.stringify({custom:b(ia,a)})}));k(ia,a,{})}});w(this,"report_trace",function(c){b(e,a).call(a,f.INFO,"report_trace, Reporting performance trace");if(a.check_consent("apm")){for(var d="type name stz etz apm_metrics apm_attr".split(" "),g=0;g<d.length;g++)if("apm_attr"!==d[g]&&"undefined"===typeof c[d[g]]){b(e,a).call(a,f.WARNING,"report_trace, APM trace don't have the property: "+
d[g]);return}c.name=C(c.name,b(J,a),"report_trace",b(e,a));c.app_metrics=oa(c.app_metrics,b(J,a),b(H,a),b(V,a),"report_trace",b(e,a));d=lb(c,d);d.timestamp=c.stz;c=new Date;d.hour=c.getHours();d.dow=c.getDay();b(T,a).call(a,{apm:JSON.stringify(d)});b(e,a).call(a,f.INFO,"report_trace, Successfully adding APM trace: ",d)}});w(this,"track_errors",function(c){A?b(vb,a)?(b(e,a).call(a,f.INFO,"track_errors, Started tracking errors"),t.i[a.app_key].tracking_crashes=!0,window.cly_crashes||(window.cly_crashes=
!0,k(ob,a,c),window.addEventListener("error",function(d){if(d.error)bc(d.error,!1);else{var g=d.filename||"",h=d.lineno||0,n=d.colno||0;d=(d.message||"Unknown error")+"\n";g&&(d+="at "+g);h&&(d+=":"+h);n&&(d+=":"+n);d+="\n";bc(d+"",!1)}}),window.addEventListener("unhandledrejection",function(d){bc(Error("Unhandled rejection (reason: "+(d.reason&&d.reason.stack?d.reason.stack:d.reason)+")."),!0)}))):b(e,a).call(a,f.WARNING,"track_errors, Crash tracking is disabled by the server config. Not tracking errors."):
b(e,a).call(a,f.WARNING,"track_errors, window object is not available. Not tracking errors.")});w(this,"log_error",function(c,d){b(e,a).call(a,f.INFO,"log_error, Logging errors");a.recordError(c,!0,d)});w(this,"add_log",function(c){b(e,a).call(a,f.INFO,"add_log, Adding a new log of breadcrumbs: [ "+c+" ]");if(a.check_consent("crashes")){for(c=C(c,b(H,a),"add_log",b(e,a));b(pa,a).length>=b(Sa,a);)b(pa,a).shift(),b(e,a).call(a,f.WARNING,"add_log, Reached maximum crashLogs size. Will erase the oldest one.");
b(pa,a).push(c)}});w(this,"fetch_remote_config",function(c,d,g){var h=null,n=null,l=null;c&&(g||"function"!==typeof c?Array.isArray(c)&&(h=c):l=c);d&&(g||"function"!==typeof d?Array.isArray(d)&&(n=d):l=d);l||"function"!==typeof g||(l=g);a.useExplicitRcApi?(b(e,a).call(a,f.INFO,"fetch_remote_config, Fetching remote config"),c=a.rcAutoOptinAb?1:0,b(kc,a).call(a,h,n,c,null,l)):(b(e,a).call(a,f.WARNING,"fetch_remote_config, Fetching remote config, with legacy API"),b(kc,a).call(a,h,n,null,"legacy",l))});
p(this,kc,function(c,d,g,h,n){b(e,a).call(a,f.INFO,"fetch_remote_config_explicit, Fetching sequence initiated");var l={method:"rc",av:a.app_version};c&&(l.keys=JSON.stringify(c));d&&(l.omit_keys=JSON.stringify(d));var r;"legacy"===h&&(l.method="fetch_remote_config");0===g&&(l.oi=0);1===g&&(l.oi=1);"function"===typeof n&&(r=n);a.check_consent("sessions")&&(l.metrics=JSON.stringify(b(xb,a).call(a)));a.check_consent("remote-config")?(b(Ta,a).call(a,l),b(da,a).call(a,"fetch_remote_config_explicit",a.url+
b(Ga,a),l,function(u,y,E){if(!u){try{var X=JSON.parse(E);if(l.keys||l.omit_keys)for(var L in X)b(S,a)[L]=X[L];else k(S,a,X);b(z,a).call(a,"cly_remote_configs",b(S,a))}catch(kb){b(e,a).call(a,f.ERROR,"fetch_remote_config_explicit, Had an issue while parsing the response: "+kb)}r&&(b(e,a).call(a,f.INFO,"fetch_remote_config_explicit, Callback function is provided"),r(u,b(S,a)))}},!0)):(b(e,a).call(a,f.ERROR,"fetch_remote_config_explicit, Remote config requires explicit consent"),r&&r(Error("Remote config requires explicit consent"),
b(S,a)))});w(this,"enrollUserToAb",function(c){b(e,a).call(a,f.INFO,"enrollUserToAb, Providing AB test keys to opt in for");c&&Array.isArray(c)&&0!==c.length?(c={method:"ab",keys:JSON.stringify(c),av:a.app_version},b(Ta,a).call(a,c),b(da,a).call(a,"enrollUserToAb",a.url+b(Ga,a),c,function(d,g,h){if(!d)try{var n=JSON.parse(h);b(e,a).call(a,f.DEBUG,"enrollUserToAb, Parsed the response's result: ["+n.result+"]")}catch(l){b(e,a).call(a,f.ERROR,"enrollUserToAb, Had an issue while parsing the response: "+
l)}},!0)):b(e,a).call(a,f.ERROR,"enrollUserToAb, No keys provided")});w(this,"get_remote_config",function(c){b(e,a).call(a,f.INFO,"get_remote_config, Getting remote config from storage");return"undefined"!==typeof c?b(S,a)[c]:b(S,a)});p(this,lc,function(){b(e,a).call(a,f.INFO,"stop_time, Stopping tracking duration");b(qa,a)&&(k(qa,a,!1),k(pb,a,O()-b(ja,a)),k(Ja,a,O()-b(Ia,a)))});p(this,Ob,function(){b(e,a).call(a,f.INFO,"start_time, Starting tracking duration");b(qa,a)||(k(qa,a,!0),k(ja,a,O()-b(pb,
a)),k(Ia,a,O()-b(Ja,a)),k(Ja,a,0),b(pc,a).call(a))});w(this,"track_sessions",function(){if(A){b(e,a).call(a,f.INFO,"track_session, Starting tracking user session");a.begin_session();b(Ob,a).call(a);D(window,"beforeunload",function(){b(Da,a).call(a);b(Ca,a).call(a);a.end_session()});var c="hidden",d=function(){document[c]||!document.hasFocus()?b(lc,a).call(a):b(Ob,a).call(a)};D(window,"focus",d);D(window,"blur",d);D(window,"pageshow",d);D(window,"pagehide",d);"onfocusin"in document&&(D(window,"focusin",
d),D(window,"focusout",d));c in document?document.addEventListener("visibilitychange",d):"mozHidden"in document?(c="mozHidden",document.addEventListener("mozvisibilitychange",d)):"webkitHidden"in document?(c="webkitHidden",document.addEventListener("webkitvisibilitychange",d)):"msHidden"in document&&(c="msHidden",document.addEventListener("msvisibilitychange",d));d=function(){b(ya,a)>=b(Ka,a)&&b(Ob,a).call(a);k(ya,a,0)};D(window,"mousemove",d);D(window,"click",d);D(window,"keydown",d);D(window,"scroll",
d);setInterval(function(){var g;k(ya,a,(g=b(ya,a),g++,g));b(ya,a)>=b(Ka,a)&&b(lc,a).call(a)},6E4)}else b(e,a).call(a,f.WARNING,"track_sessions, window object is not available. Not tracking sessions.")});w(this,"track_pageview",function(c,d,g){if(A||c)if(b(ub,a))if(b(e,a).call(a,f.INFO,"track_pageview, Tracking page views"),b(e,a).call(a,f.VERBOSE,"track_pageview, last view is:["+b(U,a)+"], current view ID is:["+b(sa,a)+"], previous view ID is:["+b(cb,a)+"]"),b(U,a)&&b(rb,a)&&(b(e,a).call(a,f.DEBUG,
"track_pageview, Scroll registry triggered"),b(Yb,a).call(a),k(Ma,a,!0),k(Na,a,0)),b(Tb,a).call(a),k(cb,a,b(sa,a)),k(sa,a,$b()),(c=C(c,b(J,a),"track_pageview",b(e,a)))&&Array.isArray(c)&&(d=c,c=null),c||(c=a.getViewName()),void 0===c||""===c)b(e,a).call(a,f.ERROR,"track_pageview, No page name to track (it is either undefined or empty string). No page view can be tracked.");else if(null===c)b(e,a).call(a,f.ERROR,"track_pageview, View name returned as null. Page view will be ignored.");else{if(d&&d.length)for(var h=
0;h<d.length;h++)try{if((new RegExp(d[h])).test(c)){b(e,a).call(a,f.INFO,"track_pageview, Ignoring the page: "+c);return}}catch(u){b(e,a).call(a,f.ERROR,"track_pageview, Problem with finding ignore list item: "+d[h]+", error: "+u)}h={name:c,visit:1,view:a.getViewUrl()};h=oa(h,b(J,a),b(H,a),b(V,a),"track_pageview",b(e,a));a.track_domains&&(h.domain=window.location.hostname);if(b(ka,a))if(b(aa,a))b(za,a)&&(k(za,a,!1),h.start=1);else{var n=b(B,a).call(a,"cly_session");if(!n||parseInt(n)<=O())k(za,a,
!1),h.start=1}else A&&"undefined"!==typeof document.referrer&&document.referrer.length&&(n=Hc.exec(document.referrer))&&n[11]&&n[11]!==window.location.hostname&&(h.start=1);if(b(la,a)&&Object.keys(b(la,a)).length){b(e,a).call(a,f.INFO,"track_pageview, Adding fresh utm tags to segmentation:["+JSON.stringify(b(la,a))+"]");for(var l in b(la,a))"undefined"===typeof h["utm_"+l]&&(h["utm_"+l]=b(la,a)[l])}A&&b(Vb,a).call(a)&&(b(e,a).call(a,f.INFO,"track_pageview, Adding referrer to segmentation:["+document.referrer+
"]"),h.referrer=document.referrer);if(g){g=oa(g,b(J,a),b(H,a),b(V,a),"track_pageview",b(e,a));for(var r in g)"undefined"===typeof h[r]&&(h[r]=g[r])}a.check_consent("views")?(b(ba,a).call(a,{key:Q.VIEW,segmentation:h},b(sa,a)),k(U,a,c),k(Ia,a,O()),b(e,a).call(a,f.VERBOSE,"track_pageview, last view is assigned:["+b(U,a)+"]")):b(ha,a).track_pageview=[c,d,g]}else b(e,a).call(a,f.WARNING,"track_pageview, View tracking is disabled by the server config. Not tracking page views.");else b(e,a).call(a,f.WARNING,
"track_pageview, window object is not available. Not tracking page views as page name is not provided.")});w(this,"track_view",function(c,d,g){b(e,a).call(a,f.INFO,"track_view, Initiating tracking page views");a.track_pageview(c,d,g)});w(this,"track_clicks",function(c){if(A){b(e,a).call(a,f.INFO,"track_clicks, Starting to track clicks");c&&b(e,a).call(a,f.INFO,"track_clicks, Tracking the specified children:["+c+"]");c=c||document;var d=!0;D(c,"click",function(g){if(d){d=!1;fc(g);if("undefined"!==
typeof g.pageX&&"undefined"!==typeof g.pageY){var h=Cb(),n=gc();a.check_consent("clicks")&&(g={type:"click",x:g.pageX,y:g.pageY,width:n,height:h,view:a.getViewUrl()},g=oa(g,b(J,a),b(H,a),b(V,a),"processClick",b(e,a)),a.track_domains&&(g.domain=window.location.hostname),b(ba,a).call(a,{key:Q.ACTION,segmentation:g}))}setTimeout(function(){d=!0},1E3)}})}else b(e,a).call(a,f.WARNING,"track_clicks, window object is not available. Not tracking clicks.")});w(this,"track_scrolls",function(c){A?(b(e,a).call(a,
f.INFO,"track_scrolls, Starting to track scrolls"),c&&b(e,a).call(a,f.INFO,"track_scrolls, Tracking the specified children"),c=c||window,k(Ma,a,!0),k(rb,a,!0),D(c,"scroll",b(tc,a)),D(c,"beforeunload",b(Yb,a))):b(e,a).call(a,f.WARNING,"track_scrolls, window object is not available. Not tracking scrolls.")});w(this,"track_links",function(c){A?(b(e,a).call(a,f.INFO,"track_links, Starting to track clicks to links"),c&&b(e,a).call(a,f.INFO,"track_links, Tracking the specified children"),c=c||document,
D(c,"click",function(d){a:{var g=Bb(d);var h;for(h="A";g;){if(g.nodeName.toUpperCase()===h)break a;g=g.parentElement}g=void 0}g&&(fc(d),a.check_consent("clicks")&&b(ba,a).call(a,{key:"linkClick",segmentation:{href:g.href,text:g.innerText,id:g.id,view:a.getViewUrl()}}))})):b(e,a).call(a,f.WARNING,"track_links, window object is not available. Not tracking links.")});w(this,"track_forms",function(c,d){if(A){b(e,a).call(a,f.INFO,"track_forms, Starting to track form submissions. DOM object provided:["+
!!c+"] Tracking hidden inputs :["+!!d+"]");c=c||document;var g=function(h){return h.name||h.id||h.type||h.nodeName};D(c,"submit",function(h){h=Bb(h);var n={id:h.attributes.id&&h.attributes.id.nodeValue,name:h.attributes.name&&h.attributes.name.nodeValue,action:h.attributes.action&&h.attributes.action.nodeValue,method:h.attributes.method&&h.attributes.method.nodeValue,view:a.getViewUrl()},l;if("undefined"!==typeof h.elements){for(var r=0;r<h.elements.length;r++)(l=h.elements[r])&&"password"!==l.type&&
-1===l.className.indexOf("cly_user_ignore")&&("undefined"===typeof n["input:"+g(l)]&&(n["input:"+g(l)]=[]),"select"===l.nodeName.toLowerCase()?"undefined"!==typeof l.multiple?n["input:"+g(l)].push(xc(l)):n["input:"+g(l)].push(l.options[l.selectedIndex].value):"input"===l.nodeName.toLowerCase()?"undefined"!==typeof l.type?"checkbox"===l.type.toLowerCase()||"radio"===l.type.toLowerCase()?l.checked&&n["input:"+g(l)].push(l.value):("hidden"!==l.type.toLowerCase()||d)&&n["input:"+g(l)].push(l.value):n["input:"+
g(l)].push(l.value):"textarea"===l.nodeName.toLowerCase()?n["input:"+g(l)].push(l.value):"undefined"!==typeof l.value&&n["input:"+g(l)].push(l.value));for(var u in n)n[u]&&"function"===typeof n[u].join&&(n[u]=n[u].join(", "))}a.check_consent("forms")&&b(ba,a).call(a,{key:"formSubmit",segmentation:n})})}else b(e,a).call(a,f.WARNING,"track_forms, window object is not available. Not tracking forms.")});w(this,"collect_from_forms",function(c,d){A?(b(e,a).call(a,f.INFO,"collect_from_forms, Starting to collect possible user data. DOM object provided:["+
!!c+"] Submitting custom user property:["+!!d+"]"),c=c||document,D(c,"submit",function(g){g=Bb(g);var h={},n=!1,l;if("undefined"!==typeof g.elements){var r={},u=c.getElementsByTagName("LABEL"),y;for(y=0;y<u.length;y++)u[y].htmlFor&&""!==u[y].htmlFor&&(r[u[y].htmlFor]=u[y].innerText||u[y].textContent||u[y].innerHTML);for(y=0;y<g.elements.length;y++)if((l=g.elements[y])&&"password"!==l.type&&-1===l.className.indexOf("cly_user_ignore"))if(u="","select"===l.nodeName.toLowerCase()?u="undefined"!==typeof l.multiple?
xc(l):l.options[l.selectedIndex].value:"input"===l.nodeName.toLowerCase()?"undefined"!==typeof l.type?"checkbox"===l.type.toLowerCase()||"radio"===l.type.toLowerCase()?l.checked&&(u=l.value):u=l.value:u=l.value:"textarea"===l.nodeName.toLowerCase()?u=l.value:"undefined"!==typeof l.value&&(u=l.value),l.className&&-1!==l.className.indexOf("cly_user_")){var E=l.className.split(" ");for(l=0;l<E.length;l++)if(0===E[l].indexOf("cly_user_")){h[E[l].replace("cly_user_","")]=u;n=!0;break}}else if(l.type&&
"email"===l.type.toLowerCase()||l.name&&-1!==l.name.toLowerCase().indexOf("email")||l.id&&-1!==l.id.toLowerCase().indexOf("email")||l.id&&r[l.id]&&-1!==r[l.id].toLowerCase().indexOf("email")||/[^@\s]+@[^@\s]+\.[^@\s]+/.test(u))h.email||(h.email=u),n=!0;else if(l.name&&-1!==l.name.toLowerCase().indexOf("username")||l.id&&-1!==l.id.toLowerCase().indexOf("username")||l.id&&r[l.id]&&-1!==r[l.id].toLowerCase().indexOf("username"))h.username||(h.username=u),n=!0;else if(l.name&&(-1!==l.name.toLowerCase().indexOf("tel")||
-1!==l.name.toLowerCase().indexOf("phone")||-1!==l.name.toLowerCase().indexOf("number"))||l.id&&(-1!==l.id.toLowerCase().indexOf("tel")||-1!==l.id.toLowerCase().indexOf("phone")||-1!==l.id.toLowerCase().indexOf("number"))||l.id&&r[l.id]&&(-1!==r[l.id].toLowerCase().indexOf("tel")||-1!==r[l.id].toLowerCase().indexOf("phone")||-1!==r[l.id].toLowerCase().indexOf("number")))h.phone||(h.phone=u),n=!0;else if(l.name&&(-1!==l.name.toLowerCase().indexOf("org")||-1!==l.name.toLowerCase().indexOf("company"))||
l.id&&(-1!==l.id.toLowerCase().indexOf("org")||-1!==l.id.toLowerCase().indexOf("company"))||l.id&&r[l.id]&&(-1!==r[l.id].toLowerCase().indexOf("org")||-1!==r[l.id].toLowerCase().indexOf("company")))h.organization||(h.organization=u),n=!0;else if(l.name&&-1!==l.name.toLowerCase().indexOf("name")||l.id&&-1!==l.id.toLowerCase().indexOf("name")||l.id&&r[l.id]&&-1!==r[l.id].toLowerCase().indexOf("name"))h.name||(h.name=""),h.name+=u+" ",n=!0}n&&(b(e,a).call(a,f.INFO,"collect_from_forms, Gathered user data",
h),d?a.user_details({custom:h}):a.user_details(h))})):b(e,a).call(a,f.WARNING,"collect_from_forms, window object is not available. Not collecting from forms.")});w(this,"collect_from_facebook",function(c){A?"undefined"!==typeof FB&&FB&&FB.api?(b(e,a).call(a,f.INFO,"collect_from_facebook, Starting to collect possible user data"),FB.api("/me",function(d){var g={};d.name&&(g.name=d.name);d.email&&(g.email=d.email);"male"===d.gender?g.gender="M":"female"===d.gender&&(g.gender="F");if(d.birthday){var h=
d.birthday.split("/").pop();h&&4===h.length&&(g.byear=h)}d.work&&d.work[0]&&d.work[0].employer&&d.work[0].employer.name&&(g.organization=d.work[0].employer.name);if(c){g.custom={};for(var n in c){h=c[n].split(".");for(var l=d,r=0;r<h.length&&(l=l[h[r]],"undefined"!==typeof l);r++);"undefined"!==typeof l&&(g.custom[n]=l)}}a.user_details(g)})):b(e,a).call(a,f.ERROR,"collect_from_facebook, Facebook SDK is not available"):b(e,a).call(a,f.WARNING,"collect_from_facebook, window object is not available. Not collecting from Facebook.")});
w(this,"opt_out",function(){b(e,a).call(a,f.WARNING,"opt_out, Opting out the user. Deprecated function call! Use 'consent' in place of this call.");a.ignore_visitor=!0;b(z,a).call(a,"cly_ignore",!0)});w(this,"opt_in",function(){b(e,a).call(a,f.WARNING,"opt_in, Opting in the user. Deprecated function call! Use 'consent' in place of this call.");b(z,a).call(a,"cly_ignore",!1);a.ignore_visitor=!1;b(mc,a).call(a);a.ignore_visitor||b(bb,a)||b(wb,a).call(a)});w(this,"report_feedback",function(c){b(e,a).call(a,
f.WARNING,"report_feedback, Deprecated function call! Use 'recordRatingWidgetWithID' or 'reportFeedbackWidgetManually' in place of this call. Call will be redirected to 'recordRatingWidgetWithID' now!");a.recordRatingWidgetWithID(c)});w(this,"recordRatingWidgetWithID",function(c){b(e,a).call(a,f.INFO,"recordRatingWidgetWithID, Providing information about user with ID: [ "+c.widget_id+" ]");if(a.check_consent("star-rating"))if(c.widget_id)if(c.rating){var d={key:Q.STAR_RATING,count:1,segmentation:{}};
d.segmentation=lb(c,"widget_id contactMe platform app_version rating email comment".split(" "));d.segmentation.app_version||(d.segmentation.app_version=a.metrics._app_version||a.app_version);5<d.segmentation.rating?(b(e,a).call(a,f.WARNING,"recordRatingWidgetWithID, You have entered a rating higher than 5. Changing it back to 5 now."),d.segmentation.rating=5):1>d.segmentation.rating&&(b(e,a).call(a,f.WARNING,"recordRatingWidgetWithID, You have entered a rating lower than 1. Changing it back to 1 now."),
d.segmentation.rating=1);b(e,a).call(a,f.INFO,"recordRatingWidgetWithID, Reporting Rating Widget: ",d);b(ba,a).call(a,d)}else b(e,a).call(a,f.ERROR,"recordRatingWidgetWithID, Rating Widget must contain rating property");else b(e,a).call(a,f.ERROR,"recordRatingWidgetWithID, Rating Widget must contain widget_id property")});w(this,"reportFeedbackWidgetManually",function(c,d,g){if(a.check_consent("feedback"))if(c&&d)if(c._id)if(b(N,a))b(e,a).call(a,f.ERROR,"reportFeedbackWidgetManually, Feedback Widgets can not be reported in offline mode");
else{b(e,a).call(a,f.INFO,"reportFeedbackWidgetManually, Providing information about user with, provided result of the widget with  ID: [ "+c._id+" ] and type: ["+c.type+"]");var h=[];d=c.type;if("nps"===d){if(g){if(!g.rating){b(e,a).call(a,f.ERROR,"reportFeedbackWidgetManually, Widget must contain rating property");return}g.rating=Math.round(g.rating);10<g.rating?(b(e,a).call(a,f.WARNING,"reportFeedbackWidgetManually, You have entered a rating higher than 10. Changing it back to 10 now."),g.rating=
10):0>g.rating&&(b(e,a).call(a,f.WARNING,"reportFeedbackWidgetManually, You have entered a rating lower than 0. Changing it back to 0 now."),g.rating=0);h=["rating","comment"]}var n=Q.NPS}else if("survey"===d){if(g){if(1>Object.keys(g).length){b(e,a).call(a,f.ERROR,"reportFeedbackWidgetManually, Widget should have answers to be reported");return}h=Object.keys(g)}n=Q.SURVEY}else if("rating"===d){if(g){if(!g.rating){b(e,a).call(a,f.ERROR,"reportFeedbackWidgetManually, Widget must contain rating property");
return}g.rating=Math.round(g.rating);5<g.rating?(b(e,a).call(a,f.WARNING,"reportFeedbackWidgetManually, You have entered a rating higher than 5. Changing it back to 5 now."),g.rating=5):1>g.rating&&(b(e,a).call(a,f.WARNING,"reportFeedbackWidgetManually, You have entered a rating lower than 1. Changing it back to 1 now."),g.rating=1);h=["rating","comment","email","contactMe"]}n=Q.STAR_RATING}else{b(e,a).call(a,f.ERROR,"reportFeedbackWidgetManually, Widget has an unacceptable type");return}c={key:n,
count:1,segmentation:{widget_id:c._id,platform:a.platform,app_version:a.metrics._app_version||a.app_version}};if(null===g)c.segmentation.closed=1;else{n=c.segmentation;if(h){for(var l,r=0,u=h.length;r<u;r++)l=h[r],"undefined"!==typeof g[l]&&(n[l]=g[l]);g=n}else g=void 0;c.segmentation=g}b(e,a).call(a,f.INFO,"reportFeedbackWidgetManually, Reporting "+d+": ",c);b(ba,a).call(a,c)}else b(e,a).call(a,f.ERROR,"reportFeedbackWidgetManually, Feedback Widgets must contain _id property");else b(e,a).call(a,
f.ERROR,"reportFeedbackWidgetManually, Widget data and/or Widget object not provided. Aborting.")});w(this,"show_feedback_popup",function(c){A?(b(e,a).call(a,f.WARNING,"show_feedback_popup, Deprecated function call! Use 'presentRatingWidgetWithID' in place of this call. Call will be redirected now!"),presentRatingWidgetWithID(c)):b(e,a).call(a,f.WARNING,"show_feedback_popup, window object is not available. Not showing feedback popup.")});w(this,"presentRatingWidgetWithID",function(c){A?(b(e,a).call(a,
f.INFO,"presentRatingWidgetWithID, Showing rating widget popup for the widget with ID: [ "+c+" ]"),a.check_consent("star-rating")&&(b(N,a)?b(e,a).call(a,f.ERROR,"presentRatingWidgetWithID, Cannot show ratingWidget popup in offline mode"):b(da,a).call(a,"presentRatingWidgetWithID,",a.url+"/o/feedback/widget",{widget_id:c,av:a.app_version},function(d,g,h){if(!d)try{var n=JSON.parse(h);b(Sb,a).call(a,n,!1)}catch(l){b(e,a).call(a,f.ERROR,"presentRatingWidgetWithID, JSON parse failed: "+l)}},!0))):b(e,
a).call(a,f.WARNING,"presentRatingWidgetWithID, window object is not available. Not showing rating widget popup.")});w(this,"initialize_feedback_popups",function(c){A?(b(e,a).call(a,f.WARNING,"initialize_feedback_popups, Deprecated function call! Use 'initializeRatingWidgets' in place of this call. Call will be redirected now!"),a.initializeRatingWidgets(c)):b(e,a).call(a,f.WARNING,"initialize_feedback_popups, window object is not available. Not initializing feedback popups.")});w(this,"initializeRatingWidgets",
function(c){if(A){if(b(e,a).call(a,f.INFO,"initializeRatingWidgets, Initializing rating widget with provided widget IDs:[ "+c+"]"),a.check_consent("star-rating")){c||(c=b(B,a).call(a,"cly_fb_widgets"));for(var d=document.getElementsByClassName("countly-feedback-sticker");0<d.length;)d[0].remove();b(da,a).call(a,"initializeRatingWidgets,",a.url+"/o/feedback/multiple-widgets-by-id",{widgets:JSON.stringify(c),av:a.app_version},function(g,h,n){if(!g)try{var l=JSON.parse(n);for(g=0;g<l.length;g++)if("true"===
l[g].is_active){var r=l[g].target_devices,u=ec();if(r[u])if("string"===typeof l[g].hide_sticker&&(l[g].hide_sticker="true"===l[g].hide_sticker),"all"!==l[g].target_page||l[g].hide_sticker){var y=l[g].target_pages;for(h=0;h<y.length;h++){var E=y[h].substr(0,y[h].length-1)===window.location.pathname.substr(0,y[h].length-1),X=y[h]===window.location.pathname;(y[h].includes("*")&&E||X)&&!l[g].hide_sticker&&b(Sb,a).call(a,l[g],!0)}}else b(Sb,a).call(a,l[g],!0)}}catch(L){b(e,a).call(a,f.ERROR,"initializeRatingWidgets, JSON parse error: "+
L)}},!0)}}else b(e,a).call(a,f.WARNING,"initializeRatingWidgets, window object is not available. Not initializing rating widgets.")});w(this,"enable_feedback",function(c){A?(b(e,a).call(a,f.WARNING,"enable_feedback, Deprecated function call! Use 'enableRatingWidgets' in place of this call. Call will be redirected now!"),a.enableRatingWidgets(c)):b(e,a).call(a,f.WARNING,"enable_feedback, window object is not available. Not enabling feedback.")});w(this,"enableRatingWidgets",function(c){A?(b(e,a).call(a,
f.INFO,"enableRatingWidgets, Enabling rating widget with params:",c),a.check_consent("star-rating")&&(b(N,a)?b(e,a).call(a,f.ERROR,"enableRatingWidgets, Cannot enable rating widgets in offline mode"):(b(z,a).call(a,"cly_fb_widgets",c.popups||c.widgets),Db(a.url+"/star-rating/stylesheets/countly-feedback-web.css"),c=c.popups||c.widgets,0<c.length?(document.body.insertAdjacentHTML("beforeend",'<div id="cfbg"></div>'),a.initializeRatingWidgets(c)):b(e,a).call(a,f.ERROR,"enableRatingWidgets, You should provide at least one widget id as param. Read documentation for more detail. https://resources.count.ly/plugins/feedback")))):
b(e,a).call(a,f.WARNING,"enableRatingWidgets, window object is not available. Not enabling rating widgets.")});p(this,Pb,function(c,d){b(e,a).call(a,f.INFO,"showWidget, Showing ".concat(c," widget, nameIDorTag:[").concat(d,"]"));a.get_available_feedback_widgets(function(g,h){h?b(e,a).call(a,f.ERROR,"showWidget, Error while getting feedback widgets list: ".concat(h)):(h=g.find(function(n){return n.type===c}),d&&"string"===typeof d&&(g=g.find(function(n){return n.type===c&&(n.name===d||n._id===d||n.tg.includes(d))}))&&
(h=g,b(e,a).call(a,f.VERBOSE,"showWidget, Found ".concat(c," widget by name, id, or tag: [").concat(JSON.stringify(g),"]"))),h?a.present_feedback_widget(h,null,null,null):b(e,a).call(a,f.ERROR,"showWidget, No ".concat(c," widget found.")))})});w(this,"feedback",{showNPS:function(c){return b(Pb,a).call(a,"nps",c)},showSurvey:function(c){return b(Pb,a).call(a,"survey",c)},showRating:function(c){return b(Pb,a).call(a,"rating",c)}});w(this,"get_available_feedback_widgets",function(c){b(e,a).call(a,f.INFO,
"get_available_feedback_widgets, Getting the feedback list, callback function is provided:["+!!c+"]");if(a.check_consent("feedback"))if(b(N,a))b(e,a).call(a,f.ERROR,"get_available_feedback_widgets, Cannot enable feedback widgets in offline mode.");else{var d=a.url+b(Ga,a),g={method:"feedback",device_id:a.device_id,app_key:a.app_key,av:a.app_version};b(da,a).call(a,"get_available_feedback_widgets,",d,g,function(h,n,l){if(h)c&&c(null,h);else try{var r=JSON.parse(l).result||[];c&&c(r,null)}catch(u){b(e,
a).call(a,f.ERROR,"get_available_feedback_widgets, Error while parsing feedback widgets list: "+u),c&&c(null,u)}},!1)}else c&&c(null,Error("Consent for feedback not provided."))});w(this,"getFeedbackWidgetData",function(c,d){if(c.type)if(b(e,a).call(a,f.INFO,"getFeedbackWidgetData, Retrieving data for: ["+JSON.stringify(c)+"], callback function is provided:["+!!d+"]"),a.check_consent("feedback"))if(b(N,a))b(e,a).call(a,f.ERROR,"getFeedbackWidgetData, Cannot enable feedback widgets in offline mode.");
else{var g=a.url,h={widget_id:c._id,shown:1,sdk_version:b(ma,a),sdk_name:b(ta,a),platform:a.platform,app_version:a.app_version};if("nps"===c.type)g+="/o/surveys/nps/widget";else if("survey"===c.type)g+="/o/surveys/survey/widget";else if("rating"===c.type)g+="/o/surveys/rating/widget";else{b(e,a).call(a,f.ERROR,"getFeedbackWidgetData, Unknown type info: ["+c.type+"]");return}b(da,a).call(a,"getFeedbackWidgetData,",g,h,n,!0);var n=function(l,r,u){if(l)d&&d(null,l);else try{var y=JSON.parse(u);d&&d(y,
null)}catch(E){b(e,a).call(a,f.ERROR,"getFeedbackWidgetData, Error while parsing feedback widgets list: "+E),d&&d(null,E)}}}else d&&d(null,Error("Consent for feedback not provided."));else b(e,a).call(a,f.ERROR,"getFeedbackWidgetData, Expected the provided widget object to have a type but got: ["+JSON.stringify(c)+"], aborting.")});w(this,"present_feedback_widget",function(c,d,g,h){if(A){if(b(e,a).call(a,f.INFO,"present_feedback_widget, Presenting the feedback widget by appending to the element with ID: [ "+
d+" ] and className: [ "+g+" ]"),a.check_consent("feedback"))if(!c||"object"!==R(c)||Array.isArray(c))b(e,a).call(a,f.ERROR,"present_feedback_widget, Please provide at least one feedback widget object.");else{b(e,a).call(a,f.INFO,"present_feedback_widget, Adding segmentation to feedback widgets:["+JSON.stringify(h)+"]");h&&"object"===R(h)&&0!==Object.keys(h).length||(b(e,a).call(a,f.DEBUG,"present_feedback_widget, Segmentation is not an object or empty"),h=null);try{var n=a.url;if("nps"===c.type)b(e,
a).call(a,f.DEBUG,"present_feedback_widget, Widget type: nps."),n+="/feedback/nps";else if("survey"===c.type)b(e,a).call(a,f.DEBUG,"present_feedback_widget, Widget type: survey."),n+="/feedback/survey";else if("rating"===c.type)b(e,a).call(a,f.DEBUG,"present_feedback_widget, Widget type: rating."),n+="/feedback/rating";else{b(e,a).call(a,f.ERROR,"present_feedback_widget, Feedback widget only accepts nps, rating and survey types.");return}var l=window.origin||window.location.origin;if("rating"===c.type){b(e,
a).call(a,f.DEBUG,"present_feedback_widget, Loading css for rating widget.");var r="ratings";Db(a.url+"/star-rating/stylesheets/countly-feedback-web.css")}else b(e,a).call(a,f.DEBUG,"present_feedback_widget, Loading css for survey or nps."),Db(a.url+"/surveys/stylesheets/countly-surveys.css"),r="surveys";n+="?widget_id="+c._id;n+="&app_key="+a.app_key;n+="&device_id="+a.device_id;n+="&sdk_name="+b(ta,a);n+="&platform="+a.platform;n+="&app_version="+a.app_version;n+="&sdk_version="+b(ma,a);var u={tc:1};
h&&(u.sg=h);n+="&custom="+JSON.stringify(u);n+="&origin="+l;n+="&widget_v=web";var y=document.createElement("iframe");y.src=n;y.name="countly-"+r+"-iframe";y.id="countly-"+r+"-iframe";var E=!1;y.onload=function(){E&&(document.getElementById("countly-"+r+"-wrapper-"+c._id).style.display="none",document.getElementById("csbg").style.display="none");E=!0;b(e,a).call(a,f.DEBUG,"present_feedback_widget, Loaded iframe.")};for(var X=document.getElementById("csbg");X;)X.remove(),X=document.getElementById("csbg"),
b(e,a).call(a,f.DEBUG,"present_feedback_widget, Removing past overlay.");var L=document.getElementsByClassName("countly-"+r+"-wrapper");for(h=0;h<L.length;h++)L[h].remove(),b(e,a).call(a,f.DEBUG,"present_feedback_widget, Removed a wrapper.");L=document.createElement("div");h="countly-"+r+"-wrapper";L.className=h+" "+h+"--"+c.type;L.id="countly-"+r+"-wrapper-"+c._id;"survey"===c.type&&(L.className=L.className+" "+c.appearance.position);var kb=document.body;h=!1;d&&(document.getElementById(d)?(kb=document.getElementById(d),
h=!0):b(e,a).call(a,f.ERROR,"present_feedback_widget, Provided ID not found."));h||g&&(document.getElementsByClassName(g)[0]?kb=document.getElementsByClassName(g)[0]:b(e,a).call(a,f.ERROR,"present_feedback_widget, Provided class not found."));kb.insertAdjacentHTML("beforeend",'<div id="csbg"></div>');kb.appendChild(L);if("rating"===c.type){var wc=document.createElement("div");wc.className="countly-ratings-overlay";wc.id="countly-ratings-overlay-"+c._id;L.appendChild(wc);b(e,a).call(a,f.DEBUG,"present_feedback_widget, appended the rating overlay to wrapper");
D(document.getElementById("countly-ratings-overlay-"+c._id),"click",function(){document.getElementById("countly-ratings-wrapper-"+c._id).style.display="none"})}L.appendChild(y);b(e,a).call(a,f.DEBUG,"present_feedback_widget, Appended the iframe");D(window,"message",function(F){var Y={};try{Y=JSON.parse(F.data)}catch(ed){b(e,a).call(a,f.ERROR,"present_feedback_widget, Error while parsing message body "+ed)}!0===Y.close&&(b(e,a).call(a,f.DEBUG,"present_feedback_widget, Received message from widget with origin: ["+
F.origin+"] and data: ["+F.data+"]"),document.getElementById("countly-"+r+"-wrapper-"+c._id).style.display="none",document.getElementById("csbg").style.display="none",b(e,a).call(a,f.DEBUG,"present_feedback_widget, Closed the widget"))});var Ua=function(F){document.getElementById("countly-surveys-wrapper-"+F._id).style.display="block";document.getElementById("csbg").style.display="block"},$c=function(F){for(var Y=document.getElementsByClassName("countly-feedback-sticker");0<Y.length;)b(e,a).call(a,
f.VERBOSE,"present_feedback_widget, Removing old stickers"),Y[0].remove();F.appearance.hideS||(b(e,a).call(a,f.DEBUG,"present_feedback_widget, handling the sticker as it was not set to hidden"),Y=document.createElement("div"),Y.innerText=F.appearance.text,Y.style.color=7>F.appearance.text_color.length?"#"+F.appearance.text_color:F.appearance.text_color,Y.style.backgroundColor=7>F.appearance.bg_color.length?"#"+F.appearance.bg_color:F.appearance.bg_color,Y.className="countly-feedback-sticker  "+F.appearance.position+
"-"+F.appearance.size,Y.id="countly-feedback-sticker-"+F._id,document.body.appendChild(Y),D(document.getElementById("countly-feedback-sticker-"+F._id),"click",function(){document.getElementById("countly-ratings-wrapper-"+F._id).style.display="flex";document.getElementById("csbg").style.display="block"}));D(document.getElementById("countly-feedback-close-icon-"+F._id),"click",function(){document.getElementById("countly-ratings-wrapper-"+F._id).style.display="none";document.getElementById("csbg").style.display=
"none"})};if("survey"===c.type){var Z=!1;switch(c.showPolicy){case "afterPageLoad":"complete"===document.readyState?Z||(Z=!0,Ua(c)):D(document,"readystatechange",function(F){"complete"!==F.target.readyState||Z||(Z=!0,Ua(c))});break;case "afterConstantDelay":setTimeout(function(){Z||(Z=!0,Ua(c))},1E4);break;case "onAbandon":"complete"===document.readyState?D(document,"mouseleave",function(){Z||(Z=!0,Ua(c))}):D(document,"readystatechange",function(F){"complete"===F.target.readyState&&D(document,"mouseleave",
function(){Z||(Z=!0,Ua(c))})});break;case "onScrollHalfwayDown":D(window,"scroll",function(){if(!Z){var F=Math.max(window.scrollY,document.body.scrollTop,document.documentElement.scrollTop),Y=Cb();F>=Y/2&&(Z=!0,Ua(c))}});break;default:Z||(Z=!0,Ua(c))}}else if("nps"===c.type)document.getElementById("countly-"+r+"-wrapper-"+c._id).style.display="block",document.getElementById("csbg").style.display="block";else if("rating"===c.type){var Zb=!1;"complete"===document.readyState?Zb||(Zb=!0,$c(c)):D(document,
"readystatechange",function(F){"complete"!==F.target.readyState||Zb||(Zb=!0,$c(c))})}}catch(F){b(e,a).call(a,f.ERROR,"present_feedback_widget, Something went wrong while presenting the widget: "+F)}}}else b(e,a).call(a,f.WARNING,"present_feedback_widget, window object is not available. Not presenting feedback widget.")});w(this,"recordError",function(c,d,g){if(b(vb,a)){if(b(e,a).call(a,f.INFO,"recordError, Recording error"),a.check_consent("crashes")&&c){g=g||b(ob,a);var h="";"object"===R(c)?"undefined"!==
typeof c.stack?h=c.stack:("undefined"!==typeof c.name&&(h+=c.name+":"),"undefined"!==typeof c.message&&(h+=c.message+"\n"),"undefined"!==typeof c.fileName&&(h+="in "+c.fileName+"\n"),"undefined"!==typeof c.lineNumber&&(h+="on "+c.lineNumber),"undefined"!==typeof c.columnNumber&&(h+=":"+c.columnNumber)):h=c+"";if(h.length>b(wa,a)*b(va,a)){b(e,a).call(a,f.DEBUG,"record_error, Error stack is too long will be truncated");c=h.split("\n");c.length>b(va,a)&&(c=c.splice(0,b(va,a)));h=0;for(var n=c.length;h<
n;h++)c[h].length>b(wa,a)&&(c[h]=c[h].substring(0,b(wa,a)));h=c.join("\n")}d=!!d;c=b(xb,a).call(a);h={_resolution:c._resolution,_error:h,_app_version:c._app_version,_run:O()-b(Eb,a),_not_os_specific:!0,_javascript:!0};if(n=navigator.battery||navigator.webkitBattery||navigator.mozBattery||navigator.msBattery)h._bat=Math.floor(100*n.level);"undefined"!==typeof navigator.onLine&&(h._online=!!navigator.onLine);A&&(h._background=!document.hasFocus());0<b(pa,a).length&&(h._logs=b(pa,a).join("\n"));k(pa,
a,[]);h._nonfatal=d;h._view=a.getViewName();"undefined"!==typeof g&&(g=oa(g,b(J,a),b(H,a),b(V,a),"record_error",b(e,a)),h._custom=g);try{var l=document.createElement("canvas").getContext("experimental-webgl");h._opengl=l.getParameter(l.VERSION)}catch(r){b(e,a).call(a,f.ERROR,"Could not get the experimental-webgl context: "+r)}d={};d.metrics=JSON.stringify({_ua:c._ua});b(fb,a)&&"function"===typeof b(fb,a)&&(b(e,a).call(a,f.VERBOSE,"recordError, Applying crash filter to:["+JSON.stringify(h)+"]"),h=
b(fb,a).call(a,h),b(e,a).call(a,f.VERBOSE,"recordError, Filtered crash object:["+JSON.stringify(h)+"]"));h?(d.crash=JSON.stringify(h),b(T,a).call(a,d)):b(e,a).call(a,f.DEBUG,"recordError, Crash object was filtered out")}}else b(e,a).call(a,f.WARNING,"recordError, Crash tracking is disabled by the server config. Not tracking errors.")});p(this,mc,function(){b(e,a).call(a,f.INFO,"checkIgnore, Checking if user or visit should be ignored");a.ignore_prefetch&&A&&"undefined"!==typeof document.visibilityState&&
"prerender"===document.visibilityState&&(a.ignore_visitor=!0,b(e,a).call(a,f.DEBUG,"checkIgnore, Ignoring visit due to prerendering"));a.ignore_bots&&Ac()&&(a.ignore_visitor=!0,b(e,a).call(a,f.DEBUG,"checkIgnore, Ignoring visit due to bot"))});w(this,"content",{enterContentZone:function(){b(Ba,a).call(a)},refreshContentZone:function(){b(Kc,a).call(a)},exitContentZone:function(){b(Qb,a).call(a)}});p(this,Ba,function(c){A?b(Oa,a)&&!c?b(e,a).call(a,f.DEBUG,"content.enterContentZone, Already in content zone"):
!b(Lb,a)||4E3>Wa()-b(Lb,a)?(b(e,a).call(a,f.DEBUG,"content.enterContentZone, Not enough time passed since initialization"),setTimeout(function(){b(Ba,a).call(a)},4001)):(b(e,a).call(a,f.INFO,"content.enterContentZone, Entering content zone"),k(Oa,a,!0),c||b(nc,a).call(a),k(db,a,setInterval(function(){b(nc,a).call(a)},b(gb,a)))):b(e,a).call(a,f.WARNING,"content.enterContentZone, window object is not available. Not entering content zone.")});p(this,Kc,function(){b(Jb,a)?(b(e,a).call(a,f.INFO,"content.refreshContentZone, Refreshing content zone"),
b(Qb,a).call(a),b(Da,a).call(a),b(Ca,a).call(a),setTimeout(function(){b(Ba,a).call(a)},1E3)):b(e,a).call(a,f.DEBUG,"content.refreshContentZone, Refresh content zone is disabled")});p(this,Qb,function(){b(Oa,a)?(b(e,a).call(a,f.INFO,"content.exitContentZone, Exiting content zone"),k(Oa,a,!1),b(db,a)&&(clearInterval(b(db,a)),b(e,a).call(a,f.DEBUG,"content.exitContentZone, content zone exited"))):b(e,a).call(a,f.DEBUG,"content.exitContentZone, Not in content zone")});p(this,Lc,function(){b(e,a).call(a,
f.DEBUG,"prepareContentRequest, forming content request");var c=b(yb,a).call(a,!0),d={l:{},p:{}},g=Math.max(c.width,c.height);c=Math.min(c.width,c.height);d.l.w=g;d.l.h=c;d.p.w=c;d.p.h=g;d={method:"queue",la:(navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage).split("-")[0],resolution:JSON.stringify(d),cly_ws:1,cly_origin:window.location.origin,dt:ec()};b(Ta,a).call(a,d);return d});p(this,nc,function(){b(e,a).call(a,f.DEBUG,"sendContentRequest, sending content request");
var c=b(Lc,a).call(a);b(da,a).call(a,"sendContentRequest,",a.url+b(hc,a),c,function(d,g,h){if(!d)if(h){try{var n=JSON.parse(h)}catch(r){b(e,a).call(a,f.VERBOSE,"sendContentRequest, No content to display or an error while parsing content: "+r);return}if(n.html&&n.geo){b(Mc,a).call(a,n);clearInterval(b(db,a));window.addEventListener("message",function(r){b(Nc,a).call(a,r)});var l;window.addEventListener("resize",function(){clearTimeout(l);l=setTimeout(function(){var r=window.innerWidth,u=window.innerHeight,
y=document.getElementById(b(eb,a));y&&y.contentWindow.postMessage({type:"resize",width:r,height:u},"*")},200)})}else b(e,a).call(a,f.VERBOSE,"sendContentRequest, no html content or orientation to display")}else b(e,a).call(a,f.VERBOSE,"sendContentRequest, no content to display")},!0)});p(this,Mc,function(c){try{var d=document.createElement("iframe");d.id=b(eb,a);d.src=c.html;d.style.position="absolute";var g=c.geo.p,h=b(yb,a).call(a,!0);h.width>=h.height&&(g=c.geo.l);d.style.left=g.x+"px";d.style.top=
g.y+"px";d.style.width=g.w+"px";d.style.height=g.h+"px";d.style.border="none";d.style.zIndex="999999";document.body.appendChild(d)}catch(n){b(e,a).call(a,f.ERROR,"displayContent, Error while creating iframe for the content: "+n)}});p(this,Nc,function(c){if(-1!==a.contentWhitelist.indexOf(c.origin)){b(e,a).call(a,f.DEBUG,"interpretContentMessage, Received message from: ["+c.origin+"] with data: ["+JSON.stringify(c.data)+"]");var d=c.data;c=d.close;var g=d.link,h=d.event;d=d.resize_me;if(h){b(e,a).call(a,
f.DEBUG,"interpretContentMessage, Received event");1===c&&(b(e,a).call(a,f.DEBUG,"interpretContentMessage, Closing content frame for event"),b(Rb,a).call(a));if(!Array.isArray(h)){if("object"===R(h))throw new TypeError('"event" is read-only');b(e,a).call(a,f.ERROR,"interpretContentMessage, Invalid event type: ["+R(h)+"]");return}for(var n=0;n<h.length;n++)b(ba,a).call(a,h[n])}g&&(1===c&&(b(e,a).call(a,f.DEBUG,"interpretContentMessage, Closing content frame for link"),b(Rb,a).call(a)),window.open(g,
"_blank"),b(e,a).call(a,f.DEBUG,"interpretContentMessage, Opened link in new tab: [".concat(g,"]")));if(d){b(e,a).call(a,f.DEBUG,"interpretContentMessage, Resizing iframe");h=b(yb,a).call(a,!0);if(!d.l||!d.p){b(e,a).call(a,f.ERROR,"interpretContentMessage, Invalid resize object");return}g=d.p;h.width>=h.height&&(g=d.l);d=document.getElementById(b(eb,a));d.style.left=g.x+"px";d.style.top=g.y+"px";d.style.width=g.w+"px";d.style.height=g.h+"px"}1===c&&b(Rb,a).call(a)}});p(this,Rb,function(){var c=document.getElementById(b(eb,
a));c&&(c.remove(),b(e,a).call(a,f.DEBUG,"interpretContentMessage, removed iframe"),b(Oa,a)&&b(Ba,a).call(a,!0))});p(this,Ca,function(){0<b(P,a).length&&(b(e,a).call(a,f.DEBUG,"Flushing events"),b(T,a).call(a,{events:JSON.stringify(b(P,a))}),k(P,a,[]),b(z,a).call(a,"cly_event",b(P,a)))});p(this,Sb,function(c,d){if(A)if(document.getElementById("countly-feedback-sticker-"+c._id))b(e,a).call(a,f.ERROR,"Widget with same ID exists");else try{var g=document.createElement("div");g.className="countly-iframe-wrapper";
g.id="countly-iframe-wrapper-"+c._id;var h=document.createElement("span");h.className="countly-feedback-close-icon";h.id="countly-feedback-close-icon-"+c._id;h.innerText="x";var n=document.createElement("iframe");n.name="countly-feedback-iframe";n.id="countly-feedback-iframe";n.src=a.url+"/feedback?widget_id="+c._id+"&app_key="+a.app_key+"&device_id="+a.device_id+"&sdk_version="+b(ma,a);document.body.appendChild(g);g.appendChild(h);g.appendChild(n);D(document.getElementById("countly-feedback-close-icon-"+
c._id),"click",function(){document.getElementById("countly-iframe-wrapper-"+c._id).style.display="none";document.getElementById("cfbg").style.display="none"});if(d){var l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.id="feedback-sticker-svg";l.setAttribute("aria-hidden","true");l.setAttribute("data-prefix","far");l.setAttribute("data-icon","grin");l.setAttribute("class","svg-inline--fa fa-grin fa-w-16");l.setAttribute("role","img");l.setAttribute("xmlns","http://www.w3.org/2000/svg");
l.setAttribute("viewBox","0 0 496 512");var r=document.createElementNS("http://www.w3.org/2000/svg","path");r.id="smileyPathInStickerSvg";r.setAttribute("fill","white");r.setAttribute("d","M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm105.6-151.4c-25.9 8.3-64.4 13.1-105.6 13.1s-79.6-4.8-105.6-13.1c-9.9-3.1-19.4 5.4-17.7 15.3 7.9 47.1 71.3 80 123.3 80s115.3-32.9 123.3-80c1.6-9.8-7.7-18.4-17.7-15.3zM168 240c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm160 0c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32z");
var u=document.createElement("span");u.innerText=c.trigger_button_text;var y=document.createElement("div");y.style.color=7>c.trigger_font_color.length?"#"+c.trigger_font_color:c.trigger_font_color;y.style.backgroundColor=7>c.trigger_bg_color.length?"#"+c.trigger_bg_color:c.trigger_bg_color;y.className="countly-feedback-sticker  "+c.trigger_position+"-"+c.trigger_size;y.id="countly-feedback-sticker-"+c._id;l.appendChild(r);y.appendChild(l);y.appendChild(u);document.body.appendChild(y);var E=document.getElementById("smileyPathInStickerSvg");
E&&(E.style.fill=7>c.trigger_font_color.length?"#"+c.trigger_font_color:c.trigger_font_color);D(document.getElementById("countly-feedback-sticker-"+c._id),"click",function(){document.getElementById("countly-iframe-wrapper-"+c._id).style.display="block";document.getElementById("cfbg").style.display="block"})}else document.getElementById("countly-iframe-wrapper-"+c._id).style.display="block",document.getElementById("cfbg").style.display="block"}catch(X){b(e,a).call(a,f.ERROR,"Somethings went wrong while element injecting process: "+
X)}else b(e,a).call(a,f.WARNING,"processWidget, window object is not available. Not processing widget.")});p(this,oc,function(){var c;if("undefined"!==typeof a.onload&&0<a.onload.length){for(c=0;c<a.onload.length;c++)if("function"===typeof a.onload[c])a.onload[c](a);a.onload=[]}});p(this,Tb,function(){if(b(U,a))if(b(ub,a)){b(e,a).call(a,f.INFO,"reportViewDuration, Reporting view duration for: ["+b(U,a)+"]");var c={name:b(U,a)};a.check_consent("views")&&(b(ba,a).call(a,{key:Q.VIEW,dur:b(qa,a)?O()-
b(Ia,a):b(Ja,a),segmentation:c},b(sa,a)),k(U,a,null))}else b(e,a).call(a,f.INFO,"reportViewDuration, View tracking is disabled by the server config. Not tracking view duration");else b(e,a).call(a,f.INFO,"reportViewDuration, No last view, will not report view duration")});p(this,Oc,function(){b(e,a).call(a,f.INFO,"getLastView, Getting last view: ["+b(U,a)+"]");return b(U,a)});p(this,pc,function(){if(b(ka,a)){b(e,a).call(a,f.DEBUG,"Extending session");var c=b(B,a).call(a,"cly_session");if(!c||parseInt(c)<=
O())k(aa,a,!1),a.begin_session(!b(Ha,a));b(z,a).call(a,"cly_session",O()+60*b(La,a))}else b(e,a).call(a,f.DEBUG,"Will not extend the session as session cookie is disabled")});p(this,Ta,function(c){c.app_key=a.app_key;c.device_id=a.device_id;c.sdk_name=b(ta,a);c.sdk_version=b(ma,a);c.t=b(I,a);c.av=a.app_version;var d=b(qc,a).call(a);if(c.metrics){var g=JSON.parse(c.metrics);g._ua||(g._ua=d,c.metrics=JSON.stringify(g))}else c.metrics=JSON.stringify({_ua:d});a.check_consent("location")&&b(Ib,a)?(a.country_code&&
(c.country_code=a.country_code),a.city&&(c.city=a.city),null!==a.ip_address&&(c.ip_address=a.ip_address)):c.location="";c.timestamp=Wa();d=new Date;c.hour=d.getHours();c.dow=d.getDay()});p(this,T,function(c){a.ignore_visitor?b(e,a).call(a,f.DEBUG,"User is opt_out will ignore the request: "+c):b(hb,a)?a.app_key&&a.device_id?(b(Ta,a).call(a,c),b(M,a).length>b(Pa,a)&&b(M,a).shift(),b(M,a).push(c),b(z,a).call(a,"cly_queue",b(M,a),!0)):b(e,a).call(a,f.ERROR,"app_key or device_id is missing ",a.app_key,
a.device_id):b(e,a).call(a,f.DEBUG,"Tracking is disabled by server config, will not track the request: "+JSON.stringify(c))});p(this,wb,function(){b(oc,a).call(a);if(a.ignore_visitor)k(bb,a,!1),b(e,a).call(a,f.WARNING,"User opt_out:["+a.ignore_visitor+"], no heartbeat");else{k(bb,a,!0);b(Ya,a)&&"undefined"!==typeof t.q&&0<t.q.length&&b(Da,a).call(a);if(b(aa,a)&&b(Ha,a)&&b(qa,a)){var c=O();c-b(ja,a)>b(Qa,a)&&(a.session_duration(c-b(ja,a)),k(ja,a,c),0<a.hcErrorCount&&b(z,a).call(a,ca.errorCount,a.hcErrorCount),
0<a.hcWarningCount&&b(z,a).call(a,ca.warningCount,a.hcWarningCount))}0<b(P,a).length&&!a.test_mode_eq&&(b(P,a).length<=b(Aa,a)?(b(T,a).call(a,{events:JSON.stringify(b(P,a))}),k(P,a,[])):(c=b(P,a).splice(0,b(Aa,a)),b(T,a).call(a,{events:JSON.stringify(c)})),b(z,a).call(a,"cly_event",b(P,a)));!b(N,a)&&0<b(M,a).length&&b(ab,a)&&O()>b(qb,a)&&(k(ab,a,!1),c=b(M,a)[0],c.rr=b(M,a).length,b(e,a).call(a,f.DEBUG,"Processing request",c),b(z,a).call(a,"cly_queue",b(M,a),!0),a.test_mode||b(da,a).call(a,"send_request_queue",
a.url+b(nb,a),c,function(d,g){d?k(qb,a,O()+b($a,a)):b(M,a).shift();b(z,a).call(a,"cly_queue",b(M,a),!0);k(ab,a,!0)},!1));setTimeout(function(){b(wb,a).call(a)},b(Za,a))}});p(this,Pc,function(){return b(tb,a)});p(this,Da,function(){if("undefined"===typeof t||"undefined"===typeof t.i)b(e,a).call(a,f.DEBUG,"Countly is not finished initialization yet, will process the queue after initialization is done");else{var c=t.q;t.q=[];for(var d=0;d<c.length;d++){var g=c[d];b(e,a).call(a,f.DEBUG,"Processing queued calls:"+
g);if("function"===typeof g)g();else if(Array.isArray(g)&&0<g.length){var h=a,n=0;try{t.i[g[n]]&&(h=t.i[g[n]],n++)}catch(r){b(e,a).call(a,f.DEBUG,"No instance found for the provided key while processing async queue");t.q.push(g);continue}if("function"===typeof h[g[n]])h[g[n]].apply(h,g.slice(n+1));else if(0===g[n].indexOf("userData.")){var l=g[n].replace("userData.","");"function"===typeof h.userData[l]&&h.userData[l].apply(h,g.slice(n+1))}else 0===g[n].indexOf("content.")?(l=g[n].replace("content.",
""),"function"===typeof h.content[l]&&h.content[l].apply(h,g.slice(n+1))):0===g[n].indexOf("feedback.")?(l=g[n].replace("feedback.",""),"function"===typeof h.feedback[l]&&h.feedback[l].apply(h,g.slice(n+1))):"function"===typeof t[g[n]]&&t[g[n]].apply(t,g.slice(n+1))}}}});p(this,Ub,function(){var c=b(B,a).call(a,"cly_id");return c?(k(I,a,b(B,a).call(a,"cly_id_type")),c):ac()});p(this,Qc,function(c){return/[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-4[0-9a-fA-F]{3}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}/.test(c)});p(this,
qc,function(){return a.metrics&&a.metrics._ua?a.metrics._ua:Xa()});p(this,xb,function(){var c=JSON.parse(JSON.stringify(a.metrics||{}));c._app_version=c._app_version||a.app_version;c._ua=c._ua||Xa();var d=b(yb,a).call(a);d&&(d=""+d.width+"x"+d.height,c._resolution=c._resolution||d);A&&window.devicePixelRatio&&(c._density=c._density||window.devicePixelRatio);d=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;"undefined"!==typeof d&&(c._locale=c._locale||
d);b(Vb,a).call(a)&&(c._store=c._store||document.referrer);b(e,a).call(a,f.DEBUG,"Got metrics",c);return c});p(this,yb,function(c){b(e,a).call(a,f.DEBUG,"Getting the resolution of the device");if(!A||!screen)return b(e,a).call(a,f.DEBUG,"No screen available"),null;var d=screen.width?parseInt(screen.width):0,g=screen.height?parseInt(screen.height):0;if(c){c=Math.min(window.innerWidth,document.documentElement.clientWidth);var h=Math.min(window.innerHeight,document.documentElement.clientHeight);d=c?
parseInt(c):d;g=h?parseInt(h):g}if(0===d||0===g)return b(e,a).call(a,f.DEBUG,"Screen width or height is non existent"),null;navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)&&window.devicePixelRatio&&(b(e,a).call(a,f.VERBOSE,"Mobile Mac device detected, adjusting resolution"),d=Math.round(d*window.devicePixelRatio),g=Math.round(g*window.devicePixelRatio));return{width:d,height:g}});p(this,Vb,function(c){if(!A)return!1;c=c||document.referrer;var d=!1;if("undefined"===typeof c||0===c.length)b(e,
a).call(a,f.DEBUG,"Invalid referrer:["+c+"], ignoring.");else{var g=Hc.exec(c);if(g)if(g[11])if(g[11]===window.location.hostname)b(e,a).call(a,f.DEBUG,"Referrer is current host:["+c+"], ignoring.");else if(b(fa,a)&&b(fa,a).length)for(d=!0,g=0;g<b(fa,a).length;g++){if(0<=c.indexOf(b(fa,a)[g])){b(e,a).call(a,f.DEBUG,"Referrer in ignore list:["+c+"], ignoring.");d=!1;break}}else b(e,a).call(a,f.DEBUG,"Valid referrer:["+c+"]"),d=!0;else b(e,a).call(a,f.DEBUG,"No path found in referrer:["+c+"], ignoring.");
else b(e,a).call(a,f.DEBUG,"Referrer is corrupt:["+c+"], ignoring.")}return d});p(this,e,function(c,d,g){if(a.debug&&"undefined"!==typeof console){g&&"object"===R(g)&&(g=JSON.stringify(g));b(Ya,a)||(d="["+a.app_key+"] "+d);c||(c=f.DEBUG);var h="";g&&(h=" "+g);d=c+"[Countly] "+d+h;c===f.ERROR?(console.error(d),b(xa,a).incrementErrorCount()):c===f.WARNING?(console.warn(d),b(xa,a).incrementWarningCount()):c===f.INFO?console.info(d):c===f.VERBOSE?console.log(d):console.debug(d)}});p(this,da,function(c,
d,g,h,n,l){b(Fb,a)||l?(b(tb,a).push({functionName:c,url:d,params:g}),A?b(rc,a).call(a,c,d,g,h,n):b(sc,a).call(a,c,d,g,h,n)):b(e,a).call(a,f.DEBUG,"Network request is disabled by the SCNetwork")});p(this,rc,function(c,d,g,h,n){n=n||!1;try{b(e,a).call(a,f.DEBUG,"Sending XML HTTP request");var l=new XMLHttpRequest;g=g||{};cc(g,a.salt).then(function(r){var u="POST";if(a.force_post||2E3<=r.length)u="POST";"GET"===u?l.open("GET",d+"?"+r,!0):(l.open("POST",d,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"));
for(var y in a.headers)l.setRequestHeader(y,a.headers[y]);l.onreadystatechange=function(){4===l.readyState&&(b(e,a).call(a,f.DEBUG,c+" HTTP request completed with status code: ["+l.status+"] and response: ["+l.responseText+"]"),(n?b(Xb,a).call(a,l.status,l.responseText):b(Wb,a).call(a,l.status,l.responseText))?"function"===typeof h&&h(!1,g,l.responseText):(b(e,a).call(a,f.ERROR,c+" Invalid response from server"),"send_request_queue"===c&&b(xa,a).saveRequestCounters(l.status,l.responseText),"function"===
typeof h&&h(!0,g,l.status,l.responseText)))};"GET"===u?l.send():l.send(r)})}catch(r){b(e,a).call(a,f.ERROR,c+" Something went wrong while making an XML HTTP request: "+r),"function"===typeof h&&h(!0,g)}});p(this,sc,function(c,d,g,h,n){n=n||!1;var l;try{b(e,a).call(a,f.DEBUG,"Sending Fetch request");var r="POST",u={"Content-type":"application/x-www-form-urlencoded"},y=null;g=g||{};cc(g,a.salt).then(function(E){a.force_post||2E3<=E.length?(r="POST",y=E):d+="?"+E;for(var X in a.headers)u[X]=a.headers[X];
fetch(d,{method:r,headers:u,body:y}).then(function(L){l=L;return l.text()}).then(function(L){b(e,a).call(a,f.DEBUG,c+" Fetch request completed wit status code: ["+l.status+"] and response: ["+L+"]");(n?b(Xb,a).call(a,l.status,L):b(Wb,a).call(a,l.status,L))?"function"===typeof h&&h(!1,g,L):(b(e,a).call(a,f.ERROR,c+" Invalid response from server"),"send_request_queue"===c&&b(xa,a).saveRequestCounters(l.status,L),"function"===typeof h&&h(!0,g,l.status,L))})["catch"](function(L){b(e,a).call(a,f.ERROR,
c+" Failed Fetch request: "+L);"function"===typeof h&&h(!0,g)})})}catch(E){b(e,a).call(a,f.ERROR,c+" Something went wrong with the Fetch request attempt: "+E),"function"===typeof h&&h(!0,g)}});p(this,Wb,function(c,d){if(!(200<=c&&300>c))return b(e,a).call(a,f.ERROR,"Http response status code:["+c+"] is not within the expected range"),!1;try{var g=JSON.parse(d);return"[object Object]"!==Object.prototype.toString.call(g)?(b(e,a).call(a,f.ERROR,"Http response is not JSON Object"),!1):!!g.result}catch(h){return b(e,
a).call(a,f.ERROR,"Http response is not JSON: "+h),!1}});p(this,Xb,function(c,d){if(!(200<=c&&300>c))return b(e,a).call(a,f.ERROR,"Http response status code:["+c+"] is not within the expected range"),!1;try{var g=JSON.parse(d);return"[object Object]"===Object.prototype.toString.call(g)||Array.isArray(g)||"No content block found!"===g?!0:(b(e,a).call(a,f.ERROR,"Http response is not JSON Object nor JSON Array"),!1)}catch(h){return b(e,a).call(a,f.ERROR,"Http response is not JSON: "+h),!1}});p(this,
tc,function(){A?k(Na,a,Math.max(b(Na,a),window.scrollY,document.body.scrollTop,document.documentElement.scrollTop)):b(e,a).call(a,f.WARNING,"processScroll, window object is not available. Not processing scroll.")});p(this,Yb,function(){if(!A)b(e,a).call(a,f.WARNING,"processScrollView, window object is not available. Not processing scroll view.");else if(b(Ma,a)){k(Ma,a,!1);var c=Cb(),d=gc(),g=Bc();a.check_consent("scrolls")&&(c={type:"scroll",y:b(Na,a)+g,width:d,height:c,view:a.getViewUrl()},c=oa(c,
b(J,a),b(H,a),b(V,a),"processScrollView",b(e,a)),a.track_domains&&(c.domain=window.location.hostname),b(ba,a).call(a,{key:Q.ACTION,segmentation:c}))}});p(this,Rc,function(){return b(I,a)});p(this,uc,function(c){b(z,a).call(a,"cly_token",c)});p(this,Sc,function(){var c=b(B,a).call(a,"cly_token");b(W,a).call(a,"cly_token");return c});p(this,Tc,function(){return b(P,a)});p(this,Uc,function(){return b(M,a)});p(this,Vc,function(c){c+="=";for(var d=document.cookie.split(";"),g=0,h=d.length;g<h;g++){for(var n=
d[g];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(c))return n.substring(c.length,n.length)}return null});p(this,vc,function(c,d,g){var h=new Date;h.setTime(h.getTime()+864E5*g);g="; expires="+h.toGMTString();document.cookie=c+"="+d+g+"; path=/"});p(this,B,function(c,d,g){if("none"===a.storage||"object"!==R(a.storage)&&!A)b(e,a).call(a,f.DEBUG,"Storage is disabled. Value with key: ["+c+"] won't be retrieved");else{g||(c=a.app_key+"/"+c,a.namespace&&(c=Fa(a.namespace)+"/"+c));if(a.storage&&
"object"===R(a.storage)&&"function"===typeof a.storage.getItem){var h=a.storage.getItem(c);return c.endsWith("cly_id")?h:a.deserialize(h)}void 0===d&&(d=b(ra,a));try{return d?h=localStorage.getItem(c):"localstorage"!==a.storage&&(h=b(Vc,a).call(a,c)),c.endsWith("cly_id")?h:a.deserialize(h)}catch(n){}}});p(this,z,function(c,d,g,h){if("none"===a.storage||"object"!==R(a.storage)&&!A)b(e,a).call(a,f.DEBUG,"Storage is disabled. Value with key: "+c+" won't be stored");else{h||(c=a.app_key+"/"+c,a.namespace&&
(c=Fa(a.namespace)+"/"+c));try{"undefined"!==typeof d&&null!==d&&("object"===R(a.storage)&&"function"===typeof a.storage.setItem?a.storage.setItem(c,d):(void 0===g&&(g=b(ra,a)),d=a.serialize(d),g?localStorage.setItem(c,d):"localstorage"!==a.storage&&b(vc,a).call(a,c,d,30)))}catch(n){}}});p(this,W,function(c,d,g){if("none"===a.storage||"object"!==R(a.storage)&&!A)b(e,a).call(a,f.DEBUG,"Storage is disabled. Value with key: "+c+" won't be removed");else{g||(c=a.app_key+"/"+c,a.namespace&&(c=Fa(a.namespace)+
"/"+c));try{"object"===R(a.storage)&&"function"===typeof a.storage.removeItem?a.storage.removeItem(c):(void 0===d&&(d=b(ra,a)),d?localStorage.removeItem(c):"localstorage"!==a.storage&&b(vc,a).call(a,c,"",-1))}catch(h){}}});p(this,Wc,function(){if(b(B,a).call(a,a.namespace+"cly_id",!1,!0)){b(z,a).call(a,"cly_id",b(B,a).call(a,a.namespace+"cly_id",!1,!0));b(z,a).call(a,"cly_id_type",b(B,a).call(a,a.namespace+"cly_id_type",!1,!0));b(z,a).call(a,"cly_event",b(B,a).call(a,a.namespace+"cly_event",!1,!0));
b(z,a).call(a,"cly_session",b(B,a).call(a,a.namespace+"cly_session",!1,!0));var c=b(B,a).call(a,a.namespace+"cly_queue",!1,!0);Array.isArray(c)&&(c=c.filter(function(d){return d.app_key===a.app_key}),b(z,a).call(a,"cly_queue",c));b(B,a).call(a,a.namespace+"cly_cmp_id",!1,!0)&&(b(z,a).call(a,"cly_cmp_id",b(B,a).call(a,a.namespace+"cly_cmp_id",!1,!0)),b(z,a).call(a,"cly_cmp_uid",b(B,a).call(a,a.namespace+"cly_cmp_uid",!1,!0)));b(B,a).call(a,a.namespace+"cly_ignore",!1,!0)&&b(z,a).call(a,"cly_ignore",
b(B,a).call(a,a.namespace+"cly_ignore",!1,!0));b(W,a).call(a,"cly_id",!1,!0);b(W,a).call(a,"cly_id_type",!1,!0);b(W,a).call(a,"cly_event",!1,!0);b(W,a).call(a,"cly_session",!1,!0);b(W,a).call(a,"cly_queue",!1,!0);b(W,a).call(a,"cly_cmp_id",!1,!0);b(W,a).call(a,"cly_cmp_uid",!1,!0);b(W,a).call(a,"cly_ignore",!1,!0)}});p(this,Xc,function(c,d){b(e,a).call(a,f.DEBUG,"onStorageChange, Applying storage changes for key:",c);b(e,a).call(a,f.DEBUG,"onStorageChange, Applying storage changes for value:",d);
switch(c){case "cly_queue":k(M,a,a.deserialize(d||"[]"));break;case "cly_event":k(P,a,a.deserialize(d||"[]"));break;case "cly_remote_configs":k(S,a,a.deserialize(d||"{}"));break;case "cly_ignore":a.ignore_visitor=a.deserialize(d);break;case "cly_config":k(ua,a,a.deserialize(d||"{}"));b(Nb,a).call(a,b(ua,a));break;case "cly_id":a.device_id=d;break;case "cly_id_type":k(I,a,a.deserialize(d))}});p(this,Yc,function(){k(M,a,[]);b(z,a).call(a,"cly_queue",[]);k(P,a,[]);b(z,a).call(a,"cly_event",[])});p(this,
Zc,function(){return{eventQ:b(P,a),requestQ:b(M,a)}});w(this,"_internals",{store:b(z,this),getDocWidth:gc,getDocHeight:Cb,getViewportHeight:Bc,get_page_coord:fc,get_event_target:Bb,add_event_listener:D,createNewObjectFromProperties:lb,truncateObject:oa,truncateSingleValue:C,stripTrailingSlash:Fa,prepareParams:cc,sendXmlHttpRequest:b(rc,this),isResponseValid:b(Wb,this),getInternalDeviceIdType:b(Rc,this),getMsTimestamp:Wa,getTimestamp:O,isResponseValidBroad:b(Xb,this),secureRandom:$b,log:b(e,this),
checkIfLoggingIsOn:Ab,getMetrics:b(xb,this),getUA:b(qc,this),prepareRequest:b(Ta,this),generateUUID:ac,sendEventsForced:b(Ca,this),isUUID:b(Qc,this),calculateChecksum:zc,isReferrerUsable:b(Vb,this),getId:b(Ub,this),heartBeat:b(wb,this),toRequestQueue:b(T,this),reportViewDuration:b(Tb,this),loadJS:Dc,loadCSS:Db,getLastView:b(Oc,this),setToken:b(uc,this),getToken:b(Sc,this),showLoader:Ec,hideLoader:Fc,setValueInStorage:b(z,this),getValueFromStorage:b(B,this),removeValueFromStorage:b(W,this),add_cly_events:b(ba,
this),processScrollView:b(Yb,this),processScroll:b(tc,this),currentUserAgentString:Xa,currentUserAgentDataString:dc,userAgentDeviceDetection:ec,userAgentSearchBotDetection:Ac,getRequestQueue:b(Uc,this),getEventQueue:b(Tc,this),sendFetchRequest:b(sc,this),processAsyncQueue:b(Da,this),makeNetworkRequest:b(da,this),onStorageChange:b(Xc,this),clearQueue:b(Yc,this),getLocalQueues:b(Zc,this),testingGetRequests:b(Pc,this)});p(this,xa,{sendInstantHCRequest:function(){if(b(N,a))b(e,a).call(a,f.DEBUG,"sendInstantHCRequest, Offline mode is active. Not sending health check request."),
k(sb,a,!0);else{var c=C(a.hcErrorMessage,1E3,"healthCheck",b(e,a));""!==c&&(c=JSON.stringify(c));c={hc:JSON.stringify({el:a.hcErrorCount,wl:a.hcWarningCount,sc:a.hcStatusCode,em:c}),metrics:JSON.stringify({_app_version:a.app_version})};b(Ta,a).call(a,c);b(da,a).call(a,"[healthCheck]",a.url+b(nb,a),c,function(d){d||b(xa,a).resetAndSaveCounters()},!0)}},resetAndSaveCounters:function(){b(xa,a).resetCounters();b(z,a).call(a,ca.errorCount,a.hcErrorCount);b(z,a).call(a,ca.warningCount,a.hcWarningCount);
b(z,a).call(a,ca.statusCode,a.hcStatusCode);b(z,a).call(a,ca.errorMessage,a.hcErrorMessage)},incrementErrorCount:function(){a.hcErrorCount++},incrementWarningCount:function(){a.hcWarningCount++},resetCounters:function(){a.hcErrorCount=0;a.hcWarningCount=0;a.hcStatusCode=-1;a.hcErrorMessage=""},saveRequestCounters:function(c,d){a.hcStatusCode=c;a.hcErrorMessage=d;b(z,a).call(a,ca.statusCode,a.hcStatusCode);b(z,a).call(a,ca.errorMessage,a.hcErrorMessage)}});k(Ic,this,this);k(Ya,this,!t.i);k(aa,this,
!1);k(nb,this,"/i");k(Ga,this,"/o/sdk");k(M,this,[]);k(P,this,[]);k(S,this,{});k(pa,this,[]);k(ea,this,{});k(ob,this,null);k(Ha,this,!0);b(ja,this);k(pb,this,0);k(U,this,null);k(Ia,this,0);k(Ja,this,0);k(qb,this,0);k(ya,this,0);k(ab,this,!0);k(bb,this,!1);k(ha,this,{});k(qa,this,!0);k(Eb,this,O());k(ra,this,!0);k(za,this,null);k(I,this,1);k(Ma,this,!1);k(Na,this,0);k(rb,this,!1);k(sa,this,null);k(cb,this,null);k(la,this,null);k(sb,this,!1);k(tb,this,[]);k(hc,this,"/o/sdk/content");k(Oa,this,!1);k(db,
this,null);k(eb,this,"cly-content-iframe");k(fb,this,null);k(Fb,this,!0);k(Pa,this,x("queue_size",q,1E3));k(Aa,this,x("max_events",q,100));k(Qa,this,x("session_update",q,60));k(gb,this,1E3*Math.max(x("content_zone_timer_interval",q,30),15));k(Gb,this,4);k(hb,this,!0);k(ib,this,!0);k(vb,this,!0);k(ub,this,!0);k(Hb,this,!0);k(Ib,this,!0);k(jb,this,!1);k(Jb,this,!0);k(Ra,this,x("require_consent",q,!1));k(J,this,x("max_key_length",q,128));k(H,this,x("max_value_size",q,256));k(V,this,x("max_segmentation_values",
q,100));k(Sa,this,x("max_breadcrumb_count",q,100));k(va,this,x("max_stack_trace_lines_per_thread",q,30));k(wa,this,x("max_stack_trace_line_length",q,200));this.app_key=x("app_key",q,null);this.url=Fa(x("url",q,""));this.serialize=x("serialize",q,t.serialize);this.deserialize=x("deserialize",q,t.deserialize);try{localStorage.setItem("cly_testLocal",!0),localStorage.removeItem("cly_testLocal")}catch(c){b(e,this).call(this,f.ERROR,"Local storage test failed, Halting local storage support: "+c),k(ra,
this,!1)}k(ua,this,b(B,this).call(this,"cly_config"));b(ua,this)||(k(ua,this,x("behavior_settings",q,{})),b(z,this).call(this,"cly_config",JSON.stringify(b(ua,this))));b(Nb,this).call(this,b(ua,this));k(K,this,{});for(var G=0;G<t.features.length;G++)b(K,this)[t.features[G]]={};b(Jc,this).call(this,q);b(oc,this).call(this);setTimeout(function(){t.noHeartBeat?b(e,a).call(a,f.WARNING,"initialize, Heartbeat disabled. This is for testing purposes only!"):b(wb,a).call(a);a.remote_config&&a.fetch_remote_config(a.remote_config)},
1);A&&document.documentElement.setAttribute("data-countly-useragent",Xa());k(Lb,this,Wa());b(xa,this).sendInstantHCRequest();b(jb,this)&&(b(Ba,this).call(this),k(Kb,this,!0));b(e,this).call(this,f.INFO,"initialize, Countly initialized")}),bd=!0;t.features="apm attribution clicks crashes events feedback forms location remote-config scrolls sessions star-rating users views".split(" ");t.q=t.q||[];t.onload=t.onload||[];t.CountlyClass=ad;t.init=function(q){q=q||{};if(t.loadAPMScriptsAsync&&bd)bd=!1,cd(q);
else{var v=q.app_key||t.app_key;if(!t.i||!t.i[v]){q=new ad(q);if(!t.i){t.i={};for(var a in q)t[a]=q[a]}t.i[v]=q}return t.i[v]}};t.serialize=function(q){try{"object"===R(q)&&(q=JSON.stringify(q))}catch(v){}return q};t.deserialize=function(q){if(""===q)return q;try{q=JSON.parse(q)}catch(v){}return q};t.getViewName=function(){return A?window.location.pathname:"web_worker"};t.getViewUrl=function(){return A?window.location.pathname:"web_worker"};t.getSearchQuery=function(){if(A)return window.location.search};
t.DeviceIdType={DEVELOPER_SUPPLIED:0,SDK_GENERATED:1,TEMPORARY_ID:2};A&&window.addEventListener("storage",function(q){var v=(q.key+"").split("/"),a=v.pop();v=v.pop();if(t.i&&t.i[v])t.i[v]._internals.onStorageChange(a,q.newValue)});Ea.default=t;Object.defineProperty(Ea,"__esModule",{value:!0})});
