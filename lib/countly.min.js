/*
 regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
(function(Wa,rb){"object"===typeof exports&&"undefined"!==typeof module?rb(exports):"function"===typeof define&&define.amd?define(["exports"],rb):(Wa="undefined"!==typeof globalThis?globalThis:Wa||self,rb(Wa.Countly=Wa.Countly||{}))})(this,function(Wa){function rb(p,r,v){if("function"==typeof p?p===r:p.has(r))return 3>arguments.length?r:v;throw new TypeError("Private element is not present on this object");}function qd(p,r,v,a,G,h,t){try{var c=p[h](t),e=c.value}catch(g){return void v(g)}c.done?r(e):
Promise.resolve(e).then(a,G)}function Oc(p){return function(){var r=this,v=arguments;return new Promise(function(a,G){function h(e){qd(c,a,G,h,t,"next",e)}function t(e){qd(c,a,G,h,t,"throw",e)}var c=p.apply(r,v);h(void 0)})}}function b(p,r){return p.get(rb(p,r))}function q(p,r,v){if(r.has(p))throw new TypeError("Cannot initialize the same private elements twice on an object");r.set(p,v)}function l(p,r,v){return p.set(rb(p,r),v),v}function rd(p,r){for(var v=0;v<r.length;v++){var a=r[v];a.enumerable=
a.enumerable||!1;a.configurable=!0;"value"in a&&(a.writable=!0);Object.defineProperty(p,sd(a.key),a)}}function y(p,r,v){return(r=sd(r))in p?Object.defineProperty(p,r,{value:v,enumerable:!0,configurable:!0,writable:!0}):p[r]=v,p}function Xa(){function p(m,u,x,C){u=Object.create((u&&u.prototype instanceof r?u:r).prototype);return la(u,"_invoke",function(F,R,X){function I(A,N){J=A;Z=N;for(k=0;!V&&ha&&!qa&&k<Fa.length;k++){var qa,ma=Fa[k],Pc=aa.p,ec=ma[2];3<A?(qa=ec===N)&&(Z=ma[(J=ma[4])?5:(J=3,3)],ma[4]=
ma[5]=h):ma[0]<=Pc&&((qa=2>A&&Pc<ma[1])?(J=0,aa.v=N,aa.n=ma[1]):Pc<ec&&(qa=3>A||ma[0]>N||N>ec)&&(ma[4]=A,ma[5]=N,aa.n=ec,J=0))}if(qa||1<A)return g;throw V=!0,N;}var S,J,Z,ha=0,Fa=X||[],V=!1,aa={p:0,n:0,v:h,a:I,f:I.bind(h,4),d:function(A,N){return S=A,J=0,Z=h,aa.n=N,g}};return function(A,N,qa){if(1<ha)throw TypeError("Generator is already running");V&&1===N&&I(N,qa);J=N;for(Z=qa;(k=2>J?h:Z)||!V;){S||(J?3>J?(1<J&&(aa.n=-1),I(J,Z)):aa.n=Z:aa.v=Z);try{if(ha=2,S){if(J||(A="next"),k=S[A]){if(!(k=k.call(S,
Z)))throw TypeError("iterator result is not an object");if(!k.done)return k;Z=k.value;2>J&&(J=0)}else 1===J&&(k=S.return)&&k.call(S),2>J&&(Z=TypeError("The iterator does not provide a '"+A+"' method"),J=1);S=h}else if((k=(V=0>aa.n)?Z:F.call(R,aa))!==g)break}catch(ma){S=h,J=1,Z=ma}finally{ha=1}}return{value:k,done:V}}}(m,x,C),!0),u}function r(){}function v(){}function a(){}function G(m){return Object.setPrototypeOf?Object.setPrototypeOf(m,a):(m.__proto__=a,la(m,e,"GeneratorFunction")),m.prototype=
Object.create(n),m}var h,t="function"==typeof Symbol?Symbol:{},c=t.iterator||"@@iterator",e=t.toStringTag||"@@toStringTag",g={};var k=Object.getPrototypeOf;t=[][c]?k(k([][c]())):(la(k={},c,function(){return this}),k);var n=a.prototype=r.prototype=Object.create(t);return v.prototype=a,la(n,"constructor",a),la(a,"constructor",v),v.displayName="GeneratorFunction",la(a,e,"GeneratorFunction"),la(n),la(n,e,"Generator"),la(n,c,function(){return this}),la(n,"toString",function(){return"[object Generator]"}),
(Xa=function(){return{w:p,m:G}})()}function la(p,r,v,a){var G=Object.defineProperty;try{G({},"",{})}catch(h){G=0}la=function(h,t,c,e){function g(k,n){la(h,k,function(m){return this._invoke(k,n,m)})}t?G?G(h,t,{value:c,enumerable:!e,configurable:!e,writable:!e}):h[t]=c:(g("next",0),g("throw",1),g("return",2))};la(p,r,v,a)}function sd(p){a:if("object"==typeof p&&p){var r=p[Symbol.toPrimitive];if(void 0!==r){p=r.call(p,"string");if("object"!=typeof p)break a;throw new TypeError("@@toPrimitive must return a primitive value.");
}p=String(p)}return"symbol"==typeof p?p:p+""}function W(p){"@babel/helpers - typeof";return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},W(p)}function td(p){var r=[];if("undefined"!==typeof p.options)for(var v=0;v<p.options.length;v++)p.options[v].selected&&r.push(p.options[v].value);return r.join(", ")}function Qc(){var p=ud("xxxxxxxx","[x]");
var r=Date.now().toString();return p+r}function Rc(){return ud("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx","[xy]")}function ud(p,r){var v=(new Date).getTime();return p.replace(new RegExp(r,"g"),function(a){var G=(v+16*Math.random())%16|0;return("x"===a?G:G&3|8).toString(16)})}function L(){return Math.floor((new Date).getTime()/1E3)}function sb(){var p=(new Date).getTime();fc>=p?fc++:fc=p;return fc}function z(p,r,v){if(r&&Object.keys(r).length){if("undefined"!==typeof r[p])return r[p]}else if("undefined"!==
typeof w[p])return w[p];return v}function Sc(p,r,v){for(var a in w.i)w.i[a].tracking_crashes&&w.i[a].recordError(p,r,v)}function Tc(p,r){for(var v=[],a=Object.keys(p||{}).sort(),G=0;G<a.length;G++){var h=a[G];v.push(h+"="+encodeURIComponent(p[h]))}var t=v.join("&");return r?vd(t,r).then(function(c){return t+="&checksum256="+c.toUpperCase()}):Promise.resolve(t)}function Ya(p){return"string"===typeof p&&"/"===p.substring(p.length-1)?p.substring(0,p.length-1):p}function Nb(p,r){for(var v={},a,G=0,h=
r.length;G<h;G++)a=r[G],"undefined"!==typeof p[a]&&(v[a]=p[a]);return v}function Ga(p,r,v,a,G,h){var t={};if(p){if(Object.keys(p).length>a){var c={},e=0,g;for(g in p)e<a&&(c[g]=p[g],e++);p=c}for(var k in p)a=H(k,r,G,h),c=H(p[k],v,G,h),t[a]=c}return t}function H(p,r,v,a){var G=p;"number"===typeof p&&(p=p.toString());"string"===typeof p&&p.length>r&&(G=p.substring(0,r),a(f.DEBUG,v+", Key: [ "+p+" ] is longer than accepted length. It will be truncated."));return G}function vd(p,r){p=(new TextEncoder).encode(p+
r);return crypto.subtle.digest("SHA-256",p).then(function(v){return Array.from(new Uint8Array(v)).map(function(a){return a.toString(16).padStart(2,"0")}).join("").toUpperCase()})}function M(p,r,v){D&&(null===p||"undefined"===typeof p?gc()&&console.warn("[WARNING] [Countly] add_event_listener, Can't bind ["+r+"] event to nonexisting element"):"undefined"!==typeof p.addEventListener?p.addEventListener(r,v,!1):p.attachEvent("on"+r,v))}function hc(p){return p?"undefined"!==typeof p.target?p.target:p.srcElement:
window.event.srcElement}function tb(p){if(p)return p;(p=navigator.userAgent)||(p=Uc());return p}function Uc(p){if(p)return p;p="";navigator.userAgentData&&(p=navigator.userAgentData.brands.map(function(r){return r.brand+":"+r.version}).join(),p+=navigator.userAgentData.mobile?" mobi ":" ",p+=navigator.userAgentData.platform);return p}function Vc(p){if(!p){if(navigator.userAgentData&&navigator.userAgentData.mobile)return"phone";p=tb()}p=p.toLowerCase();var r="desktop",v=/(mobi|ipod|phone|blackberry|opera mini|fennec|minimo|symbian|psp|nintendo ds|archos|skyfire|puffin|blazer|bolt|gobrowser|iris|maemo|semc|teashark|uzard)/;
/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(p)?r="tablet":v.test(p)&&(r="phone");return r}function wd(p){var r=/(CountlySiteBot|nuhk|Googlebot|GoogleSecurityScanner|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver|bingbot|Google Web Preview|Mediapartners-Google|AdsBot-Google|Baiduspider|Ezooms|YahooSeeker|AltaVista|AVSearch|Mercator|Scooter|InfoSeek|Ultraseek|Lycos|Wget|YandexBot|Yandex|YaDirectFetcher|SiteBot|Exabot|AhrefsBot|MJ12bot|TurnitinBot|magpie-crawler|Nutch Crawler|CMS Crawler|rogerbot|Domnutch|ssearch_bot|XoviBot|netseer|digincore|fr-crawler|wesee|AliasIO|contxbot|PingdomBot|BingPreview|HeadlessChrome|Lighthouse)/;
if(p)return r.test(p);p=r.test(tb());r=r.test(Uc());return p||r}function Wc(p){"undefined"===typeof p.pageY&&"number"===typeof p.clientX&&document.documentElement&&(p.pageX=p.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,p.pageY=p.clientY+document.body.scrollTop+document.documentElement.scrollTop);return p}function ic(){var p=document;return Math.max(Math.max(p.body.scrollHeight,p.documentElement.scrollHeight),Math.max(p.body.offsetHeight,p.documentElement.offsetHeight),Math.max(p.body.clientHeight,
p.documentElement.clientHeight))}function Xc(){var p=document;return Math.max(Math.max(p.body.scrollWidth,p.documentElement.scrollWidth),Math.max(p.body.offsetWidth,p.documentElement.offsetWidth),Math.max(p.body.clientWidth,p.documentElement.clientWidth))}function xd(){var p=document;return Math.min(Math.min(p.body.clientHeight,p.documentElement.clientHeight),Math.min(p.body.offsetHeight,p.documentElement.offsetHeight),window.innerHeight)}function yd(p,r,v,a,G,h){p=document.createElement(p);var t;
p.setAttribute(r,v);p.setAttribute(a,G);r=function(){t||h();t=!0};h&&(p.onreadystatechange=r,p.onload=r);document.getElementsByTagName("head")[0].appendChild(p)}function zd(p,r){yd("script","type","text/javascript","src",p,r)}function jc(p,r){yd("link","rel","stylesheet","href",p,r)}function Ad(){if(D){var p=document.getElementById("cly-loader");if(!p){var r=document.head||document.getElementsByTagName("head")[0],v=document.createElement("style");v.type="text/css";v.styleSheet?v.styleSheet.cssText=
"#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}":v.appendChild(document.createTextNode("#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}"));
r.appendChild(v);p=document.createElement("div");p.setAttribute("id","cly-loader");window.addEventListener("load",function(){if(w.showLoaderProtection)gc()&&console.warn("[WARNING] [Countly] showLoader, Loader is already on");else try{document.body.appendChild(p)}catch(a){gc()&&console.error("[ERROR] [Countly] showLoader, Body is not loaded for loader to append: "+a)}})}p.style.display="block"}}function gc(){return w&&w.debug&&"undefined"!==typeof console?!0:!1}function Bd(){if(D){w.showLoaderProtection=
!0;var p=document.getElementById("cly-loader");p&&(p.style.display="none")}}function he(p){var r=document.createElement("script"),v=document.createElement("script");r.async=!0;v.async=!0;r.src=w.customSourceBoomerang||Cd.BOOMERANG_SRC;v.src=w.customSourceCountlyBoomerang||Cd.CLY_BOOMERANG_SRC;document.getElementsByTagName("head")[0].appendChild(r);document.getElementsByTagName("head")[0].appendChild(v);var a=!1,G=!1;r.onload=function(){a=!0};v.onload=function(){G=!0};var h=0,t=setInterval(function(){h+=
50;if(a&&G||1500<=h){if(w.debug){var c="BoomerangJS loaded:["+a+"], countly_boomerang loaded:["+G+"].";a&&G?console.log("[DEBUG] "+c):console.warn("[WARNING] "+c+" Initializing without APM.")}w.init(p);clearInterval(t)}},50)}var ca={NPS:"[CLY]_nps",SURVEY:"[CLY]_survey",STAR_RATING:"[CLY]_star_rating",VIEW:"[CLY]_view",ORIENTATION:"[CLY]_orientation",ACTION:"[CLY]_action"},ie=Object.values(ca),f={ERROR:"[ERROR] ",WARNING:"[WARNING] ",INFO:"[INFO] ",DEBUG:"[DEBUG] ",VERBOSE:"[VERBOSE] "},Cd={BOOMERANG_SRC:"https://cdn.jsdelivr.net/npm/countly-sdk-web@latest/plugin/boomerang/boomerang.min.js",
CLY_BOOMERANG_SRC:"https://cdn.jsdelivr.net/npm/countly-sdk-web@latest/plugin/boomerang/countly_boomerang.js"},ba=Object.freeze({errorCount:"cly_hc_error_count",warningCount:"cly_hc_warning_count",statusCode:"cly_hc_status_code",errorMessage:"cly_hc_error_message",backoffCount:"cly_hc_backoff_count",consecutiveBackoffCount:"cly_hc_consecutive_backoff_count"}),Dd=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?::([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?::([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,
D="undefined"!==typeof window,w=globalThis.Countly||{},fc=0,Ob=new WeakMap,Ed=new WeakMap,ub=new WeakMap,na=new WeakMap,Pb=new WeakMap,Za=new WeakMap,vb=new WeakMap,K=new WeakMap,Y=new WeakMap,ea=new WeakMap,Ha=new WeakMap,ra=new WeakMap,sa=new WeakMap,Qb=new WeakMap,$a=new WeakMap,ya=new WeakMap,Rb=new WeakMap,ia=new WeakMap,ab=new WeakMap,bb=new WeakMap,Pa=new WeakMap,wb=new WeakMap,cb=new WeakMap,Qa=new WeakMap,za=new WeakMap,db=new WeakMap,Ia=new WeakMap,xb=new WeakMap,T=new WeakMap,ta=new WeakMap,
Ja=new WeakMap,kc=new WeakMap,Ka=new WeakMap,Ra=new WeakMap,P=new WeakMap,eb=new WeakMap,fb=new WeakMap,Sb=new WeakMap,La=new WeakMap,yb=new WeakMap,Aa=new WeakMap,Ba=new WeakMap,ua=new WeakMap,Tb=new WeakMap,U=new WeakMap,Ub=new WeakMap,Yc=new WeakMap,gb=new WeakMap,zb=new WeakMap,hb=new WeakMap,Ab=new WeakMap,Ma=new WeakMap,lc=new WeakMap,Ca=new WeakMap,Sa=new WeakMap,ib=new WeakMap,Bb=new WeakMap,mc=new WeakMap,Cb=new WeakMap,Db=new WeakMap,Vb=new WeakMap,Wb=new WeakMap,nc=new WeakMap,oc=new WeakMap,
Eb=new WeakMap,jb=new WeakMap,pc=new WeakMap,Q=new WeakMap,O=new WeakMap,ja=new WeakMap,kb=new WeakMap,Na=new WeakMap,Oa=new WeakMap,qc=new WeakMap,rc=new WeakMap,sc=new WeakMap,tc=new WeakMap,uc=new WeakMap,Fb=new WeakMap,Gb=new WeakMap,Hb=new WeakMap,Ib=new WeakMap,Jb=new WeakMap,Kb=new WeakMap,vc=new WeakMap,wc=new WeakMap,Lb=new WeakMap,xc=new WeakMap,yc=new WeakMap,Zc=new WeakMap,lb=new WeakMap,Ta=new WeakMap,Da=new WeakMap,Xb=new WeakMap,Yb=new WeakMap,Zb=new WeakMap,zc=new WeakMap,$b=new WeakMap,
ac=new WeakMap,mb=new WeakMap,nb=new WeakMap,Ua=new WeakMap,ob=new WeakMap,Ac=new WeakMap,Bc=new WeakMap,Fd=new WeakMap,$c=new WeakMap,oa=new WeakMap,Gd=new WeakMap,Hd=new WeakMap,Mb=new WeakMap,ad=new WeakMap,Id=new WeakMap,bd=new WeakMap,Jd=new WeakMap,Kd=new WeakMap,Ld=new WeakMap,Cc=new WeakMap,Md=new WeakMap,cd=new WeakMap,fa=new WeakMap,Ea=new WeakMap,dd=new WeakMap,ed=new WeakMap,Dc=new WeakMap,Ec=new WeakMap,Nd=new WeakMap,fd=new WeakMap,Va=new WeakMap,Od=new WeakMap,Fc=new WeakMap,Pd=new WeakMap,
Gc=new WeakMap,Qd=new WeakMap,Rd=new WeakMap,bc=new WeakMap,va=new WeakMap,Hc=new WeakMap,gd=new WeakMap,Ic=new WeakMap,Sd=new WeakMap,hd=new WeakMap,pb=new WeakMap,da=new WeakMap,cc=new WeakMap,Td=new WeakMap,Ud=new WeakMap,id=new WeakMap,wa=new WeakMap,Jc=new WeakMap,Vd=new WeakMap,jd=new WeakMap,dc=new WeakMap,qb=new WeakMap,Kc=new WeakMap,d=new WeakMap,pa=new WeakMap,kd=new WeakMap,Wd=new WeakMap,ld=new WeakMap,md=new WeakMap,Lc=new WeakMap,Mc=new WeakMap,nd=new WeakMap,Nc=new WeakMap,Xd=new WeakMap,
od=new WeakMap,Yd=new WeakMap,Zd=new WeakMap,$d=new WeakMap,ae=new WeakMap,pd=new WeakMap,E=new WeakMap,B=new WeakMap,ka=new WeakMap,be=new WeakMap,ce=new WeakMap,de=new WeakMap,ee=new WeakMap,xa=new WeakMap,fe=function(p,r,v){return r&&rd(p.prototype,r),v&&rd(p,v),Object.defineProperty(p,"prototype",{writable:!1}),p}(function v(r){var a=this;if(!(this instanceof v))throw new TypeError("Cannot call a class as a function");q(this,Ob,void 0);q(this,Ed,void 0);q(this,ub,void 0);q(this,na,void 0);q(this,
Pb,void 0);q(this,Za,void 0);q(this,vb,void 0);q(this,K,void 0);q(this,Y,void 0);q(this,ea,void 0);q(this,Ha,void 0);q(this,ra,void 0);q(this,sa,void 0);q(this,Qb,void 0);q(this,$a,void 0);q(this,ya,void 0);q(this,Rb,void 0);q(this,ia,void 0);q(this,ab,void 0);q(this,bb,void 0);q(this,Pa,void 0);q(this,wb,void 0);q(this,cb,void 0);q(this,Qa,void 0);q(this,za,void 0);q(this,db,void 0);q(this,Ia,void 0);q(this,xb,void 0);q(this,T,void 0);q(this,ta,void 0);q(this,Ja,void 0);q(this,kc,void 0);q(this,
Ka,void 0);q(this,Ra,void 0);q(this,P,void 0);q(this,eb,void 0);q(this,fb,void 0);q(this,Sb,void 0);q(this,La,void 0);q(this,yb,void 0);q(this,Aa,void 0);q(this,Ba,void 0);q(this,ua,void 0);q(this,Tb,void 0);q(this,U,void 0);q(this,Ub,void 0);q(this,Yc,void 0);q(this,gb,void 0);q(this,zb,void 0);q(this,hb,void 0);q(this,Ab,void 0);q(this,Ma,void 0);q(this,lc,void 0);q(this,Ca,void 0);q(this,Sa,void 0);q(this,ib,void 0);q(this,Bb,void 0);q(this,mc,void 0);q(this,Cb,void 0);q(this,Db,void 0);q(this,
Vb,void 0);q(this,Wb,void 0);q(this,nc,void 0);q(this,oc,void 0);q(this,Eb,void 0);q(this,jb,void 0);q(this,pc,void 0);q(this,Q,void 0);q(this,O,void 0);q(this,ja,void 0);q(this,kb,void 0);q(this,Na,void 0);q(this,Oa,void 0);q(this,qc,void 0);q(this,rc,void 0);q(this,sc,void 0);q(this,tc,void 0);q(this,uc,void 0);q(this,Fb,void 0);q(this,Gb,void 0);q(this,Hb,void 0);q(this,Ib,void 0);q(this,Jb,void 0);q(this,Kb,void 0);q(this,vc,void 0);q(this,wc,void 0);q(this,Lb,void 0);q(this,xc,void 0);q(this,
yc,void 0);q(this,Zc,void 0);q(this,lb,void 0);q(this,Ta,void 0);q(this,Da,void 0);q(this,Xb,void 0);q(this,Yb,void 0);q(this,Zb,void 0);q(this,zc,void 0);q(this,$b,void 0);q(this,ac,void 0);q(this,mb,void 0);q(this,nb,void 0);q(this,Ua,void 0);q(this,ob,void 0);q(this,Ac,function(){if("[CLY]_temp_id"===a.device_id)b(d,a).call(a,f.INFO,"server_config, Device ID is temporary, not fetching server config");else if(b(Zc,a))b(d,a).call(a,f.INFO,"server_config, SDK behavior sync is disabled, not fetching server config");
else{b(d,a).call(a,f.INFO,"server_config, Fetching server config");var h={};h.app_key=a.app_key;h.device_id=a.device_id;h.sdk_version=b(ua,a);h.sdk_name=b(Ba,a);h.t=b(P,a);h.timestamp=sb();var t=new Date;h.hour=t.getHours();h.dow=t.getDay();h.av=a.app_version;h.method="sc";b(pa,a).call(a,"server_config",a.url+b(Za,a),h,function(c,e,g){if(!c)try{var k=JSON.parse(g);b(d,a).call(a,f.INFO,"server_config, Config fetched successfully:["+JSON.stringify(k)+"]");k&&b(Bc,a).call(a,k);b(B,a).call(a,"cly_config",
JSON.stringify(k))}catch(n){b(d,a).call(a,f.ERROR,"server_config, Had an issue while parsing the response: "+n)}},!0,!0);setTimeout(function(){b(Ac,a).call(a)},36E5*b(mc,a))}});q(this,Bc,function(h){h&&h.c&&"object"===W(h.c)&&(h=h.c,h.hasOwnProperty("networking")&&l(lc,a,h.networking),h.hasOwnProperty("tracking")&&l(Cb,a,h.tracking),h.hasOwnProperty("rqs")&&l(Ca,a,h.rqs),h.hasOwnProperty("eqs")&&l(Sa,a,h.eqs),h.hasOwnProperty("sui")&&l(ib,a,h.sui),h.hasOwnProperty("czi")&&14<h.czi&&l(Bb,a,1E3*h.czi),
h.hasOwnProperty("ecz")&&(l(Eb,a,h.ecz),!b(xc,a)&&b(Eb,a)&&b(Va,a).call(a)),h.hasOwnProperty("cr")&&l(jb,a,h.cr),h.hasOwnProperty("st")&&l(Db,a,h.st),h.hasOwnProperty("crt")&&l(Wb,a,h.crt),h.hasOwnProperty("vt")&&l(Vb,a,h.vt),h.hasOwnProperty("cet")&&l(nc,a,h.cet),h.hasOwnProperty("lkl")&&l(Q,a,h.lkl),h.hasOwnProperty("lvs")&&l(O,a,h.lvs),h.hasOwnProperty("lsv")&&l(ja,a,h.lsv),h.hasOwnProperty("lbc")&&l(kb,a,h.lbc),h.hasOwnProperty("ltlpt")&&l(Na,a,h.ltlpt),h.hasOwnProperty("ltl")&&l(Oa,a,h.ltl),
h.hasOwnProperty("scui")&&l(mc,a,Math.max(h.scui,4)),h.hasOwnProperty("lt")&&l(oc,a,h.lt),h.hasOwnProperty("rcz")&&l(pc,a,h.rcz),h.hasOwnProperty("bom")&&l(qc,a,h.bom),h.hasOwnProperty("bom_at")&&l(rc,a,h.bom_at),h.hasOwnProperty("bom_rqp")&&l(sc,a,h.bom_rqp),h.hasOwnProperty("bom_ra")&&l(tc,a,h.bom_ra),h.hasOwnProperty("bom_d")&&l(uc,a,h.bom_d),h.hasOwnProperty("eb")&&Array.isArray(h.eb)&&l(Fb,a,h.eb),h.hasOwnProperty("ew")&&Array.isArray(h.ew)&&l(Gb,a,h.ew),h.hasOwnProperty("upb")&&Array.isArray(h.upb)&&
l(Hb,a,h.upb),h.hasOwnProperty("upw")&&Array.isArray(h.upw)&&l(Ib,a,h.upw),h.hasOwnProperty("sb")&&Array.isArray(h.sb)&&l(Jb,a,h.sb),h.hasOwnProperty("sw")&&Array.isArray(h.sw)&&l(Kb,a,h.sw),h.hasOwnProperty("esb")&&h.esb&&"object"===W(h.esb)&&!Array.isArray(h.esb)&&l(vc,a,h.esb),h.hasOwnProperty("esw")&&h.esw&&"object"===W(h.esw)&&!Array.isArray(h.esw)&&l(wc,a,h.esw),h.hasOwnProperty("jte")&&Array.isArray(h.jte)&&l(Lb,a,h.jte))});q(this,Fd,function(h){l(sa,a,z("ignore_referrers",h,[]));l(wb,a,z("fail_timeout",
h,60));l(cb,a,z("inactivity_time",h,20));l(za,a,z("use_session_cookie",h,!0));l(db,a,z("session_cookie_timeout",h,30));l(T,a,z("offline_mode",h,!1));l(Ba,a,z("sdk_name",h,"javascript_native_web"));l(ua,a,z("sdk_version",h,"26.1.0"));l(vb,a,z("interval",h,500));a.getViewName=z("getViewName",h,w.getViewName);a.getViewUrl=z("getViewUrl",h,w.getViewUrl);a.getSearchQuery=z("getSearchQuery",h,w.getSearchQuery);a.DeviceIdType=w.DeviceIdType;a.namespace=z("namespace",h,"");a.clearStoredId=z("clear_stored_id",
h,!1);a.onload=z("onload",h,[]);a.utm=z("utm",h,{source:!0,medium:!0,campaign:!0,term:!0,content:!0});a.ignore_prefetch=z("ignore_prefetch",h,!0);a.rcAutoOptinAb=z("rc_automatic_optin_for_ab",h,!0);a.useExplicitRcApi=z("use_explicit_rc_api",h,!1);a.debug=z("debug",h,!1);a.test_mode=z("test_mode",h,!1);a.test_mode_eq=z("test_mode_eq",h,!1);a.metrics=z("metrics",h,{});a.headers=z("headers",h,{});a.app_version=z("app_version",h,"0.0");a.country_code=z("country_code",h,null);a.city=z("city",h,null);a.ip_address=
z("ip_address",h,null);a.ignore_bots=z("ignore_bots",h,!0);a.force_post=z("force_post",h,!0);a.remote_config=z("remote_config",h,!1);a.ignore_visitor=z("ignore_visitor",h,!1);a.track_domains=D?z("track_domains",h,!0):void 0;a.storage=z("storage",h,"default");a.enableOrientationTracking=D?z("enable_orientation_tracking",h,!0):void 0;a.heatmapWhitelist=z("heatmap_whitelist",h,[]);a.contentWhitelist=z("content_whitelist",h,[]);a.salt=z("salt",h,null);a.hcErrorCount=b(E,a).call(a,ba.errorCount)||0;a.hcWarningCount=
b(E,a).call(a,ba.warningCount)||0;a.hcStatusCode=b(E,a).call(a,ba.statusCode)||-1;a.hcErrorMessage=b(E,a).call(a,ba.errorMessage)||"";a.hcBackoffCount=b(E,a).call(a,ba.backoffCount)||0;a.hcConsecutiveBackoffCount=b(E,a).call(a,ba.consecutiveBackoffCount)||0;l(Yb,a,!1);l(Ab,a,z("crash_filter_callback",h,null));"cookie"===a.storage&&l(Ka,a,!1);a.rcAutoOptinAb||a.useExplicitRcApi||(b(d,a).call(a,f.WARNING,"initialize, Auto opting is disabled, switching to explicit RC API"),a.useExplicitRcApi=!0);Array.isArray(b(sa,
a))||l(sa,a,[]);""===a.url&&(b(d,a).call(a,f.ERROR,"initialize, Please provide server URL"),a.ignore_visitor=!0);b(E,a).call(a,"cly_ignore")&&(a.ignore_visitor=!0);b(fd,a).call(a);if(D)if(window.name&&0===window.name.indexOf("cly:"))try{a.passed_data=JSON.parse(window.name.replace("cly:",""))}catch(x){b(d,a).call(a,f.ERROR,"initialize, Could not parse name: "+window.name+", error: "+x)}else if(location.hash&&0===location.hash.indexOf("this.#cly:"))try{a.passed_data=JSON.parse(location.hash.replace("this.#cly:",
""))}catch(x){b(d,a).call(a,f.ERROR,"initialize, Could not parse hash: "+location.hash+", error: "+x)}Array.isArray(a.contentWhitelist)&&(a.contentWhitelist.push(a.url),a.contentWhitelist=a.contentWhitelist.map(function(x){return Ya(x)}));if((a.passed_data&&a.passed_data.app_key&&a.passed_data.app_key===a.app_key||a.passed_data&&!a.passed_data.app_key&&b(ub,a))&&a.passed_data.token&&a.passed_data.purpose){a.passed_data.token!==b(E,a).call(a,"cly_old_token")&&(b(od,a).call(a,a.passed_data.token),b(B,
a).call(a,"cly_old_token",a.passed_data.token));var t=[];Array.isArray(a.heatmapWhitelist)?(a.heatmapWhitelist.push(a.url),t=a.heatmapWhitelist.map(function(x){return Ya(x)})):t=[a.url];t.includes(a.passed_data.url)&&"heatmap"===a.passed_data.purpose&&(a.ignore_visitor=!0,Ad(),zd(a.passed_data.url+"/views/heatmap.js",Bd))}if(a.ignore_visitor)b(d,a).call(a,f.WARNING,"initialize, ignore_visitor:["+a.ignore_visitor+"], this user will not be tracked");else{b(be,a).call(a);l(K,a,b(E,a).call(a,"cly_queue")||
[]);l(Y,a,b(E,a).call(a,"cly_event")||[]);l(ea,a,b(E,a).call(a,"cly_remote_configs")||{});t="[CLY]_temp_id"===b(E,a).call(a,"cly_id");a.clearStoredId&&(b(E,a).call(a,"cly_id")&&!t&&(a.device_id=b(E,a).call(a,"cly_id"),b(d,a).call(a,f.DEBUG,"initialize, temporarily using the previous device ID to flush existing events"),l(P,a,b(E,a).call(a,"cly_id_type")),b(P,a)||(b(d,a).call(a,f.DEBUG,"initialize, No device ID type info from the previous session, falling back to DEVELOPER_SUPPLIED, for event flushing"),
l(P,a,0)),b(va,a).call(a),a.device_id=void 0,l(P,a,1)),b(d,a).call(a,f.INFO,"initialize, Clearing the device ID storage"),b(ka,a).call(a,"cly_id"),b(ka,a).call(a,"cly_id_type"),b(ka,a).call(a,"cly_session"),t=!1);"javascript_native_web"===b(Ba,a)&&"26.1.0"===b(ua,a)?b(d,a).call(a,f.DEBUG,"initialize, SDK name:["+b(Ba,a)+"], version:["+b(ua,a)+"]"):b(d,a).call(a,f.DEBUG,"initialize, SDK name:["+b(Ba,a)+"], version:["+b(ua,a)+"], default name:[javascript_native_web] and default version:[26.1.0]");b(d,
a).call(a,f.DEBUG,"initialize, stored server config:["+JSON.stringify(b(Ma,a))+"]");b(d,a).call(a,f.DEBUG,"initialize, app_key:["+a.app_key+"], url:["+a.url+"]");b(d,a).call(a,f.DEBUG,"initialize, device_id:["+z("device_id",h,void 0)+"]");b(d,a).call(a,f.DEBUG,"initialize, require_consent is enabled:["+b(jb,a)+"]");try{b(d,a).call(a,f.DEBUG,"initialize, metric override:["+JSON.stringify(a.metrics)+"]"),b(d,a).call(a,f.DEBUG,"initialize, header override:["+JSON.stringify(a.headers)+"]"),b(d,a).call(a,
f.DEBUG,"initialize, number of onload callbacks provided:["+a.onload.length+"]"),b(d,a).call(a,f.DEBUG,"initialize, utm tags:["+JSON.stringify(a.utm)+"]"),b(sa,a)&&b(d,a).call(a,f.DEBUG,"initialize, referrers to ignore :["+JSON.stringify(b(sa,a))+"]"),b(d,a).call(a,f.DEBUG,"initialize, salt given:["+!!a.salt+"]")}catch(x){b(d,a).call(a,f.ERROR,"initialize, Could not stringify some config object values")}b(d,a).call(a,f.DEBUG,"initialize, app_version:["+a.app_version+"]");b(d,a).call(a,f.DEBUG,"initialize, provided location info; country_code:["+
a.country_code+"], city:["+a.city+"], ip_address:["+a.ip_address+"]");""!==a.namespace&&b(d,a).call(a,f.DEBUG,"initialize, namespace given:["+a.namespace+"]");a.clearStoredId&&b(d,a).call(a,f.DEBUG,"initialize, clearStoredId flag set to:["+a.clearStoredId+"]");a.ignore_prefetch&&b(d,a).call(a,f.DEBUG,"initialize, ignoring pre-fetching and pre-rendering from counting as real website visits :["+a.ignore_prefetch+"]");a.test_mode&&b(d,a).call(a,f.WARNING,"initialize, test_mode:["+a.test_mode+"], request queue won't be processed");
a.test_mode_eq&&b(d,a).call(a,f.WARNING,"initialize, test_mode_eq:["+a.test_mode_eq+"], event queue won't be processed");a.heatmapWhitelist&&b(d,a).call(a,f.DEBUG,"initialize, heatmap whitelist:["+JSON.stringify(a.heatmapWhitelist)+"], these domains will be whitelisted");"default"!==a.storage&&b(d,a).call(a,f.DEBUG,"initialize, storage is set to:["+a.storage+"]");a.ignore_bots&&b(d,a).call(a,f.DEBUG,"initialize, ignore traffic from bots :["+a.ignore_bots+"]");a.force_post&&b(d,a).call(a,f.DEBUG,"initialize, forced post method for all requests:["+
a.force_post+"]");a.remote_config&&b(d,a).call(a,f.DEBUG,"initialize, remote_config callback provided:["+!!a.remote_config+"]");"boolean"===typeof a.rcAutoOptinAb&&b(d,a).call(a,f.DEBUG,"initialize, automatic RC optin is enabled:["+a.rcAutoOptinAb+"]");a.useExplicitRcApi||b(d,a).call(a,f.WARNING,"initialize, will use legacy RC API. Consider enabling new API during init with use_explicit_rc_api flag");a.track_domains&&b(d,a).call(a,f.DEBUG,"initialize, tracking domain info:["+a.track_domains+"]");
a.enableOrientationTracking&&b(d,a).call(a,f.DEBUG,"initialize, enableOrientationTracking:["+a.enableOrientationTracking+"]");b(za,a)||b(d,a).call(a,f.WARNING,"initialize, use_session_cookie is enabled:["+b(za,a)+"]");b(T,a)&&b(d,a).call(a,f.DEBUG,"initialize, offline_mode:["+b(T,a)+"], user info won't be send to the servers");b(ea,a)&&b(d,a).call(a,f.DEBUG,"initialize, stored remote configs:["+JSON.stringify(b(ea,a))+"]");b(Bb,a)&&b(d,a).call(a,f.DEBUG,"initialize, content_zone_timer_interval:["+
b(Bb,a)+"]");b(d,a).call(a,f.DEBUG,"initialize, 'getViewName' callback override provided:["+(a.getViewName!==w.getViewName)+"]");b(d,a).call(a,f.DEBUG,"initialize, 'getSearchQuery' callback override provided:["+(a.getSearchQuery!==w.getSearchQuery)+"]");128!==b(Q,a)&&b(d,a).call(a,f.DEBUG,"initialize, maxKeyLength set to:["+b(Q,a)+"] characters");256!==b(O,a)&&b(d,a).call(a,f.DEBUG,"initialize, maxValueSize set to:["+b(O,a)+"] characters");100!==b(ja,a)&&b(d,a).call(a,f.DEBUG,"initialize, maxSegmentationValues set to:["+
b(ja,a)+"] key/value pairs");100!==b(kb,a)&&b(d,a).call(a,f.DEBUG,"initialize, maxBreadcrumbCount for custom logs set to:["+b(kb,a)+"] entries");30!==b(Na,a)&&b(d,a).call(a,f.DEBUG,"initialize, maxStackTraceLinesPerThread set to:["+b(Na,a)+"] lines");200!==b(Oa,a)&&b(d,a).call(a,f.DEBUG,"initialize, maxStackTraceLineLength set to:["+b(Oa,a)+"] characters");500!==b(vb,a)&&b(d,a).call(a,f.DEBUG,"initialize, interval for heartbeats set to:["+b(vb,a)+"] milliseconds");1E3!==b(Ca,a)&&b(d,a).call(a,f.DEBUG,
"initialize, queue_size set to:["+b(Ca,a)+"] items max");60!==b(wb,a)&&b(d,a).call(a,f.DEBUG,"initialize, fail_timeout set to:["+b(wb,a)+"] seconds of wait time after a failed connection to server");20!==b(cb,a)&&b(d,a).call(a,f.DEBUG,"initialize, inactivity_time set to:["+b(cb,a)+"] minutes to consider a user as inactive after no observable action");60!==b(ib,a)&&b(d,a).call(a,f.DEBUG,"initialize, session_update set to:["+b(ib,a)+"] seconds to check if extending a session is needed while the user is active");
100!==b(Sa,a)&&b(d,a).call(a,f.DEBUG,"initialize, max_events set to:["+b(Sa,a)+"] events to send in one batch");30!==b(db,a)&&b(d,a).call(a,f.DEBUG,"initialize, session_cookie_timeout set to:["+b(db,a)+"] minutes to expire a cookies session");var c=null,e=a.getSearchQuery(),g=!1,k={};if(e){0===e.indexOf("?")&&(e=e.substring(1));e=e.split("&");for(var n=0;n<e.length;n++){var m=e[n].split("=");"cly_id"===m[0]?b(B,a).call(a,"cly_cmp_id",m[1]):"cly_uid"===m[0]?b(B,a).call(a,"cly_cmp_uid",m[1]):"cly_device_id"===
m[0]?c=m[1]:0===(m[0]+"").indexOf("utm_")&&a.utm[m[0].replace("utm_","")]&&(k[m[0].replace("utm_","")]=m[1],g=!0)}}e=z("device_id",h,void 0);"number"===typeof e&&(e=e.toString());b(E,a).call(a,"cly_id")&&!t?(a.device_id=b(E,a).call(a,"cly_id"),b(d,a).call(a,f.INFO,"initialize, Set the stored device ID"),l(P,a,b(E,a).call(a,"cly_id_type")),b(P,a)||(b(d,a).call(a,f.INFO,"initialize, No device ID type info from the previous session, falling back to DEVELOPER_SUPPLIED"),l(P,a,0)),l(T,a,!1)):null!==c?
(b(d,a).call(a,f.INFO,"initialize, Device ID set by URL"),a.device_id=c,l(P,a,3),l(T,a,!1)):e?(b(d,a).call(a,f.INFO,"initialize, Device ID set by developer"),a.device_id=e,h&&Object.keys(h).length?void 0!==h.device_id&&l(P,a,0):void 0!==w.device_id&&l(P,a,0),l(T,a,!1)):b(T,a)||t?(a.device_id="[CLY]_temp_id",l(P,a,2),b(T,a)&&t?b(d,a).call(a,f.INFO,"initialize, Temp ID set, continuing offline mode from previous app session"):b(T,a)&&!t?b(d,a).call(a,f.INFO,"initialize, Temp ID set, entering offline mode"):
(l(T,a,!0),b(d,a).call(a,f.INFO,"initialize, Temp ID set, enabling offline mode"))):(b(d,a).call(a,f.INFO,"initialize, Generating the device ID"),a.device_id=z("device_id",h,b(Jc,a).call(a)),h&&Object.keys(h).length?void 0!==h.device_id&&l(P,a,0):void 0!==w.device_id&&l(P,a,0));b(B,a).call(a,"cly_id",a.device_id);b(B,a).call(a,"cly_id_type",b(P,a));if(g){l(Aa,a,{});for(var u in a.utm)k[u]?(a.userData.set("utm_"+u,k[u]),b(Aa,a)[u]=k[u]):a.userData.unset("utm_"+u);a.userData.save()}b(Ac,a).call(a)}});
q(this,$c,function(){b(Ob,a)&&(clearTimeout(b(Ob,a)),l(Ob,a,null));l(Ob,a,setTimeout(function(){for(var h={},t=0;t<w.features.length;t++)!0===b(U,a)[w.features[t]].optin?h[w.features[t]]=!0:h[w.features[t]]=!1;b(da,a).call(a,{consent:JSON.stringify(h)});b(d,a).call(a,f.DEBUG,"Consent update request has been sent to the queue.")},1E3))});y(this,"halt",function(){b(d,a).call(a,f.WARNING,"halt, Resetting Countly");w.i=void 0;w.q=[];w.noHeartBeat=void 0;l(ub,a,!w.i);l(na,a,!1);l(Pb,a,"/i");l(Za,a,"/o/sdk");
l(vb,a,500);l(Ca,a,1E3);l(K,a,[]);l(Y,a,[]);l(ea,a,{});l(Ha,a,[]);l(ra,a,{});l(sa,a,[]);l(Qb,a,null);l($a,a,!0);l(Rb,a,0);l(ia,a,null);l(ab,a,0);l(bb,a,0);l(Pa,a,0);l(wb,a,60);l(cb,a,20);l(Qa,a,0);l(ib,a,60);l(Sa,a,100);l(za,a,!0);l(db,a,30);l(Ia,a,!0);l(xb,a,!1);l(T,a,!1);l(ta,a,{});l(Ja,a,!0);l(kc,a,L());l(Ka,a,!0);l(Ra,a,null);l(P,a,1);l(eb,a,!1);l(fb,a,0);l(Sb,a,!1);l(La,a,null);l(yb,a,null);l(Aa,a,null);l(Ub,a,[]);try{localStorage.setItem("cly_testLocal",!0),localStorage.removeItem("cly_testLocal"),
localStorage.removeItem("cly_old_token"),localStorage.removeItem("cly_cmp_id"),localStorage.removeItem("cly_cmp_uid"),localStorage.removeItem("cly_id"),localStorage.removeItem("cly_id_type"),localStorage.removeItem("cly_queue"),localStorage.removeItem("cly_session"),localStorage.removeItem("cly_remote_configs"),localStorage.removeItem("cly_event"),localStorage.removeItem("cly_ignore"),localStorage.removeItem("cly_fb_widgets"),localStorage.removeItem("cly_token"),localStorage.removeItem("cly_hc_error_count"),
localStorage.removeItem("cly_hc_warning_count"),localStorage.removeItem("cly_hc_status_code"),localStorage.removeItem("cly_hc_error_message"),localStorage.removeItem("cly_hc_backoff_count"),localStorage.removeItem("cly_hc_consecutive_backoff_count")}catch(t){b(d,a).call(a,f.ERROR,"halt, Local storage test failed, will fallback to cookies"),l(Ka,a,!1)}w.features="sessions events views scrolls clicks forms crashes attribution users star-rating location apm feedback remote-config".split(" ");l(U,a,{});
for(var h=0;h<w.features.length;h++)b(U,a)[w.features[h]]={};a.app_key=void 0;a.device_id=void 0;a.onload=void 0;a.utm=void 0;a.ignore_prefetch=void 0;a.debug=void 0;a.test_mode=void 0;a.test_mode_eq=void 0;a.metrics=void 0;a.headers=void 0;a.url=void 0;a.app_version=void 0;a.country_code=void 0;a.city=void 0;a.ip_address=void 0;a.ignore_bots=void 0;a.force_post=void 0;a.rcAutoOptinAb=void 0;a.useExplicitRcApi=void 0;a.remote_config=void 0;a.ignore_visitor=void 0;l(jb,a,void 0);a.track_domains=void 0;
a.storage=void 0;a.enableOrientationTracking=void 0;a.salt=void 0;l(Q,a,void 0);l(O,a,void 0);l(ja,a,void 0);l(kb,a,void 0);l(Na,a,void 0);l(Oa,a,void 0);l(ob,a,void 0);l(mb,a,void 0);l(nb,a,void 0);l(Ua,a,void 0)});y(this,"sdk_version",function(){return b(ua,a)});y(this,"sdk_name",function(){return b(Ba,a)});y(this,"group_features",function(h){b(d,a).call(a,f.INFO,"group_features, Grouping features");if(h)for(var t in h)b(U,a)[t]?b(d,a).call(a,f.WARNING,"group_features, Feature name ["+t+"] is already reserved"):
"string"===typeof h[t]?b(U,a)[t]={features:[h[t]]}:h[t]&&Array.isArray(h[t])&&h[t].length?b(U,a)[t]={features:h[t]}:b(d,a).call(a,f.ERROR,"group_features, Incorrect feature list for ["+t+"] value: ["+h[t]+"]");else b(d,a).call(a,f.ERROR,"group_features, Incorrect features:["+h+"]")});y(this,"check_consent",function(h){b(d,a).call(a,f.INFO,"check_consent, Checking if consent is given for specific feature:["+h+"]");if(!b(jb,a))return b(d,a).call(a,f.INFO,"check_consent, require_consent is off, no consent is necessary"),
!0;if(b(U,a)[h])return!(!b(U,a)[h]||!b(U,a)[h].optin);b(d,a).call(a,f.ERROR,"check_consent, No feature available for ["+h+"]");return!1});y(this,"get_device_id_type",function(){b(d,a).call(a,f.INFO,"check_device_id_type, Retrieving the current device id type.["+b(P,a)+"]");switch(b(P,a)){case 1:var h=a.DeviceIdType.SDK_GENERATED;break;case 3:case 0:h=a.DeviceIdType.DEVELOPER_SUPPLIED;break;case 2:h=a.DeviceIdType.TEMPORARY_ID;break;default:h=-1}return h});y(this,"get_device_id",function(){b(d,a).call(a,
f.INFO,"get_device_id, Retrieving the device id: ["+a.device_id+"]");return a.device_id});y(this,"check_any_consent",function(){b(d,a).call(a,f.INFO,"check_any_consent, Checking if any consent is given");if(!b(jb,a))return b(d,a).call(a,f.INFO,"check_any_consent, require_consent is off, no consent is necessary"),!0;for(var h in b(U,a))if(b(U,a)[h]&&b(U,a)[h].optin)return!0;b(d,a).call(a,f.INFO,"check_any_consent, No consents given");return!1});y(this,"add_consent",function(h){b(d,a).call(a,f.INFO,
"add_consent, Adding consent for ["+h+"]");if(Array.isArray(h))for(var t=0;t<h.length;t++)a.add_consent(h[t]);else b(U,a)[h]?b(U,a)[h].features?(b(U,a)[h].optin=!0,a.add_consent(b(U,a)[h].features)):!0!==b(U,a)[h].optin&&(b(U,a)[h].optin=!0,b($c,a).call(a),setTimeout(function(){"sessions"===h&&b(ta,a).begin_session?(a.begin_session.apply(a,b(ta,a).begin_session),b(ta,a).begin_session=null):"views"===h&&b(ta,a).track_pageview&&(l(ia,a,null),a.track_pageview.apply(a,b(ta,a).track_pageview),b(ta,a).track_pageview=
null)},1)):b(d,a).call(a,f.ERROR,"add_consent, No feature available for ["+h+"]")});y(this,"remove_consent",function(h){b(d,a).call(a,f.INFO,"remove_consent, Removing consent for ["+h+"]");a.remove_consent_internal(h,!0)});y(this,"remove_consent_internal",function(h,t){t=t||!1;if(Array.isArray(h))for(var c=0;c<h.length;c++)a.remove_consent_internal(h[c],t);else b(U,a)[h]?b(U,a)[h].features?a.remove_consent_internal(b(U,a)[h].features,t):(b(U,a)[h].optin=!1,t&&!1!==b(U,a)[h].optin&&b($c,a).call(a)):
b(d,a).call(a,f.WARNING,"remove_consent, No feature available for ["+h+"]")});y(this,"enable_offline_mode",function(){b(T,a)?b(d,a).call(a,f.WARNING,"enable_offline_mode, Countly is already in offline mode."):(b(d,a).call(a,f.INFO,"enable_offline_mode, Enabling offline mode"),a.remove_consent_internal(w.features,!1),l(T,a,!0),b(Fc,a).call(a),a.device_id="[CLY]_temp_id",l(P,a,2))});y(this,"disable_offline_mode",function(h){if(b(T,a)){b(d,a).call(a,f.INFO,"disable_offline_mode, Disabling offline mode");
l(T,a,!1);h&&a.device_id!==h?(a.device_id=h,l(P,a,0),b(B,a).call(a,"cly_id",a.device_id),b(B,a).call(a,"cly_id_type",0),b(d,a).call(a,f.INFO,"disable_offline_mode, Changing id to: "+a.device_id)):(a.device_id=b(Jc,a).call(a),"[CLY]_temp_id"===a.device_id&&(a.device_id=Rc()),a.device_id!==b(E,a).call(a,"cly_id")&&(b(B,a).call(a,"cly_id",a.device_id),b(B,a).call(a,"cly_id_type",1)));h=!1;if(0<b(K,a).length)for(var t=0;t<b(K,a).length;t++)"[CLY]_temp_id"===b(K,a)[t].device_id&&(b(K,a)[t].device_id=a.device_id,
b(K,a)[t].t=b(P,a),h=!0);h&&b(B,a).call(a,"cly_queue",b(K,a),!0);b(Tb,a)&&(b(xa,a).sendInstantHCRequest(),l(Tb,a,!1));b(Ac,a).call(a);b(Eb,a)&&(b(Va,a).call(a),l(xc,a,!0))}else b(d,a).call(a,f.WARNING,"disable_offline_mode, Countly was not in offline mode.")});y(this,"begin_session",function(h,t){if(b(Db,a))if(b(d,a).call(a,f.INFO,"begin_session, Starting the session. There was an ongoing session: ["+b(na,a)+"]"),h&&b(d,a).call(a,f.INFO,"begin_session, Heartbeats are disabled"),t&&b(d,a).call(a,f.INFO,
"begin_session, Session starts irrespective of session cookie"),a.check_consent("sessions")){if(!b(na,a)){if(a.enableOrientationTracking){b(cd,a).call(a);var c;M(window,"resize",function(){clearTimeout(c);c=setTimeout(function(){b(cd,a).call(a)},200)})}l(ya,a,L());l(na,a,!0);l($a,a,!h);h=b(E,a).call(a,"cly_session");b(d,a).call(a,f.VERBOSE,"begin_session, Session state, forced: ["+t+"], useSessionCookie: ["+b(za,a)+"], seconds to expire: ["+(h-b(ya,a))+"], expired: ["+(parseInt(h)<=L())+"] ");if(t||
!b(za,a)||!h||parseInt(h)<=L())b(d,a).call(a,f.INFO,"begin_session, Session started"),null===b(Ra,a)&&l(Ra,a,!0),t={begin_session:1},t.metrics=JSON.stringify(b(dc,a).call(a)),a.userData.save(!0),b(da,a).call(a,t);b(B,a).call(a,"cly_session",L()+60*b(db,a))}}else b(ta,a).begin_session=[h,t];else b(d,a).call(a,f.INFO,"begin_session, Session tracking is disabled by server config")});y(this,"session_duration",function(h){b(Db,a)?(b(d,a).call(a,f.INFO,"session_duration, Reporting session duration: ["+
h+"]"),a.check_consent("sessions")&&(b(na,a)?(b(d,a).call(a,f.INFO,"session_duration, Session extended: ["+h+"]"),a.userData.save(!0),b(da,a).call(a,{session_duration:h}),b(hd,a).call(a)):b(d,a).call(a,f.DEBUG,"session_duration, No session was started"))):b(d,a).call(a,f.INFO,"session_duration, Session tracking is disabled by server config")});y(this,"end_session",function(h,t){b(Db,a)||t?(b(d,a).call(a,f.INFO,"end_session, Ending the current session. There was an on going session:["+b(na,a)+"]"),
a.check_consent("sessions")&&b(na,a)&&(h=h||L()-b(ya,a),b(Ic,a).call(a),!b(za,a)||t?(b(d,a).call(a,f.INFO,"end_session, Session ended"),a.userData.save(!0),b(da,a).call(a,{end_session:1,session_duration:h})):a.session_duration(h),l(na,a,!1))):b(d,a).call(a,f.INFO,"end_session, Session tracking is disabled by server config")});y(this,"set_id",function(h){b(d,a).call(a,f.INFO,"set_id, Changing the device ID to:["+h+"]");null==h||""===h?b(d,a).call(a,f.WARNING,"set_id, The provided device is not a valid ID"):
0===b(P,a)?a.change_id(h,!1):a.change_id(h,!0)});y(this,"change_id",function(h,t){b(d,a).call(a,f.INFO,"change_id, Changing the device ID to: ["+h+"] with merge:["+t+"]");if(h&&"string"===typeof h&&0!==h.length)if(b(T,a))b(d,a).call(a,f.WARNING,"change_id, Offline mode was on, initiating disabling sequence instead."),a.disable_offline_mode(h);else if(a.device_id==h)b(d,a).call(a,f.DEBUG,"change_id, Provided device ID is equal to the current device ID. Aborting.");else{t||(b(wa,a).call(a),b(va,a).call(a),
a.end_session(null,!0),l(ra,a,{}),a.remove_consent_internal(w.features,!1));var c=a.device_id;a.device_id=h;a.device_id=a.device_id;l(P,a,0);b(B,a).call(a,"cly_id",a.device_id);b(B,a).call(a,"cly_id_type",0);b(d,a).call(a,f.INFO,"change_id, Changing ID from:["+c+"] to ["+h+"]");t?b(da,a).call(a,{old_device_id:c}):a.begin_session(!b($a,a),!0);a.remote_config&&(l(ea,a,{}),b(B,a).call(a,"cly_remote_configs",b(ea,a)),a.fetch_remote_config(a.remote_config))}else b(d,a).call(a,f.WARNING,"change_id, The provided device ID is not a valid ID")});
y(this,"add_event",function(h){b(d,a).call(a,f.INFO,"add_event, Adding event: ",h);switch(h.key){case ca.NPS:var t=a.check_consent("feedback");break;case ca.SURVEY:t=a.check_consent("feedback");break;case ca.STAR_RATING:t=a.check_consent("star-rating");break;case ca.VIEW:t=a.check_consent("views");break;case ca.ORIENTATION:t=a.check_consent("users");break;case ca.ACTION:t=a.check_consent("clicks")||a.check_consent("scrolls");break;default:t=b(nc,a)?a.check_consent("events"):!1}t&&b(oa,a).call(a,h)});
y(this,"attempt_to_send_stored_requests",function(){b(d,a).call(a,f.INFO,"attemptToSendStoredRequests, Attempting to send stored requests");b(wa,a).call(a);b(va,a).call(a)});y(this,"test_mode_rq",function(h){b(d,a).call(a,f.INFO,"test_mode_rq, Setting test mode to: ["+h+"]");a.test_mode=h});q(this,oa,function(h,t){if(a.ignore_visitor||!b(Cb,a))b(d,a).call(a,f.WARNING,"Not adding the event. Tracking is disabled by the server config:["+!b(Cb,a)+"] or ignore_visitor is:["+a.ignore_visitor+"]");else if(h.key)if(b(ac,
a)||a.userData.save(!0),h.count||(h.count=1),b(Gd,a).call(a,h.key)){var c=h.key;ie.includes(h.key)||(h.key=H(h.key,b(Q,a),"add_cly_event",b(d,a)));h.segmentation=b(Hd,a).call(a,h.key,h.segmentation);h.segmentation=Ga(h.segmentation,b(Q,a),b(O,a),b(ja,a),"add_cly_event",b(d,a));h=Nb(h,["key","count","sum","dur","segmentation"]);h.timestamp=sb();var e=new Date;h.hour=e.getHours();h.dow=e.getDay();h.id=t||Qc();h.key===ca.VIEW?h.pvid=b(yb,a)||"":h.cvid=b(La,a)||"";b(Y,a).push(h);b(B,a).call(a,"cly_event",
b(Y,a));b(d,a).call(a,f.INFO,"With event ID: ["+h.id+"], successfully adding the last event:",h);b(Id,a).call(a,c,h.id)}else b(d,a).call(a,f.DEBUG,"add_cly_event, Event was filtered out by behavior settings: ["+h.key+"]");else b(d,a).call(a,f.ERROR,"Adding event failed. Event must have a key property")});q(this,Gd,function(h){return b(Fb,a)&&0<b(Fb,a).length?-1===b(Fb,a).indexOf(h):b(Gb,a)&&0<b(Gb,a).length?-1!==b(Gb,a).indexOf(h):!0});q(this,Hd,function(h,t){if(!t||"object"!==W(t))return t;var c=
{},e;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&(c[e]=t[e]);if(b(Jb,a)&&0<b(Jb,a).length)b(Jb,a).forEach(function(n){delete c[n]});else if(b(Kb,a)&&0<b(Kb,a).length)for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&-1===b(Kb,a).indexOf(g)&&delete c[g];t=b(vc,a)[h];if(Array.isArray(t)&&0<t.length)t.forEach(function(n){delete c[n]});else if(h=b(wc,a)[h],Array.isArray(h)&&0<h.length)for(var k in c)Object.prototype.hasOwnProperty.call(c,k)&&-1===h.indexOf(k)&&delete c[k];return c});
q(this,Mb,function(h){return b(Hb,a)&&0<b(Hb,a).length?-1===b(Hb,a).indexOf(h):b(Ib,a)&&0<b(Ib,a).length?-1!==b(Ib,a).indexOf(h):!0});q(this,ad,function(h){if(!h||"object"!==W(h))return h;var t={},c;for(c in h)Object.prototype.hasOwnProperty.call(h,c)&&b(Mb,a).call(a,c)&&(t[c]=h[c]);return t});q(this,Id,function(h,t){Array.isArray(b(Lb,a))&&0!==b(Lb,a).length&&-1!==b(Lb,a).indexOf(h)&&(b(d,a).call(a,f.DEBUG,"journeyTrigger, Matched journey trigger event: ["+h+"]"),b(wa,a).call(a),b(va,a).call(a),
t&&b(Ua,a).add(t),b(mb,a)?(b(d,a).call(a,f.DEBUG,"journeyTrigger, Already processing, marking as pending"),l(nb,a,!0)):b(bd,a).call(a))});q(this,bd,Oc(Xa().m(function t(){var c;return Xa().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!b(mb,a)){e.n=1;break}return e.a(2);case 1:return l(mb,a,!0),l(nb,a,!1),e.p=2,e.n=3,b(Jd,a).call(a);case 3:(c=e.v)?b(Cc,a).call(a):b(d,a).call(a,f.DEBUG,"journeyTrigger, Could not flush request queue before content refresh");case 4:return e.p=4,l(mb,a,!1),b(nb,a)&&
(b(d,a).call(a,f.DEBUG,"journeyTrigger, Processing pending journey trigger"),l(nb,a,!1),setTimeout(function(){b(wa,a).call(a);b(va,a).call(a);b(bd,a).call(a)},0)),e.f(4);case 5:return e.a(2)}},t,null,[[2,,4,5]])})));q(this,Jd,Oc(Xa().m(function c(){var e,g,k;return Xa().w(function(n){for(;;)switch(n.n){case 0:e=b(K,a).length;if(0!==e){n.n=1;break}return n.a(2,!0);case 1:g=0;case 2:if(!(g<e)){n.n=6;break}n.n=3;return b(Kd,a).call(a);case 3:if(k=n.v){n.n=4;break}return n.a(2,!1);case 4:if(0!==b(K,a).length){n.n=
5;break}return n.a(2,!0);case 5:g++;n.n=2;break;case 6:return n.a(2,0===b(K,a).length)}},c)})));q(this,Kd,function(){return new Promise(function(){var c=Oc(Xa().m(function k(g){var n;return Xa().w(function(m){for(;;)switch(m.n){case 0:if(!b(T,a)){m.n=1;break}g(!1);return m.a(2);case 1:if(0!==b(K,a).length){m.n=2;break}g(!0);return m.a(2);case 2:n=0;case 3:if(!((!b(Ia,a)||b(Da,a)||L()<=b(Pa,a))&&5>n)){m.n=5;break}n++;m.n=4;return b(Md,a).call(a,500);case 4:m.n=3;break;case 5:if(!(!b(Ia,a)||b(Da,a)||
L()<=b(Pa,a))){m.n=6;break}g(!1);return m.a(2);case 6:b(id,a).call(a,"journey_trigger_send_request",function(u){b(Ld,a).call(a,u)}).then(function(u){g(u)});case 7:return m.a(2)}},k)}));return function(g){return c.apply(this,arguments)}}())});q(this,Ld,function(c){if(c&&c.events)try{var e=JSON.parse(c.events);if(Array.isArray(e))for(c=0;c<e.length;c++){var g=e[c];if(g&&g.id&&b(Ua,a).has(g.id))b(Ua,a)["delete"](g.id)}}catch(k){b(d,a).call(a,f.DEBUG,"journeyTrigger, Could not parse events while marking sent ids")}});
q(this,Cc,function(c){var e=c||0;"undefined"!==typeof document&&document.getElementById(b(hb,a))?b(d,a).call(a,f.DEBUG,"journeyTrigger, Content is already being displayed, skipping content request"):b(Ua,a)&&0<b(Ua,a).size?(b(d,a).call(a,f.DEBUG,"journeyTrigger, Pending journey events not yet confirmed sent. Deferring content refresh."),setTimeout(function(){b(Cc,a).call(a,e)},300)):b(Gc,a).call(a,function(g){!g&&3>e+1&&setTimeout(function(){b(Cc,a).call(a,e+1)},1E3)})});q(this,Md,function(c){return new Promise(function(e){return setTimeout(e,
c)})});y(this,"start_event",function(c){c&&"string"===typeof c?(b(d,a).call(a,f.INFO,"start_event, Starting timed event with key: ["+c+"]"),c=H(c,b(Q,a),"start_event",b(d,a)),b(ra,a)[c]?b(d,a).call(a,f.WARNING,"start_event, Timed event with key: ["+c+"] already started"):b(ra,a)[c]=L()):b(d,a).call(a,f.WARNING,"start_event, you have to provide a valid string key instead of: ["+c+"]")});y(this,"cancel_event",function(c){if(!c||"string"!==typeof c)return b(d,a).call(a,f.WARNING,"cancel_event, you have to provide a valid string key instead of: ["+
c+"]"),!1;b(d,a).call(a,f.INFO,"cancel_event, Canceling timed event with key: ["+c+"]");c=H(c,b(Q,a),"cancel_event",b(d,a));if(b(ra,a)[c])return delete b(ra,a)[c],b(d,a).call(a,f.INFO,"cancel_event, Timed event with key: ["+c+"] is canceled"),!0;b(d,a).call(a,f.WARNING,"cancel_event, Timed event with key: ["+c+"] was not found");return!1});y(this,"end_event",function(c){c?(b(d,a).call(a,f.INFO,"end_event, Ending timed event"),"string"===typeof c&&(c=H(c,b(Q,a),"end_event",b(d,a)),c={key:c}),c.key?
b(ra,a)[c.key]?(c.dur=L()-b(ra,a)[c.key],a.add_event(c),delete b(ra,a)[c.key]):b(d,a).call(a,f.ERROR,"end_event, Timed event with key: ["+c.key+"] was not started"):b(d,a).call(a,f.ERROR,"end_event, Timed event must have a key property")):b(d,a).call(a,f.WARNING,"end_event, you have to provide a valid string key or event object instead of: ["+c+"]")});q(this,cd,function(c){b(d,a).call(a,f.INFO,"report_orientation, Reporting orientation");a.check_consent("users")&&b(oa,a).call(a,{key:ca.ORIENTATION,
segmentation:{mode:c||(window.innerWidth>window.innerHeight?"landscape":"portrait")}})});y(this,"report_conversion",function(c,e){b(d,a).call(a,f.WARNING,"report_conversion, Deprecated function call! Use 'recordDirectAttribution' in place of this call. Call will be redirected now!");a.recordDirectAttribution(c,e)});y(this,"recordDirectAttribution",function(c,e){b(d,a).call(a,f.INFO,"recordDirectAttribution, Recording the attribution for campaign ID: ["+c+"] and the user ID: ["+e+"]");a.check_consent("attribution")&&
(c=c||b(E,a).call(a,"cly_cmp_id")||"cly_organic",(e=e||b(E,a).call(a,"cly_cmp_uid"))?b(da,a).call(a,{campaign_id:c,campaign_user:e}):b(da,a).call(a,{campaign_id:c}))});y(this,"user_details",function(c){b(d,a).call(a,f.INFO,"user_details, Trying to add user details: ",c);if(a.check_consent("users")){b(wa,a).call(a);b(va,a).call(a);b(d,a).call(a,f.INFO,"user_details, flushed the event queue");for(var e in c)"custom"===e||b(Mb,a).call(a,e)||(b(d,a).call(a,f.DEBUG,"user_details, User property filtered by behavior settings: ["+
e+"]"),delete c[e]);c.name=H(c.name,b(O,a),"user_details",b(d,a));c.username=H(c.username,b(O,a),"user_details",b(d,a));c.email=H(c.email,b(O,a),"user_details",b(d,a));c.organization=H(c.organization,b(O,a),"user_details",b(d,a));c.phone=H(c.phone,b(O,a),"user_details",b(d,a));c.picture=H(c.picture,4096,"user_details",b(d,a));c.gender=H(c.gender,b(O,a),"user_details",b(d,a));c.byear=H(c.byear,b(O,a),"user_details",b(d,a));c.custom=b(ad,a).call(a,c.custom);c.custom=Ga(c.custom,b(Q,a),b(O,a),b(ja,a),
"user_details",b(d,a));a.userData.save();b(da,a).call(a,{user_details:JSON.stringify(Nb(c,"name username email organization phone picture gender byear custom".split(" ")))})}});q(this,fa,{});q(this,Ea,function(c,e,g){a.check_consent("users")&&(b(Mb,a).call(a,c)?(b(fa,a)[c]||(b(fa,a)[c]={}),"$push"===g||"$pull"===g||"$addToSet"===g?(b(fa,a)[c][g]||(b(fa,a)[c][g]=[]),b(fa,a)[c][g].push(e)):b(fa,a)[c][g]=e):b(d,a).call(a,f.DEBUG,"[userData] change_custom_property, User property filtered by behavior settings: ["+
c+"]"))});y(this,"userData",{set:function(c,e){b(d,a).call(a,f.INFO,"[userData] set, Setting user's custom property value: ["+e+"] under the key: ["+c+"]");c=H(c,b(Q,a),"userData set",b(d,a));e=H(e,b(O,a),"userData set",b(d,a));b(Mb,a).call(a,c)?b(fa,a)[c]=e:b(d,a).call(a,f.DEBUG,"[userData] set, User property filtered by behavior settings: ["+c+"]")},unset:function(c){b(d,a).call(a,f.INFO,"[userData] unset, Resetting user's custom property with key: ["+c+"] ");b(Mb,a).call(a,c)?b(fa,a)[c]="":b(d,
a).call(a,f.DEBUG,"[userData] unset, User property filtered by behavior settings: ["+c+"]")},set_once:function(c,e){b(d,a).call(a,f.INFO,"[userData] set_once, Setting user's unique custom property value: ["+e+"] under the key: ["+c+"] ");c=H(c,b(Q,a),"userData set_once",b(d,a));e=H(e,b(O,a),"userData set_once",b(d,a));b(Ea,a).call(a,c,e,"$setOnce")},increment:function(c){b(d,a).call(a,f.INFO,"[userData] increment, Increasing user's custom property value under the key: ["+c+"] by one");c=H(c,b(Q,a),
"userData increment",b(d,a));b(Ea,a).call(a,c,1,"$inc")},increment_by:function(c,e){b(d,a).call(a,f.INFO,"[userData] increment_by, Increasing user's custom property value under the key: ["+c+"] by: ["+e+"]");c=H(c,b(Q,a),"userData increment_by",b(d,a));e=H(e,b(O,a),"userData increment_by",b(d,a));b(Ea,a).call(a,c,e,"$inc")},multiply:function(c,e){b(d,a).call(a,f.INFO,"[userData] multiply, Multiplying user's custom property value under the key: ["+c+"] by: ["+e+"]");c=H(c,b(Q,a),"userData multiply",
b(d,a));e=H(e,b(O,a),"userData multiply",b(d,a));b(Ea,a).call(a,c,e,"$mul")},max:function(c,e){b(d,a).call(a,f.INFO,"[userData] max, Saving user's maximum custom property value compared to the value: ["+e+"] under the key: ["+c+"]");c=H(c,b(Q,a),"userData max",b(d,a));e=H(e,b(O,a),"userData max",b(d,a));b(Ea,a).call(a,c,e,"$max")},min:function(c,e){b(d,a).call(a,f.INFO,"[userData] min, Saving user's minimum custom property value compared to the value: ["+e+"] under the key: ["+c+"]");c=H(c,b(Q,a),
"userData min",b(d,a));e=H(e,b(O,a),"userData min",b(d,a));b(Ea,a).call(a,c,e,"$min")},push:function(c,e){b(d,a).call(a,f.INFO,"[userData] push, Pushing a value: ["+e+"] under the key: ["+c+"] to user's custom property array");c=H(c,b(Q,a),"userData push",b(d,a));e=H(e,b(O,a),"userData push",b(d,a));b(Ea,a).call(a,c,e,"$push")},push_unique:function(c,e){b(d,a).call(a,f.INFO,"[userData] push_unique, Pushing a unique value: ["+e+"] under the key: ["+c+"] to user's custom property array");c=H(c,b(Q,
a),"userData push_unique",b(d,a));e=H(e,b(O,a),"userData push_unique",b(d,a));b(Ea,a).call(a,c,e,"$addToSet")},pull:function(c,e){b(d,a).call(a,f.INFO,"[userData] pull, Removing the value: ["+e+"] under the key: ["+c+"] from user's custom property array");b(Ea,a).call(a,c,e,"$pull")},save:function(c){b(d,a).call(a,f.INFO,"[userData] save, Saving changes to user's custom property. forEvents:["+c+"]");if(a.check_consent("users")&&0!==Object.keys(b(fa,a)).length){if(!c){b(d,a).call(a,f.DEBUG,"[userData] save, flushing async queue and event queue before sending custom user data");
l(ac,a,!0);try{b(wa,a).call(a)}finally{l(ac,a,!1)}b(va,a).call(a)}l(fa,a,b(ad,a).call(a,b(fa,a)));0!==Object.keys(b(fa,a)).length&&(b(d,a).call(a,f.INFO,"[userData] save, will send the following custom data to server: ["+JSON.stringify(b(fa,a))+"]"),b(da,a).call(a,{user_details:JSON.stringify({custom:b(fa,a)})}),l(fa,a,{}))}}});y(this,"report_trace",function(c){b(d,a).call(a,f.INFO,"report_trace, Reporting performance trace");if(a.check_consent("apm")){for(var e="type name stz etz apm_metrics apm_attr".split(" "),
g=0;g<e.length;g++)if("apm_attr"!==e[g]&&"undefined"===typeof c[e[g]]){b(d,a).call(a,f.WARNING,"report_trace, APM trace don't have the property: "+e[g]);return}c.name=H(c.name,b(Q,a),"report_trace",b(d,a));c.app_metrics=Ga(c.app_metrics,b(Q,a),b(O,a),b(ja,a),"report_trace",b(d,a));e=Nb(c,e);e.timestamp=c.stz;c=new Date;e.hour=c.getHours();e.dow=c.getDay();b(da,a).call(a,{apm:JSON.stringify(e)});b(d,a).call(a,f.INFO,"report_trace, Successfully adding APM trace: ",e)}});y(this,"track_errors",function(c){D?
b(Wb,a)?(b(d,a).call(a,f.INFO,"track_errors, Started tracking errors"),w.i[a.app_key].tracking_crashes=!0,window.cly_crashes||(window.cly_crashes=!0,l(Qb,a,c),window.addEventListener("error",function(e){if(e.error)Sc(e.error,!1);else{var g=e.filename||"",k=e.lineno||0,n=e.colno||0;e=(e.message||"Unknown error")+"\n";g&&(e+="at "+g);k&&(e+=":"+k);n&&(e+=":"+n);e+="\n";Sc(e+"",!1)}}),window.addEventListener("unhandledrejection",function(e){Sc(Error("Unhandled rejection (reason: "+(e.reason&&e.reason.stack?
e.reason.stack:e.reason)+")."),!0)}))):b(d,a).call(a,f.WARNING,"track_errors, Crash tracking is disabled by the server config. Not tracking errors."):b(d,a).call(a,f.WARNING,"track_errors, window object is not available. Not tracking errors.")});y(this,"log_error",function(c,e){b(d,a).call(a,f.INFO,"log_error, Logging errors");a.recordError(c,!0,e)});y(this,"add_log",function(c){b(d,a).call(a,f.INFO,"add_log, Adding a new log of breadcrumbs: [ "+c+" ]");if(a.check_consent("crashes")){for(c=H(c,b(O,
a),"add_log",b(d,a));b(Ha,a).length>=b(kb,a);)b(Ha,a).shift(),b(d,a).call(a,f.WARNING,"add_log, Reached maximum crashLogs size. Will erase the oldest one.");b(Ha,a).push(c)}});y(this,"fetch_remote_config",function(c,e,g){var k=null,n=null,m=null;c&&(g||"function"!==typeof c?Array.isArray(c)&&(k=c):m=c);e&&(g||"function"!==typeof e?Array.isArray(e)&&(n=e):m=e);m||"function"!==typeof g||(m=g);a.useExplicitRcApi?(b(d,a).call(a,f.INFO,"fetch_remote_config, Fetching remote config"),c=a.rcAutoOptinAb?1:
0,b(dd,a).call(a,k,n,c,null,m)):(b(d,a).call(a,f.WARNING,"fetch_remote_config, Fetching remote config, with legacy API"),b(dd,a).call(a,k,n,null,"legacy",m))});q(this,dd,function(c,e,g,k,n){b(d,a).call(a,f.INFO,"fetch_remote_config_explicit, Fetching sequence initiated");var m={method:"rc",av:a.app_version};c&&(m.keys=JSON.stringify(c));e&&(m.omit_keys=JSON.stringify(e));var u;"legacy"===k&&(m.method="fetch_remote_config");0===g&&(m.oi=0);1===g&&(m.oi=1);"function"===typeof n&&(u=n);a.check_consent("sessions")&&
(m.metrics=JSON.stringify(b(dc,a).call(a)));a.check_consent("remote-config")?(b(pb,a).call(a,m),b(pa,a).call(a,"fetch_remote_config_explicit",a.url+b(Za,a),m,function(x,C,F){if(!x){try{var R=JSON.parse(F);if(m.keys||m.omit_keys)for(var X in R)b(ea,a)[X]=R[X];else l(ea,a,R);b(B,a).call(a,"cly_remote_configs",b(ea,a))}catch(I){b(d,a).call(a,f.ERROR,"fetch_remote_config_explicit, Had an issue while parsing the response: "+I)}u&&(b(d,a).call(a,f.INFO,"fetch_remote_config_explicit, Callback function is provided"),
u(x,b(ea,a)))}},!0)):(b(d,a).call(a,f.ERROR,"fetch_remote_config_explicit, Remote config requires explicit consent"),u&&u(Error("Remote config requires explicit consent"),b(ea,a)))});y(this,"enrollUserToAb",function(c){b(d,a).call(a,f.INFO,"enrollUserToAb, Providing AB test keys to opt in for");c&&Array.isArray(c)&&0!==c.length?(c={method:"ab",keys:JSON.stringify(c),av:a.app_version},b(pb,a).call(a,c),b(pa,a).call(a,"enrollUserToAb",a.url+b(Za,a),c,function(e,g,k){if(!e)try{var n=JSON.parse(k);b(d,
a).call(a,f.DEBUG,"enrollUserToAb, Parsed the response's result: ["+n.result+"]")}catch(m){b(d,a).call(a,f.ERROR,"enrollUserToAb, Had an issue while parsing the response: "+m)}},!0)):b(d,a).call(a,f.ERROR,"enrollUserToAb, No keys provided")});y(this,"get_remote_config",function(c){b(d,a).call(a,f.INFO,"get_remote_config, Getting remote config from storage");return"undefined"!==typeof c?b(ea,a)[c]:b(ea,a)});q(this,ed,function(){b(d,a).call(a,f.INFO,"stop_time, Stopping tracking duration");b(Ja,a)&&
(l(Ja,a,!1),l(Rb,a,L()-b(ya,a)),l(bb,a,L()-b(ab,a)))});q(this,Dc,function(){b(d,a).call(a,f.INFO,"start_time, Starting tracking duration");b(Ja,a)||(l(Ja,a,!0),l(ya,a,L()-b(Rb,a)),l(ab,a,L()-b(bb,a)),l(bb,a,0),b(hd,a).call(a))});y(this,"track_sessions",function(){if(D){b(d,a).call(a,f.INFO,"track_session, Starting tracking user session");a.begin_session();b(Dc,a).call(a);M(window,"beforeunload",function(){b(wa,a).call(a);b(va,a).call(a);a.end_session()});var c="hidden",e=function(){document[c]||!document.hasFocus()?
b(ed,a).call(a):b(Dc,a).call(a)};M(window,"focus",e);M(window,"blur",e);M(window,"pageshow",e);M(window,"pagehide",e);"onfocusin"in document&&(M(window,"focusin",e),M(window,"focusout",e));c in document?document.addEventListener("visibilitychange",e):"mozHidden"in document?(c="mozHidden",document.addEventListener("mozvisibilitychange",e)):"webkitHidden"in document?(c="webkitHidden",document.addEventListener("webkitvisibilitychange",e)):"msHidden"in document&&(c="msHidden",document.addEventListener("msvisibilitychange",
e));e=function(){b(Qa,a)>=b(cb,a)&&b(Dc,a).call(a);l(Qa,a,0)};M(window,"mousemove",e);M(window,"click",e);M(window,"keydown",e);M(window,"scroll",e);setInterval(function(){var g;l(Qa,a,(g=b(Qa,a),g++,g));b(Qa,a)>=b(cb,a)&&b(ed,a).call(a)},6E4)}else b(d,a).call(a,f.WARNING,"track_sessions, window object is not available. Not tracking sessions.")});y(this,"track_pageview",function(c,e,g){if(D||c)if(b(Vb,a))if(b(d,a).call(a,f.INFO,"track_pageview, Tracking page views"),b(d,a).call(a,f.VERBOSE,"track_pageview, last view is:["+
b(ia,a)+"], current view ID is:["+b(La,a)+"], previous view ID is:["+b(yb,a)+"]"),b(ia,a)&&b(Sb,a)&&(b(d,a).call(a,f.DEBUG,"track_pageview, Scroll registry triggered"),b(Nc,a).call(a),l(eb,a,!0),l(fb,a,0)),b(Ic,a).call(a),l(yb,a,b(La,a)),l(La,a,Qc()),(c=H(c,b(Q,a),"track_pageview",b(d,a)))&&Array.isArray(c)&&(e=c,c=null),c||(c=a.getViewName()),void 0===c||""===c)b(d,a).call(a,f.ERROR,"track_pageview, No page name to track (it is either undefined or empty string). No page view can be tracked.");else if(null===
c)b(d,a).call(a,f.ERROR,"track_pageview, View name returned as null. Page view will be ignored.");else{if(e&&e.length)for(var k=0;k<e.length;k++)try{if((new RegExp(e[k])).test(c)){b(d,a).call(a,f.INFO,"track_pageview, Ignoring the page: "+c);return}}catch(x){b(d,a).call(a,f.ERROR,"track_pageview, Problem with finding ignore list item: "+e[k]+", error: "+x)}k={name:c,visit:1,view:a.getViewUrl()};k=Ga(k,b(Q,a),b(O,a),b(ja,a),"track_pageview",b(d,a));a.track_domains&&(k.domain=window.location.hostname);
if(b(za,a))if(b(na,a))b(Ra,a)&&(l(Ra,a,!1),k.start=1);else{var n=b(E,a).call(a,"cly_session");if(!n||parseInt(n)<=L())l(Ra,a,!1),k.start=1}else D&&"undefined"!==typeof document.referrer&&document.referrer.length&&(n=Dd.exec(document.referrer))&&n[11]&&n[11]!==window.location.hostname&&(k.start=1);if(b(Aa,a)&&Object.keys(b(Aa,a)).length){b(d,a).call(a,f.INFO,"track_pageview, Adding fresh utm tags to segmentation:["+JSON.stringify(b(Aa,a))+"]");for(var m in b(Aa,a))"undefined"===typeof k["utm_"+m]&&
(k["utm_"+m]=b(Aa,a)[m])}D&&b(Kc,a).call(a)&&(b(d,a).call(a,f.INFO,"track_pageview, Adding referrer to segmentation:["+document.referrer+"]"),k.referrer=document.referrer);if(g){g=Ga(g,b(Q,a),b(O,a),b(ja,a),"track_pageview",b(d,a));for(var u in g)"undefined"===typeof k[u]&&(k[u]=g[u])}a.check_consent("views")?(b(oa,a).call(a,{key:ca.VIEW,segmentation:k},b(La,a)),l(ia,a,c),l(ab,a,L()),b(d,a).call(a,f.VERBOSE,"track_pageview, last view is assigned:["+b(ia,a)+"]")):b(ta,a).track_pageview=[c,e,g]}else b(d,
a).call(a,f.WARNING,"track_pageview, View tracking is disabled by the server config. Not tracking page views.");else b(d,a).call(a,f.WARNING,"track_pageview, window object is not available. Not tracking page views as page name is not provided.")});y(this,"track_view",function(c,e,g){b(d,a).call(a,f.INFO,"track_view, Initiating tracking page views");a.track_pageview(c,e,g)});y(this,"track_clicks",function(c){if(D){b(d,a).call(a,f.INFO,"track_clicks, Starting to track clicks");c&&b(d,a).call(a,f.INFO,
"track_clicks, Tracking the specified children:["+c+"]");c=c||document;var e=!0;M(c,"click",function(g){if(e){e=!1;Wc(g);if("undefined"!==typeof g.pageX&&"undefined"!==typeof g.pageY){var k=ic(),n=Xc();a.check_consent("clicks")&&(g={type:"click",x:g.pageX,y:g.pageY,width:n,height:k,view:a.getViewUrl()},g=Ga(g,b(Q,a),b(O,a),b(ja,a),"processClick",b(d,a)),a.track_domains&&(g.domain=window.location.hostname),b(oa,a).call(a,{key:ca.ACTION,segmentation:g}))}setTimeout(function(){e=!0},1E3)}})}else b(d,
a).call(a,f.WARNING,"track_clicks, window object is not available. Not tracking clicks.")});y(this,"track_scrolls",function(c){D?(b(d,a).call(a,f.INFO,"track_scrolls, Starting to track scrolls"),c&&b(d,a).call(a,f.INFO,"track_scrolls, Tracking the specified children"),c=c||window,l(eb,a,!0),l(Sb,a,!0),M(c,"scroll",b(nd,a)),M(c,"beforeunload",b(Nc,a))):b(d,a).call(a,f.WARNING,"track_scrolls, window object is not available. Not tracking scrolls.")});y(this,"track_links",function(c){D?(b(d,a).call(a,
f.INFO,"track_links, Starting to track clicks to links"),c&&b(d,a).call(a,f.INFO,"track_links, Tracking the specified children"),c=c||document,M(c,"click",function(e){a:{var g=hc(e);var k;for(k="A";g;){if(g.nodeName.toUpperCase()===k)break a;g=g.parentElement}g=void 0}g&&(Wc(e),a.check_consent("clicks")&&b(oa,a).call(a,{key:"linkClick",segmentation:{href:g.href,text:g.innerText,id:g.id,view:a.getViewUrl()}}))})):b(d,a).call(a,f.WARNING,"track_links, window object is not available. Not tracking links.")});
y(this,"uploadUserProfilePicture",function(c){if(D)if(c&&"object"===W(c)&&c.type&&0===c.type.indexOf("image"))if("undefined"===typeof FileReader)b(d,a).call(a,f.ERROR,"uploadUserProfilePicture: FileReader is not available in this environment.");else{var e=new FileReader;e.onerror=function(){b(d,a).call(a,f.ERROR,"uploadUserProfilePicture: Failed to read the provided image file.")};e.onload=function(){var g=e.result;if("string"!==typeof g)b(d,a).call(a,f.ERROR,"uploadUserProfilePicture: Unable to process the selected image.");
else{var k=g.indexOf(",");(g=-1===k?g:g.substring(k+1))?(b(da,a).call(a,{__imageUpload:!0,imageData:g,imageName:c.name||"avatar",imageType:c.type||"application/octet-stream",user_details:"{}"}),b(d,a).call(a,f.INFO,"uploadUserProfilePicture: Image upload request queued.")):b(d,a).call(a,f.ERROR,"uploadUserProfilePicture: Invalid image data received.")}};e.readAsDataURL(c)}else b(d,a).call(a,f.ERROR,"uploadUserProfilePicture: Provided file is not an image.");else b(d,a).call(a,f.ERROR,"uploadUserProfilePicture: Browser environment required.")});
y(this,"track_forms",function(c,e){if(D){b(d,a).call(a,f.INFO,"track_forms, Starting to track form submissions. DOM object provided:["+!!c+"] Tracking hidden inputs :["+!!e+"]");c=c||document;var g=function(k){return k.name||k.id||k.type||k.nodeName};M(c,"submit",function(k){k=hc(k);var n={id:k.attributes.id&&k.attributes.id.nodeValue,name:k.attributes.name&&k.attributes.name.nodeValue,action:k.attributes.action&&k.attributes.action.nodeValue,method:k.attributes.method&&k.attributes.method.nodeValue,
view:a.getViewUrl()},m;if("undefined"!==typeof k.elements){for(var u=0;u<k.elements.length;u++)(m=k.elements[u])&&"password"!==m.type&&-1===m.className.indexOf("cly_user_ignore")&&("undefined"===typeof n["input:"+g(m)]&&(n["input:"+g(m)]=[]),"select"===m.nodeName.toLowerCase()?"undefined"!==typeof m.multiple?n["input:"+g(m)].push(td(m)):n["input:"+g(m)].push(m.options[m.selectedIndex].value):"input"===m.nodeName.toLowerCase()?"undefined"!==typeof m.type?"checkbox"===m.type.toLowerCase()||"radio"===
m.type.toLowerCase()?m.checked&&n["input:"+g(m)].push(m.value):("hidden"!==m.type.toLowerCase()||e)&&n["input:"+g(m)].push(m.value):n["input:"+g(m)].push(m.value):"textarea"===m.nodeName.toLowerCase()?n["input:"+g(m)].push(m.value):"undefined"!==typeof m.value&&n["input:"+g(m)].push(m.value));for(var x in n)n[x]&&"function"===typeof n[x].join&&(n[x]=n[x].join(", "))}a.check_consent("forms")&&b(oa,a).call(a,{key:"formSubmit",segmentation:n})})}else b(d,a).call(a,f.WARNING,"track_forms, window object is not available. Not tracking forms.")});
y(this,"collect_from_forms",function(c,e){D?(b(d,a).call(a,f.INFO,"collect_from_forms, Starting to collect possible user data. DOM object provided:["+!!c+"] Submitting custom user property:["+!!e+"]"),c=c||document,M(c,"submit",function(g){g=hc(g);var k={},n=!1,m;if("undefined"!==typeof g.elements){var u={},x=c.getElementsByTagName("LABEL"),C;for(C=0;C<x.length;C++)x[C].htmlFor&&""!==x[C].htmlFor&&(u[x[C].htmlFor]=x[C].innerText||x[C].textContent||x[C].innerHTML);for(C=0;C<g.elements.length;C++)if((m=
g.elements[C])&&"password"!==m.type&&-1===m.className.indexOf("cly_user_ignore"))if(x="","select"===m.nodeName.toLowerCase()?x="undefined"!==typeof m.multiple?td(m):m.options[m.selectedIndex].value:"input"===m.nodeName.toLowerCase()?"undefined"!==typeof m.type?"checkbox"===m.type.toLowerCase()||"radio"===m.type.toLowerCase()?m.checked&&(x=m.value):x=m.value:x=m.value:"textarea"===m.nodeName.toLowerCase()?x=m.value:"undefined"!==typeof m.value&&(x=m.value),m.className&&-1!==m.className.indexOf("cly_user_")){var F=
m.className.split(" ");for(m=0;m<F.length;m++)if(0===F[m].indexOf("cly_user_")){k[F[m].replace("cly_user_","")]=x;n=!0;break}}else if(m.type&&"email"===m.type.toLowerCase()||m.name&&-1!==m.name.toLowerCase().indexOf("email")||m.id&&-1!==m.id.toLowerCase().indexOf("email")||m.id&&u[m.id]&&-1!==u[m.id].toLowerCase().indexOf("email")||/[^@\s]+@[^@\s]+\.[^@\s]+/.test(x))k.email||(k.email=x),n=!0;else if(m.name&&-1!==m.name.toLowerCase().indexOf("username")||m.id&&-1!==m.id.toLowerCase().indexOf("username")||
m.id&&u[m.id]&&-1!==u[m.id].toLowerCase().indexOf("username"))k.username||(k.username=x),n=!0;else if(m.name&&(-1!==m.name.toLowerCase().indexOf("tel")||-1!==m.name.toLowerCase().indexOf("phone")||-1!==m.name.toLowerCase().indexOf("number"))||m.id&&(-1!==m.id.toLowerCase().indexOf("tel")||-1!==m.id.toLowerCase().indexOf("phone")||-1!==m.id.toLowerCase().indexOf("number"))||m.id&&u[m.id]&&(-1!==u[m.id].toLowerCase().indexOf("tel")||-1!==u[m.id].toLowerCase().indexOf("phone")||-1!==u[m.id].toLowerCase().indexOf("number")))k.phone||
(k.phone=x),n=!0;else if(m.name&&(-1!==m.name.toLowerCase().indexOf("org")||-1!==m.name.toLowerCase().indexOf("company"))||m.id&&(-1!==m.id.toLowerCase().indexOf("org")||-1!==m.id.toLowerCase().indexOf("company"))||m.id&&u[m.id]&&(-1!==u[m.id].toLowerCase().indexOf("org")||-1!==u[m.id].toLowerCase().indexOf("company")))k.organization||(k.organization=x),n=!0;else if(m.name&&-1!==m.name.toLowerCase().indexOf("name")||m.id&&-1!==m.id.toLowerCase().indexOf("name")||m.id&&u[m.id]&&-1!==u[m.id].toLowerCase().indexOf("name"))k.name||
(k.name=""),k.name+=x+" ",n=!0}n&&(b(d,a).call(a,f.INFO,"collect_from_forms, Gathered user data",k),e?a.user_details({custom:k}):a.user_details(k))})):b(d,a).call(a,f.WARNING,"collect_from_forms, window object is not available. Not collecting from forms.")});y(this,"collect_from_facebook",function(c){D?"undefined"!==typeof FB&&FB&&FB.api?(b(d,a).call(a,f.INFO,"collect_from_facebook, Starting to collect possible user data"),FB.api("/me",function(e){var g={};e.name&&(g.name=e.name);e.email&&(g.email=
e.email);"male"===e.gender?g.gender="M":"female"===e.gender&&(g.gender="F");if(e.birthday){var k=e.birthday.split("/").pop();k&&4===k.length&&(g.byear=k)}e.work&&e.work[0]&&e.work[0].employer&&e.work[0].employer.name&&(g.organization=e.work[0].employer.name);if(c){g.custom={};for(var n in c){k=c[n].split(".");for(var m=e,u=0;u<k.length&&(m=m[k[u]],"undefined"!==typeof m);u++);"undefined"!==typeof m&&(g.custom[n]=m)}}a.user_details(g)})):b(d,a).call(a,f.ERROR,"collect_from_facebook, Facebook SDK is not available"):
b(d,a).call(a,f.WARNING,"collect_from_facebook, window object is not available. Not collecting from Facebook.")});y(this,"opt_out",function(){b(d,a).call(a,f.WARNING,"opt_out, Opting out the user. Deprecated function call! Use 'consent' in place of this call.");a.ignore_visitor=!0;b(B,a).call(a,"cly_ignore",!0)});y(this,"opt_in",function(){b(d,a).call(a,f.WARNING,"opt_in, Opting in the user. Deprecated function call! Use 'consent' in place of this call.");b(B,a).call(a,"cly_ignore",!1);a.ignore_visitor=
!1;b(fd,a).call(a);a.ignore_visitor||b(xb,a)||b(cc,a).call(a)});y(this,"report_feedback",function(c){b(d,a).call(a,f.WARNING,"report_feedback, Deprecated function call! Use 'recordRatingWidgetWithID' or 'reportFeedbackWidgetManually' in place of this call. Call will be redirected to 'recordRatingWidgetWithID' now!");a.recordRatingWidgetWithID(c)});y(this,"recordRatingWidgetWithID",function(c){b(d,a).call(a,f.INFO,"recordRatingWidgetWithID, Providing information about user with ID: [ "+c.widget_id+
" ]");if(a.check_consent("star-rating"))if(c.widget_id)if(c.rating){var e={key:ca.STAR_RATING,count:1,segmentation:{}};e.segmentation=Nb(c,"widget_id contactMe platform app_version rating email comment".split(" "));e.segmentation.app_version||(e.segmentation.app_version=a.metrics._app_version||a.app_version);5<e.segmentation.rating?(b(d,a).call(a,f.WARNING,"recordRatingWidgetWithID, You have entered a rating higher than 5. Changing it back to 5 now."),e.segmentation.rating=5):1>e.segmentation.rating&&
(b(d,a).call(a,f.WARNING,"recordRatingWidgetWithID, You have entered a rating lower than 1. Changing it back to 1 now."),e.segmentation.rating=1);b(d,a).call(a,f.INFO,"recordRatingWidgetWithID, Reporting Rating Widget: ",e);b(oa,a).call(a,e)}else b(d,a).call(a,f.ERROR,"recordRatingWidgetWithID, Rating Widget must contain rating property");else b(d,a).call(a,f.ERROR,"recordRatingWidgetWithID, Rating Widget must contain widget_id property")});y(this,"reportFeedbackWidgetManually",function(c,e,g){if(a.check_consent("feedback"))if(c&&
e)if(c._id)if(b(T,a))b(d,a).call(a,f.ERROR,"reportFeedbackWidgetManually, Feedback Widgets can not be reported in offline mode");else{b(d,a).call(a,f.INFO,"reportFeedbackWidgetManually, Providing information about user with, provided result of the widget with  ID: [ "+c._id+" ] and type: ["+c.type+"]");var k=[];e=c.type;if("nps"===e){if(g){if(!g.rating){b(d,a).call(a,f.ERROR,"reportFeedbackWidgetManually, Widget must contain rating property");return}g.rating=Math.round(g.rating);10<g.rating?(b(d,
a).call(a,f.WARNING,"reportFeedbackWidgetManually, You have entered a rating higher than 10. Changing it back to 10 now."),g.rating=10):0>g.rating&&(b(d,a).call(a,f.WARNING,"reportFeedbackWidgetManually, You have entered a rating lower than 0. Changing it back to 0 now."),g.rating=0);k=["rating","comment"]}var n=ca.NPS}else if("survey"===e){if(g){if(1>Object.keys(g).length){b(d,a).call(a,f.ERROR,"reportFeedbackWidgetManually, Widget should have answers to be reported");return}k=Object.keys(g)}n=ca.SURVEY}else if("rating"===
e){if(g){if(!g.rating){b(d,a).call(a,f.ERROR,"reportFeedbackWidgetManually, Widget must contain rating property");return}g.rating=Math.round(g.rating);5<g.rating?(b(d,a).call(a,f.WARNING,"reportFeedbackWidgetManually, You have entered a rating higher than 5. Changing it back to 5 now."),g.rating=5):1>g.rating&&(b(d,a).call(a,f.WARNING,"reportFeedbackWidgetManually, You have entered a rating lower than 1. Changing it back to 1 now."),g.rating=1);k=["rating","comment","email","contactMe"]}n=ca.STAR_RATING}else{b(d,
a).call(a,f.ERROR,"reportFeedbackWidgetManually, Widget has an unacceptable type");return}c={key:n,count:1,segmentation:{widget_id:c._id,platform:a.platform,app_version:a.metrics._app_version||a.app_version}};if(null===g)c.segmentation.closed=1;else{n=c.segmentation;if(k){for(var m,u=0,x=k.length;u<x;u++)m=k[u],"undefined"!==typeof g[m]&&(n[m]=g[m]);g=n}else g=void 0;c.segmentation=g}b(d,a).call(a,f.INFO,"reportFeedbackWidgetManually, Reporting "+e+": ",c);b(oa,a).call(a,c)}else b(d,a).call(a,f.ERROR,
"reportFeedbackWidgetManually, Feedback Widgets must contain _id property");else b(d,a).call(a,f.ERROR,"reportFeedbackWidgetManually, Widget data and/or Widget object not provided. Aborting.")});y(this,"show_feedback_popup",function(c){D?(b(d,a).call(a,f.WARNING,"show_feedback_popup, Deprecated function call! Use 'presentRatingWidgetWithID' in place of this call. Call will be redirected now!"),presentRatingWidgetWithID(c)):b(d,a).call(a,f.WARNING,"show_feedback_popup, window object is not available. Not showing feedback popup.")});
y(this,"presentRatingWidgetWithID",function(c){D?(b(d,a).call(a,f.INFO,"presentRatingWidgetWithID, Showing rating widget popup for the widget with ID: [ "+c+" ]"),a.check_consent("star-rating")&&(b(T,a)?b(d,a).call(a,f.ERROR,"presentRatingWidgetWithID, Cannot show ratingWidget popup in offline mode"):b(pa,a).call(a,"presentRatingWidgetWithID,",a.url+"/o/feedback/widget",{widget_id:c,av:a.app_version},function(e,g,k){if(!e)try{var n=JSON.parse(k);b(Hc,a).call(a,n,!1)}catch(m){b(d,a).call(a,f.ERROR,
"presentRatingWidgetWithID, JSON parse failed: "+m)}},!0))):b(d,a).call(a,f.WARNING,"presentRatingWidgetWithID, window object is not available. Not showing rating widget popup.")});y(this,"initialize_feedback_popups",function(c){D?(b(d,a).call(a,f.WARNING,"initialize_feedback_popups, Deprecated function call! Use 'initializeRatingWidgets' in place of this call. Call will be redirected now!"),a.initializeRatingWidgets(c)):b(d,a).call(a,f.WARNING,"initialize_feedback_popups, window object is not available. Not initializing feedback popups.")});
y(this,"initializeRatingWidgets",function(c){if(D){if(b(d,a).call(a,f.INFO,"initializeRatingWidgets, Initializing rating widget with provided widget IDs:[ "+c+"]"),a.check_consent("star-rating")){c||(c=b(E,a).call(a,"cly_fb_widgets"));for(var e=document.getElementsByClassName("countly-feedback-sticker");0<e.length;)e[0].remove();b(pa,a).call(a,"initializeRatingWidgets,",a.url+"/o/feedback/multiple-widgets-by-id",{widgets:JSON.stringify(c),av:a.app_version},function(g,k,n){if(!g)try{var m=JSON.parse(n);
for(g=0;g<m.length;g++)if("true"===m[g].is_active){var u=m[g].target_devices,x=Vc();if(u[x])if("string"===typeof m[g].hide_sticker&&(m[g].hide_sticker="true"===m[g].hide_sticker),"all"!==m[g].target_page||m[g].hide_sticker){var C=m[g].target_pages;for(k=0;k<C.length;k++){var F=C[k].substr(0,C[k].length-1)===window.location.pathname.substr(0,C[k].length-1),R=C[k]===window.location.pathname;(C[k].includes("*")&&F||R)&&!m[g].hide_sticker&&b(Hc,a).call(a,m[g],!0)}}else b(Hc,a).call(a,m[g],!0)}}catch(X){b(d,
a).call(a,f.ERROR,"initializeRatingWidgets, JSON parse error: "+X)}},!0)}}else b(d,a).call(a,f.WARNING,"initializeRatingWidgets, window object is not available. Not initializing rating widgets.")});y(this,"enable_feedback",function(c){D?(b(d,a).call(a,f.WARNING,"enable_feedback, Deprecated function call! Use 'enableRatingWidgets' in place of this call. Call will be redirected now!"),a.enableRatingWidgets(c)):b(d,a).call(a,f.WARNING,"enable_feedback, window object is not available. Not enabling feedback.")});
y(this,"enableRatingWidgets",function(c){D?(b(d,a).call(a,f.INFO,"enableRatingWidgets, Enabling rating widget with params:",c),a.check_consent("star-rating")&&(b(T,a)?b(d,a).call(a,f.ERROR,"enableRatingWidgets, Cannot enable rating widgets in offline mode"):(b(B,a).call(a,"cly_fb_widgets",c.popups||c.widgets),jc(a.url+"/star-rating/stylesheets/countly-feedback-web.css"),c=c.popups||c.widgets,0<c.length?(document.body.insertAdjacentHTML("beforeend",'<div id="cfbg"></div>'),a.initializeRatingWidgets(c)):
b(d,a).call(a,f.ERROR,"enableRatingWidgets, You should provide at least one widget id as param. Read documentation for more detail. https://resources.count.ly/plugins/feedback")))):b(d,a).call(a,f.WARNING,"enableRatingWidgets, window object is not available. Not enabling rating widgets.")});q(this,Ec,function(c,e){b(d,a).call(a,f.INFO,"showWidget, Showing ".concat(c," widget, nameIDorTag:[").concat(e,"]"));a.get_available_feedback_widgets(function(g,k){k?b(d,a).call(a,f.ERROR,"showWidget, Error while getting feedback widgets list: ".concat(k)):
(k=g.find(function(n){return n.type===c}),e&&"string"===typeof e&&(g=g.find(function(n){return n.type===c&&(n.name===e||n._id===e||n.tg.includes(e))}))&&(k=g,b(d,a).call(a,f.VERBOSE,"showWidget, Found ".concat(c," widget by name, id, or tag: [").concat(JSON.stringify(g),"]"))),k?a.present_feedback_widget(k,null,null,null):b(d,a).call(a,f.ERROR,"showWidget, No ".concat(c," widget found.")))})});y(this,"feedback",{showNPS:function(c){return b(Ec,a).call(a,"nps",c)},showSurvey:function(c){return b(Ec,
a).call(a,"survey",c)},showRating:function(c){return b(Ec,a).call(a,"rating",c)}});y(this,"get_available_feedback_widgets",function(c){b(d,a).call(a,f.INFO,"get_available_feedback_widgets, Getting the feedback list, callback function is provided:["+!!c+"]");if(a.check_consent("feedback"))if(b(T,a))b(d,a).call(a,f.ERROR,"get_available_feedback_widgets, Cannot enable feedback widgets in offline mode.");else{var e=a.url+b(Za,a),g={method:"feedback",device_id:a.device_id,app_key:a.app_key,av:a.app_version};
b(pa,a).call(a,"get_available_feedback_widgets,",e,g,function(k,n,m){if(k)c&&c(null,k);else try{var u=JSON.parse(m).result||[];c&&c(u,null)}catch(x){b(d,a).call(a,f.ERROR,"get_available_feedback_widgets, Error while parsing feedback widgets list: "+x),c&&c(null,x)}},!1)}else c&&c(null,Error("Consent for feedback not provided."))});y(this,"getFeedbackWidgetData",function(c,e){if(c.type)if(b(d,a).call(a,f.INFO,"getFeedbackWidgetData, Retrieving data for: ["+JSON.stringify(c)+"], callback function is provided:["+
!!e+"]"),a.check_consent("feedback"))if(b(T,a))b(d,a).call(a,f.ERROR,"getFeedbackWidgetData, Cannot enable feedback widgets in offline mode.");else{var g=a.url,k={widget_id:c._id,shown:1,sdk_version:b(ua,a),sdk_name:b(Ba,a),platform:a.platform,app_version:a.app_version};if("nps"===c.type)g+="/o/surveys/nps/widget";else if("survey"===c.type)g+="/o/surveys/survey/widget";else if("rating"===c.type)g+="/o/surveys/rating/widget";else{b(d,a).call(a,f.ERROR,"getFeedbackWidgetData, Unknown type info: ["+
c.type+"]");return}b(pa,a).call(a,"getFeedbackWidgetData,",g,k,function(n,m,u){if(n)e&&e(null,n);else try{var x=JSON.parse(u);e&&e(x,null)}catch(C){b(d,a).call(a,f.ERROR,"getFeedbackWidgetData, Error while parsing feedback widgets list: "+C),e&&e(null,C)}},!0)}else e&&e(null,Error("Consent for feedback not provided."));else b(d,a).call(a,f.ERROR,"getFeedbackWidgetData, Expected the provided widget object to have a type but got: ["+JSON.stringify(c)+"], aborting.")});y(this,"present_feedback_widget",
function(c,e,g,k){if(D){if(b(d,a).call(a,f.INFO,"present_feedback_widget, Presenting the feedback widget by appending to the element with ID: [ "+e+" ] and className: [ "+g+" ]"),a.check_consent("feedback"))if(!c||"object"!==W(c)||Array.isArray(c))b(d,a).call(a,f.ERROR,"present_feedback_widget, Please provide at least one feedback widget object.");else{b(d,a).call(a,f.INFO,"present_feedback_widget, Adding segmentation to feedback widgets:["+JSON.stringify(k)+"]");k&&"object"===W(k)&&0!==Object.keys(k).length||
(b(d,a).call(a,f.DEBUG,"present_feedback_widget, Segmentation is not an object or empty"),k=null);try{var n=a.url;if("nps"===c.type)b(d,a).call(a,f.DEBUG,"present_feedback_widget, Widget type: nps."),n+="/feedback/nps";else if("survey"===c.type)b(d,a).call(a,f.DEBUG,"present_feedback_widget, Widget type: survey."),n+="/feedback/survey";else if("rating"===c.type)b(d,a).call(a,f.DEBUG,"present_feedback_widget, Widget type: rating."),n+="/feedback/rating";else{b(d,a).call(a,f.ERROR,"present_feedback_widget, Feedback widget only accepts nps, rating and survey types.");
return}var m=window.origin||window.location.origin;if("rating"===c.type){b(d,a).call(a,f.DEBUG,"present_feedback_widget, Loading css for rating widget.");var u="ratings";jc(a.url+"/star-rating/stylesheets/countly-feedback-web.css")}else b(d,a).call(a,f.DEBUG,"present_feedback_widget, Loading css for survey or nps."),jc(a.url+"/surveys/stylesheets/countly-surveys.css"),u="surveys";n+="?widget_id="+c._id;n+="&app_key="+a.app_key;n+="&device_id="+a.device_id;n+="&sdk_name="+b(Ba,a);n+="&platform="+a.platform;
n+="&app_version="+a.app_version;n+="&sdk_version="+b(ua,a);var x={tc:1};k&&(x.sg=k);var C=b(qb,a).call(a,!0);x.width=C.width;x.height=C.height;n+="&custom="+JSON.stringify(x);n+="&origin="+m;n+="&widget_v=web";var F=document.createElement("iframe");F.src=n;F.name="countly-"+u+"-iframe";F.id="countly-"+u+"-iframe";var R=!1;F.onload=function(){R&&(document.getElementById("countly-"+u+"-wrapper-"+c._id).style.display="none",document.getElementById("csbg").style.display="none");R=!0;b(d,a).call(a,f.DEBUG,
"present_feedback_widget, Loaded iframe.")};for(var X=document.getElementById("csbg");X;)X.remove(),X=document.getElementById("csbg"),b(d,a).call(a,f.DEBUG,"present_feedback_widget, Removing past overlay.");var I=document.getElementsByClassName("countly-"+u+"-wrapper");for(k=0;k<I.length;k++)I[k].remove(),b(d,a).call(a,f.DEBUG,"present_feedback_widget, Removed a wrapper.");I=document.createElement("div");k="countly-"+u+"-wrapper";I.className=k+" "+k+"--"+c.type;I.id="countly-"+u+"-wrapper-"+c._id;
"survey"===c.type&&(I.className=I.className+" "+c.appearance.position);var S=document.body;k=!1;e&&(document.getElementById(e)?(S=document.getElementById(e),k=!0):b(d,a).call(a,f.ERROR,"present_feedback_widget, Provided ID not found."));k||g&&(document.getElementsByClassName(g)[0]?S=document.getElementsByClassName(g)[0]:b(d,a).call(a,f.ERROR,"present_feedback_widget, Provided class not found."));S.insertAdjacentHTML("beforeend",'<div id="csbg"></div>');S.appendChild(I);if("rating"===c.type){var J=
document.createElement("div");J.className="countly-ratings-overlay";J.id="countly-ratings-overlay-"+c._id;I.appendChild(J);b(d,a).call(a,f.DEBUG,"present_feedback_widget, appended the rating overlay to wrapper");M(document.getElementById("countly-ratings-overlay-"+c._id),"click",function(){document.getElementById("countly-ratings-wrapper-"+c._id).style.display="none"})}I.appendChild(F);b(d,a).call(a,f.DEBUG,"present_feedback_widget, Appended the iframe");M(window,"message",function(A){b(Nd,a).call(a,
A,I,F)});var Z;M(window,"resize",function(){clearTimeout(Z);Z=setTimeout(function(){var A=window.innerWidth,N=window.innerHeight,qa=document.getElementById("countly-"+u+"-iframe");qa&&qa.contentWindow.postMessage({type:"resize",width:A,height:N},"*")},200)});var ha=function(A){document.getElementById("countly-surveys-wrapper-"+A._id).style.display="block";document.getElementById("csbg").style.display="block"},Fa=function(A){for(var N=document.getElementsByClassName("countly-feedback-sticker");0<N.length;)b(d,
a).call(a,f.VERBOSE,"present_feedback_widget, Removing old stickers"),N[0].remove();A.appearance.hideS||(b(d,a).call(a,f.DEBUG,"present_feedback_widget, handling the sticker as it was not set to hidden"),N=document.createElement("div"),N.innerText=A.appearance.text,N.style.color=7>A.appearance.text_color.length?"#"+A.appearance.text_color:A.appearance.text_color,N.style.backgroundColor=7>A.appearance.bg_color.length?"#"+A.appearance.bg_color:A.appearance.bg_color,N.className="countly-feedback-sticker  "+
A.appearance.position+"-"+A.appearance.size,N.id="countly-feedback-sticker-"+A._id,document.body.appendChild(N),M(document.getElementById("countly-feedback-sticker-"+A._id),"click",function(){document.getElementById("countly-ratings-wrapper-"+A._id).style.display="flex";document.getElementById("csbg").style.display="block"}));M(document.getElementById("countly-feedback-close-icon-"+A._id),"click",function(){document.getElementById("countly-ratings-wrapper-"+A._id).style.display="none";document.getElementById("csbg").style.display=
"none"})};if("survey"===c.type){var V=!1;switch(c.showPolicy){case "afterPageLoad":"complete"===document.readyState?V||(V=!0,ha(c)):M(document,"readystatechange",function(A){"complete"!==A.target.readyState||V||(V=!0,ha(c))});break;case "afterConstantDelay":setTimeout(function(){V||(V=!0,ha(c))},1E4);break;case "onAbandon":"complete"===document.readyState?M(document,"mouseleave",function(){V||(V=!0,ha(c))}):M(document,"readystatechange",function(A){"complete"===A.target.readyState&&M(document,"mouseleave",
function(){V||(V=!0,ha(c))})});break;case "onScrollHalfwayDown":M(window,"scroll",function(){if(!V){var A=Math.max(window.scrollY,document.body.scrollTop,document.documentElement.scrollTop),N=ic();A>=N/2&&(V=!0,ha(c))}});break;default:V||(V=!0,ha(c))}}else if("nps"===c.type)document.getElementById("countly-"+u+"-wrapper-"+c._id).style.display="block",document.getElementById("csbg").style.display="block";else if("rating"===c.type){var aa=!1;"complete"===document.readyState?aa||(aa=!0,Fa(c)):M(document,
"readystatechange",function(A){"complete"!==A.target.readyState||aa||(aa=!0,Fa(c))})}}catch(A){b(d,a).call(a,f.ERROR,"present_feedback_widget, Something went wrong while presenting the widget: "+A)}}}else b(d,a).call(a,f.WARNING,"present_feedback_widget, window object is not available. Not presenting feedback widget.")});q(this,Nd,function(c,e,g){if(g&&c.source===g.contentWindow){var k={};try{k="object"===W(c.data)&&null!==c.data?c.data:JSON.parse(c.data)}catch(m){b(d,a).call(a,f.ERROR,"interpretFeedbackWidgetMessage, Error while parsing message body "+
m)}b(d,a).call(a,f.DEBUG,"interpretFeedbackWidgetMessage, Received message from widget with origin: ["+c.origin+"] and data: ["+JSON.stringify(k)+"]");k.key;c=k.resize_me;k=k.close;if(c)if(b(d,a).call(a,f.DEBUG,"interpretFeedbackWidgetMessage, Resizing iframe to: ["+JSON.stringify(c)+"]"),k=b(qb,a).call(a,!0),c.l&&c.p){var n=c.p;k.width>=k.height&&(n=c.l);e.style.height=n.h+"px";e.style.width=n.w+"px";e.style.top=n.y+"px";e.style.left=n.x+"px";g.style.height=n.h+"px";g.style.width=n.w+"px";g.style.top=
n.y+"px";g.style.left=n.x+"px"}else b(d,a).call(a,f.ERROR,"interpretFeedbackWidgetMessage, Invalid resize object");else!k||!0!==k&&1!==k||(e.style.display="none",g.style.display="none",document.getElementById("csbg").style.display="none",b(d,a).call(a,f.DEBUG,"interpretFeedbackWidgetMessage, Closed the widget"))}});y(this,"recordError",function(c,e,g){if(b(Wb,a)){if(b(d,a).call(a,f.INFO,"recordError, Recording error"),a.check_consent("crashes")&&c){g=g||b(Qb,a);var k="";"object"===W(c)?"undefined"!==
typeof c.stack?k=c.stack:("undefined"!==typeof c.name&&(k+=c.name+":"),"undefined"!==typeof c.message&&(k+=c.message+"\n"),"undefined"!==typeof c.fileName&&(k+="in "+c.fileName+"\n"),"undefined"!==typeof c.lineNumber&&(k+="on "+c.lineNumber),"undefined"!==typeof c.columnNumber&&(k+=":"+c.columnNumber)):k=c+"";if(k.length>b(Oa,a)*b(Na,a)){b(d,a).call(a,f.DEBUG,"record_error, Error stack is too long will be truncated");c=k.split("\n");c.length>b(Na,a)&&(c=c.splice(0,b(Na,a)));k=0;for(var n=c.length;k<
n;k++)c[k].length>b(Oa,a)&&(c[k]=c[k].substring(0,b(Oa,a)));k=c.join("\n")}e=!!e;c=b(dc,a).call(a);k={_resolution:c._resolution,_error:k,_app_version:c._app_version,_run:L()-b(kc,a),_not_os_specific:!0,_javascript:!0};if(n=navigator.battery||navigator.webkitBattery||navigator.mozBattery||navigator.msBattery)k._bat=Math.floor(100*n.level);"undefined"!==typeof navigator.onLine&&(k._online=!!navigator.onLine);D&&(k._background=!document.hasFocus());0<b(Ha,a).length&&(k._logs=b(Ha,a).join("\n"));l(Ha,
a,[]);k._nonfatal=e;k._view=a.getViewName();"undefined"!==typeof g&&(g=Ga(g,b(Q,a),b(O,a),b(ja,a),"record_error",b(d,a)),k._custom=g);try{var m=document.createElement("canvas").getContext("experimental-webgl");k._opengl=m.getParameter(m.VERSION)}catch(u){b(d,a).call(a,f.ERROR,"Could not get the experimental-webgl context: "+u)}e={};e.metrics=JSON.stringify({_ua:c._ua});b(Ab,a)&&"function"===typeof b(Ab,a)&&(b(d,a).call(a,f.VERBOSE,"recordError, Applying crash filter to:["+JSON.stringify(k)+"]"),k=
b(Ab,a).call(a,k),b(d,a).call(a,f.VERBOSE,"recordError, Filtered crash object:["+JSON.stringify(k)+"]"));k?(e.crash=JSON.stringify(k),b(da,a).call(a,e)):b(d,a).call(a,f.DEBUG,"recordError, Crash object was filtered out")}}else b(d,a).call(a,f.WARNING,"recordError, Crash tracking is disabled by the server config. Not tracking errors.")});q(this,fd,function(){b(d,a).call(a,f.INFO,"checkIgnore, Checking if user or visit should be ignored");a.ignore_prefetch&&D&&"undefined"!==typeof document.visibilityState&&
"prerender"===document.visibilityState&&(a.ignore_visitor=!0,b(d,a).call(a,f.DEBUG,"checkIgnore, Ignoring visit due to prerendering"));a.ignore_bots&&wd()&&(a.ignore_visitor=!0,b(d,a).call(a,f.DEBUG,"checkIgnore, Ignoring visit due to bot"))});y(this,"content",{enterContentZone:function(c){b(Va,a).call(a,void 0,c)},refreshContentZone:function(){b(Od,a).call(a)},exitContentZone:function(){b(Fc,a).call(a)}});q(this,Va,function(c,e){D?b(gb,a)&&!c?b(d,a).call(a,f.DEBUG,"content.enterContentZone, Already in content zone"):
(e&&"function"==typeof e&&(b(d,a).call(a,f.DEBUG,"content.enterContentZone, Content filter callback is provided"),l($b,a,e)),!b(yc,a)||4E3>sb()-b(yc,a)?(b(d,a).call(a,f.DEBUG,"content.enterContentZone, Not enough time passed since initialization"),setTimeout(function(){b(Va,a).call(a)},4001)):(b(d,a).call(a,f.INFO,"content.enterContentZone, Entering content zone"),l(gb,a,!0),c||b(Gc,a).call(a),l(zb,a,setInterval(function(){b(Gc,a).call(a)},b(Bb,a))))):b(d,a).call(a,f.WARNING,"content.enterContentZone, window object is not available. Not entering content zone.")});
q(this,Od,function(){b(pc,a)?(b(d,a).call(a,f.INFO,"content.refreshContentZone, Refreshing content zone"),b(Fc,a).call(a),b(wa,a).call(a),b(va,a).call(a),setTimeout(function(){b(Va,a).call(a)},1E3)):b(d,a).call(a,f.DEBUG,"content.refreshContentZone, Refresh content zone is disabled")});q(this,Fc,function(){b(gb,a)?(b(d,a).call(a,f.INFO,"content.exitContentZone, Exiting content zone"),l(gb,a,!1),b(zb,a)&&(clearInterval(b(zb,a)),b(d,a).call(a,f.DEBUG,"content.exitContentZone, content zone exited"))):
b(d,a).call(a,f.DEBUG,"content.exitContentZone, Not in content zone")});q(this,Pd,function(){b(d,a).call(a,f.DEBUG,"prepareContentRequest, forming content request");var c=b(qb,a).call(a,!0),e={l:{},p:{}},g=Math.max(c.width,c.height);c=Math.min(c.width,c.height);e.l.w=g;e.l.h=c;e.p.w=c;e.p.h=g;e={method:"queue",la:(navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage).split("-")[0],resolution:JSON.stringify(e),cly_ws:1,cly_origin:window.location.origin,dt:Vc()};
b(pb,a).call(a,e);return e});q(this,Gc,function(c){b(d,a).call(a,f.DEBUG,"sendContentRequest, sending content request");var e=b(Pd,a).call(a),g=function(k){"function"===typeof c&&c(k)};b(pa,a).call(a,"sendContentRequest,",a.url+b(Yc,a),e,function(k,n,m){if(k)g(!1);else if(m){try{var u=JSON.parse(m)}catch(F){b(d,a).call(a,f.VERBOSE,"sendContentRequest, No content to display or an error while parsing content: "+F);g(!1);return}if(u.html&&u.geo){var x={};k=u.html.indexOf("?");-1!==k&&(k=u.html.slice(k+
1),(new URLSearchParams(k)).forEach(function(F,R){x[R]=F}));if(b($b,a)&&!1===b($b,a).call(a,x))b(d,a).call(a,f.VERBOSE,"sendContentRequest, Content was filtered out by the content filter"),g(!1);else{b(Qd,a).call(a,u);clearInterval(b(zb,a));window.addEventListener("message",function(F){b(Rd,a).call(a,F)});var C;window.addEventListener("resize",function(){clearTimeout(C);C=setTimeout(function(){var F=window.innerWidth,R=window.innerHeight,X=document.getElementById(b(hb,a));X&&X.contentWindow.postMessage({type:"resize",
width:F,height:R},"*")},200)});g(!0)}}else b(d,a).call(a,f.VERBOSE,"sendContentRequest, no html content or orientation to display"),g(!1)}else b(d,a).call(a,f.VERBOSE,"sendContentRequest, no content to display"),g(!1)},!0)});q(this,Qd,function(c){try{var e=document.createElement("iframe");e.id=b(hb,a);e.src=c.html;e.style.position="absolute";-1!=c.html.indexOf("feedback/survey")&&(e.style.position="fixed");var g=c.geo.p,k=b(qb,a).call(a,!0);k.width>=k.height&&(g=c.geo.l);e.style.left=g.x+"px";e.style.top=
g.y+"px";e.style.width=g.w+"px";e.style.height=g.h+"px";e.style.border="none";e.style.zIndex="999999";document.body.appendChild(e)}catch(n){b(d,a).call(a,f.ERROR,"displayContent, Error while creating iframe for the content: "+n)}});q(this,Rd,function(c){if(-1!==a.contentWhitelist.indexOf(c.origin)&&null!==c.data&&"object"===W(c.data)){var e=document.getElementById(b(hb,a));if(e&&c.source===e.contentWindow){b(d,a).call(a,f.DEBUG,"interpretContentMessage, Received message from: ["+c.origin+"] with data: ["+
JSON.stringify(c.data)+"]");var g=c.data;c=g.close;var k=g.link,n=g.event;g=g.resize_me;if(n){b(d,a).call(a,f.DEBUG,"interpretContentMessage, Received event");1===c&&(b(d,a).call(a,f.DEBUG,"interpretContentMessage, Closing content frame for event"),b(bc,a).call(a));if(!Array.isArray(n)){if("object"===W(n))throw new TypeError('"event" is read-only');b(d,a).call(a,f.ERROR,"interpretContentMessage, Invalid event type: ["+W(n)+"]");return}for(var m=0;m<n.length;m++)b(oa,a).call(a,n[m])}k&&"string"===
typeof k&&(1===c&&(b(d,a).call(a,f.DEBUG,"interpretContentMessage, Closing content frame for link"),b(bc,a).call(a)),window.open(k,"_blank"),b(d,a).call(a,f.DEBUG,"interpretContentMessage, Opened link in new tab: [".concat(k,"]")));if(g){b(d,a).call(a,f.DEBUG,"interpretContentMessage, Resizing iframe");k=b(qb,a).call(a,!0);if(!g.l||!g.p){b(d,a).call(a,f.ERROR,"interpretContentMessage, Invalid resize object");return}n=g.p;k.width>=k.height&&(n=g.l);e.style.left=n.x+"px";e.style.top=n.y+"px";e.style.width=
n.w+"px";e.style.height=n.h+"px"}1===c&&b(bc,a).call(a)}}});q(this,bc,function(){var c=document.getElementById(b(hb,a));c&&(c.remove(),b(d,a).call(a,f.DEBUG,"interpretContentMessage, removed iframe"),b(gb,a)&&b(Va,a).call(a,!0))});q(this,va,function(){0<b(Y,a).length&&(b(d,a).call(a,f.DEBUG,"Flushing events"),b(da,a).call(a,{events:JSON.stringify(b(Y,a))}),l(Y,a,[]),b(B,a).call(a,"cly_event",b(Y,a)))});q(this,Hc,function(c,e){if(D)if(document.getElementById("countly-feedback-sticker-"+c._id))b(d,
a).call(a,f.ERROR,"Widget with same ID exists");else try{var g=document.createElement("div");g.className="countly-iframe-wrapper";g.id="countly-iframe-wrapper-"+c._id;var k=document.createElement("span");k.className="countly-feedback-close-icon";k.id="countly-feedback-close-icon-"+c._id;k.innerText="x";var n=document.createElement("iframe");n.name="countly-feedback-iframe";n.id="countly-feedback-iframe";n.src=a.url+"/feedback?widget_id="+c._id+"&app_key="+a.app_key+"&device_id="+a.device_id+"&sdk_version="+
b(ua,a);document.body.appendChild(g);g.appendChild(k);g.appendChild(n);M(document.getElementById("countly-feedback-close-icon-"+c._id),"click",function(){document.getElementById("countly-iframe-wrapper-"+c._id).style.display="none";document.getElementById("cfbg").style.display="none"});if(e){var m=document.createElementNS("http://www.w3.org/2000/svg","svg");m.id="feedback-sticker-svg";m.setAttribute("aria-hidden","true");m.setAttribute("data-prefix","far");m.setAttribute("data-icon","grin");m.setAttribute("class",
"svg-inline--fa fa-grin fa-w-16");m.setAttribute("role","img");m.setAttribute("xmlns","http://www.w3.org/2000/svg");m.setAttribute("viewBox","0 0 496 512");var u=document.createElementNS("http://www.w3.org/2000/svg","path");u.id="smileyPathInStickerSvg";u.setAttribute("fill","white");u.setAttribute("d","M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm105.6-151.4c-25.9 8.3-64.4 13.1-105.6 13.1s-79.6-4.8-105.6-13.1c-9.9-3.1-19.4 5.4-17.7 15.3 7.9 47.1 71.3 80 123.3 80s115.3-32.9 123.3-80c1.6-9.8-7.7-18.4-17.7-15.3zM168 240c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm160 0c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32z");
var x=document.createElement("span");x.innerText=c.trigger_button_text;var C=document.createElement("div");C.style.color=7>c.trigger_font_color.length?"#"+c.trigger_font_color:c.trigger_font_color;C.style.backgroundColor=7>c.trigger_bg_color.length?"#"+c.trigger_bg_color:c.trigger_bg_color;C.className="countly-feedback-sticker  "+c.trigger_position+"-"+c.trigger_size;C.id="countly-feedback-sticker-"+c._id;m.appendChild(u);C.appendChild(m);C.appendChild(x);document.body.appendChild(C);var F=document.getElementById("smileyPathInStickerSvg");
F&&(F.style.fill=7>c.trigger_font_color.length?"#"+c.trigger_font_color:c.trigger_font_color);M(document.getElementById("countly-feedback-sticker-"+c._id),"click",function(){document.getElementById("countly-iframe-wrapper-"+c._id).style.display="block";document.getElementById("cfbg").style.display="block"})}else document.getElementById("countly-iframe-wrapper-"+c._id).style.display="block",document.getElementById("cfbg").style.display="block"}catch(R){b(d,a).call(a,f.ERROR,"Somethings went wrong while element injecting process: "+
R)}else b(d,a).call(a,f.WARNING,"processWidget, window object is not available. Not processing widget.")});q(this,gd,function(){var c;if("undefined"!==typeof a.onload&&0<a.onload.length){for(c=0;c<a.onload.length;c++)if("function"===typeof a.onload[c])a.onload[c](a);a.onload=[]}});q(this,Ic,function(){if(b(ia,a))if(b(Vb,a)){b(d,a).call(a,f.INFO,"reportViewDuration, Reporting view duration for: ["+b(ia,a)+"]");var c={name:b(ia,a)};a.check_consent("views")&&(b(oa,a).call(a,{key:ca.VIEW,dur:b(Ja,a)?
L()-b(ab,a):b(bb,a),segmentation:c},b(La,a)),l(ia,a,null))}else b(d,a).call(a,f.INFO,"reportViewDuration, View tracking is disabled by the server config. Not tracking view duration");else b(d,a).call(a,f.INFO,"reportViewDuration, No last view, will not report view duration")});q(this,Sd,function(){b(d,a).call(a,f.INFO,"getLastView, Getting last view: ["+b(ia,a)+"]");return b(ia,a)});q(this,hd,function(){if(b(za,a)){b(d,a).call(a,f.DEBUG,"Extending session");var c=b(E,a).call(a,"cly_session");if(!c||
parseInt(c)<=L())l(na,a,!1),a.begin_session(!b($a,a));b(B,a).call(a,"cly_session",L()+60*b(db,a))}else b(d,a).call(a,f.DEBUG,"Will not extend the session as session cookie is disabled")});q(this,pb,function(c){c.app_key=a.app_key;c.device_id=a.device_id;c.sdk_name=b(Ba,a);c.sdk_version=b(ua,a);c.t=b(P,a);c.av=a.app_version;var e=b(jd,a).call(a);if(c.metrics){var g=JSON.parse(c.metrics);g._ua||(g._ua=e,c.metrics=JSON.stringify(g))}else c.metrics=JSON.stringify({_ua:e});a.check_consent("location")&&
b(oc,a)?(a.country_code&&(c.country_code=a.country_code),a.city&&(c.city=a.city),null!==a.ip_address&&(c.ip_address=a.ip_address)):c.location="";c.timestamp=sb();b(Zb,a)&&(b(d,a).call(a,f.DEBUG,"prepareRequest, testing timestamp is set to: "+b(Zb,a)),c.timestamp=b(Zb,a));e=new Date;c.hour=e.getHours();c.dow=e.getDay();c.tz=-e.getTimezoneOffset()});q(this,da,function(c){a.ignore_visitor?b(d,a).call(a,f.DEBUG,"User is opt_out will ignore the request: "+c):b(Cb,a)?a.app_key&&a.device_id?(b(pb,a).call(a,
c),b(K,a).length>b(Ca,a)&&b(K,a).shift(),b(K,a).push(c),b(B,a).call(a,"cly_queue",b(K,a),!0)):b(d,a).call(a,f.ERROR,"app_key or device_id is missing ",a.app_key,a.device_id):b(d,a).call(a,f.DEBUG,"Tracking is disabled by server config, will not track the request: "+JSON.stringify(c))});q(this,cc,function(){b(gd,a).call(a);if(a.ignore_visitor)l(xb,a,!1),b(d,a).call(a,f.WARNING,"User opt_out:["+a.ignore_visitor+"], no heartbeat");else{l(xb,a,!0);b(ub,a)&&"undefined"!==typeof w.q&&0<w.q.length&&b(wa,
a).call(a);if(b(na,a)&&b($a,a)&&b(Ja,a)){var c=L();c-b(ya,a)>b(ib,a)&&(a.session_duration(c-b(ya,a)),l(ya,a,c),0<a.hcErrorCount&&b(B,a).call(a,ba.errorCount,a.hcErrorCount),0<a.hcWarningCount&&b(B,a).call(a,ba.warningCount,a.hcWarningCount))}0<b(Y,a).length&&!a.test_mode_eq&&(b(Y,a).length<=b(Sa,a)?(b(da,a).call(a,{events:JSON.stringify(b(Y,a))}),l(Y,a,[])):(c=b(Y,a).splice(0,b(Sa,a)),b(da,a).call(a,{events:JSON.stringify(c)})),b(B,a).call(a,"cly_event",b(Y,a)));c=L();var e=!1;b(Da,a)&&c<b(Ta,a)?
(e=!0,b(Xb,a)||(b(d,a).call(a,f.VERBOSE,"Request back-off active, suspending requests until: "+b(Ta,a)+", current time: "+c),l(Xb,a,!0))):b(Da,a)&&c>=b(Ta,a)&&(b(d,a).call(a,f.INFO,"Request back-off period ended, resuming normal request processing"),l(Da,a,!1),l(Ta,a,0),e=!1,l(Xb,a,!1));!e&&!b(T,a)&&0<b(K,a).length&&b(Ia,a)&&L()>b(Pa,a)&&(b(d,a).call(a,f.DEBUG,"Processing request",b(K,a)[0]),a.test_mode||b(id,a).call(a,"send_request_queue"));setTimeout(function(){b(cc,a).call(a)},b(vb,a))}});q(this,
Td,function(c){if(b(qc,a)&&!b(Da,a)){var e=b(lb,a)>b(rc,a);if(e){var g=b(K,a).length<b(Ca,a)*b(sc,a),k=L();c=k-(c&&c.timestamp?c.timestamp:k);var n=c<3600*b(tc,a);e&&g&&n?(b(d,a).call(a,f.INFO,"Activating request back-off: response time ["+b(lb,a)+"s], queue size ["+b(K,a).length+"/"+b(Ca,a)+"], request age ["+c+"s]"),l(Da,a,!0),l(Ta,a,k+b(uc,a)),b(xa,a).incrementBackoffCount(),b(d,a).call(a,f.INFO,"Request back-off activated until: "+b(Ta,a))):(b(d,a).call(a,f.DEBUG,"No back-off conditions met: response time ["+
b(lb,a)+"s], queue size ["+b(K,a).length+"/"+b(Ca,a)+"], request age ["+c+"s]"),b(xa,a).resetLastRequestBackoffStatus())}}});q(this,Ud,function(){return b(Ub,a)});q(this,id,function(c,e){return new Promise(function(g){if(b(T,a))g(!1);else if(0===b(K,a).length)g(!1);else if(!b(Ia,a)||b(Da,a)||L()<=b(Pa,a))g(!1);else{l(Ia,a,!1);var k=b(K,a)[0];k.rr=b(K,a).length;b(B,a).call(a,"cly_queue",b(K,a),!0);b(pa,a).call(a,c,a.url+b(Pb,a),k,function(n,m){if(n)l(Pa,a,L()+b(wb,a));else if(b(K,a).shift(),b(Td,a).call(a,
m),e)try{e(m)}catch(u){b(d,a).call(a,f.DEBUG,"sendRequestFromQueue, onSuccess handler threw")}b(B,a).call(a,"cly_queue",b(K,a),!0);l(Ia,a,!0);g(!n)},!1)}})});q(this,wa,function(){if("undefined"===typeof w||"undefined"===typeof w.i)b(d,a).call(a,f.DEBUG,"Countly is not finished initialization yet, will process the queue after initialization is done");else{var c=w.q;w.q=[];for(var e=0;e<c.length;e++){var g=c[e];b(d,a).call(a,f.DEBUG,"Processing queued calls:"+g);if("function"===typeof g)g();else if(Array.isArray(g)&&
0<g.length){var k=a,n=0;try{w.i[g[n]]&&(k=w.i[g[n]],n++)}catch(u){b(d,a).call(a,f.DEBUG,"No instance found for the provided key while processing async queue");w.q.push(g);continue}if("function"===typeof k[g[n]])k[g[n]].apply(k,g.slice(n+1));else if(0===g[n].indexOf("userData.")){var m=g[n].replace("userData.","");"function"===typeof k.userData[m]&&k.userData[m].apply(k,g.slice(n+1))}else 0===g[n].indexOf("content.")?(m=g[n].replace("content.",""),"function"===typeof k.content[m]&&k.content[m].apply(k,
g.slice(n+1))):0===g[n].indexOf("feedback.")?(m=g[n].replace("feedback.",""),"function"===typeof k.feedback[m]&&k.feedback[m].apply(k,g.slice(n+1))):"function"===typeof w[g[n]]&&w[g[n]].apply(w,g.slice(n+1))}}}});q(this,Jc,function(){var c=b(E,a).call(a,"cly_id");return c?(l(P,a,b(E,a).call(a,"cly_id_type")),c):Rc()});q(this,Vd,function(c){return/[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-4[0-9a-fA-F]{3}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}/.test(c)});q(this,jd,function(){return a.metrics&&a.metrics._ua?a.metrics._ua:
tb()});q(this,dc,function(){var c=JSON.parse(JSON.stringify(a.metrics||{}));c._app_version=c._app_version||a.app_version;c._ua=c._ua||tb();var e=b(qb,a).call(a);e&&(e=""+e.width+"x"+e.height,c._resolution=c._resolution||e);D&&window.devicePixelRatio&&(c._density=c._density||window.devicePixelRatio);e=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;"undefined"!==typeof e&&(c._locale=c._locale||e);b(Kc,a).call(a)&&(c._store=c._store||document.referrer);
b(d,a).call(a,f.DEBUG,"Got metrics",c);return c});q(this,qb,function(c){b(d,a).call(a,f.DEBUG,"Getting the resolution of the device");if(!D||!screen)return b(d,a).call(a,f.DEBUG,"No screen available"),null;var e=screen.width?parseInt(screen.width):0,g=screen.height?parseInt(screen.height):0;if(c){c=Math.min(window.innerWidth,document.documentElement.clientWidth);var k=Math.min(window.innerHeight,document.documentElement.clientHeight);e=c?parseInt(c):e;g=k?parseInt(k):g}if(0===e||0===g)return b(d,
a).call(a,f.DEBUG,"Screen width or height is non existent"),null;navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)&&window.devicePixelRatio&&(b(d,a).call(a,f.VERBOSE,"Mobile Mac device detected, adjusting resolution"),e=Math.round(e*window.devicePixelRatio),g=Math.round(g*window.devicePixelRatio));return{width:e,height:g}});q(this,Kc,function(c){if(!D)return!1;c=c||document.referrer;var e=!1;if("undefined"===typeof c||0===c.length)b(d,a).call(a,f.DEBUG,"Invalid referrer:["+c+"], ignoring.");
else{var g=Dd.exec(c);if(g)if(g[11])if(g[11]===window.location.hostname)b(d,a).call(a,f.DEBUG,"Referrer is current host:["+c+"], ignoring.");else if(b(sa,a)&&b(sa,a).length)for(e=!0,g=0;g<b(sa,a).length;g++){if(0<=c.indexOf(b(sa,a)[g])){b(d,a).call(a,f.DEBUG,"Referrer in ignore list:["+c+"], ignoring.");e=!1;break}}else b(d,a).call(a,f.DEBUG,"Valid referrer:["+c+"]"),e=!0;else b(d,a).call(a,f.DEBUG,"No path found in referrer:["+c+"], ignoring.");else b(d,a).call(a,f.DEBUG,"Referrer is corrupt:["+
c+"], ignoring.")}return e});q(this,d,function(c,e,g){if(a.debug&&"undefined"!==typeof console){g&&"object"===W(g)&&(g=JSON.stringify(g));b(ub,a)||(e="["+a.app_key+"] "+e);c||(c=f.DEBUG);var k="";g&&(k=" "+g);e=c+"[Countly] "+e+k;c===f.ERROR?(console.error(e),b(xa,a).incrementErrorCount()):c===f.WARNING?(console.warn(e),b(xa,a).incrementWarningCount()):c===f.INFO?console.info(e):c===f.VERBOSE?console.log(e):console.debug(e)}});q(this,pa,function(c,e,g,k,n,m){if(b(lc,a)||m)if(b(Ub,a).push({functionName:c,
url:e,params:g}),b(ob,a)){b(d,a).call(a,f.DEBUG,c+" Using fake request handler");try{var u=b(ob,a).call(a,{functionName:c,url:e,params:g});void 0===u&&(u={status:200,responseText:'{"result":"Success"}'});if(!1!==u){var x=200>u.status||300<=u.status;"function"===typeof k&&k(x,g,u.responseText)}}catch(C){b(d,a).call(a,f.ERROR,c+" Fake request handler error: "+C),"function"===typeof k&&k(!0,g,"fake_handler_error")}}else D?b(kd,a).call(a,c,e,g,k,n):b(md,a).call(a,c,e,g,k,n);else b(d,a).call(a,f.DEBUG,
"Network request is disabled by the SCNetwork")});q(this,kd,function(c,e,g,k,n){n=n||!1;try{b(d,a).call(a,f.DEBUG,"Sending XML HTTP request");var m=new XMLHttpRequest;m.ontimeout=function(){b(d,a).call(a,f.ERROR,c+" timed out after 30 seconds");"function"===typeof k&&k(!0,g,"timeout")};g=g||{};var u=g._forceImageUpload||!0===g.__imageUpload||g.imageData&&(g.imageName||g.imageType),x=g;if(u){var C={},F;for(F in g)Object.prototype.hasOwnProperty.call(g,F)&&"__imageUpload"!==F&&"imageData"!==F&&"imageName"!==
F&&"imageType"!==F&&"type"!==F&&(C[F]=g[F]);x=C}Tc(x,a.salt).then(function(R){var X="POST";if(a.force_post||2E3<=R.length)X="POST";u?m.open("POST",e,!0):"GET"===X?m.open("GET",e+"?"+R,!0):(m.open("POST",e,!0),m.setRequestHeader("Content-type","application/x-www-form-urlencoded"));try{"timeout"in m&&(m.timeout=b(zc,a))}catch(J){b(d,a).call(a,f.DEBUG,c+" could not set xhr.timeout: "+J)}for(var I in a.headers)Object.prototype.hasOwnProperty.call(a.headers,I)&&(u&&"content-type"===I.toLowerCase()||m.setRequestHeader(I,
a.headers[I]));var S=L();m.onreadystatechange=function(){if(4===m.readyState){var J=L()-S;l(lb,a,J);b(d,a).call(a,f.DEBUG,c+" HTTP request completed with status code: ["+m.status+"] and response: ["+m.responseText+"], duration: ["+J+"] seconds");(n?b(Mc,a).call(a,m.status,m.responseText):b(Lc,a).call(a,m.status,m.responseText))?"function"===typeof k&&k(!1,g,m.responseText):(b(d,a).call(a,f.ERROR,c+" Invalid response from server"),"send_request_queue"===c&&b(xa,a).saveRequestCounters(m.status,m.responseText),
"function"===typeof k&&k(!0,g,m.status,m.responseText))}};u?(R=b(ld,a).call(a,g,R))?m.send(R):"function"===typeof k&&k(!0,g,"invalid_formdata"):"GET"===X?m.send():m.send(R)})}catch(R){b(d,a).call(a,f.ERROR,c+" Something went wrong while making an XML HTTP request: "+R),"function"===typeof k&&k(!0,g)}});q(this,Wd,function(c,e){if(!c)return null;try{if("function"===typeof atob){var g=atob(c),k=g.length,n=new Uint8Array(k);for(c=0;c<k;c++)n[c]=g.charCodeAt(c);if("undefined"!==typeof Blob)return new Blob([n],
{type:e||"application/octet-stream"});if("undefined"!==typeof File)try{return new File([n],"avatar",{type:e||"application/octet-stream"})}catch(u){b(d,a).call(a,f.DEBUG,"createBlobFromBase64: Unable to create File instance: "+u)}}else if("undefined"!==typeof Buffer){var m=Buffer.from(c,"base64");if("undefined"!==typeof Blob)return new Blob([m],{type:e||"application/octet-stream"});if("undefined"!==typeof File)try{return new File([m],"avatar",{type:e||"application/octet-stream"})}catch(u){b(d,a).call(a,
f.DEBUG,"createBlobFromBase64: Unable to create File instance from buffer: "+u)}}}catch(u){b(d,a).call(a,f.ERROR,"createBlobFromBase64 failed: "+u)}return null});q(this,ld,function(c,e){if(!c||!c.imageData)return null;var g=b(Wd,a).call(a,c.imageData,c.imageType);if(!g||"undefined"===typeof FormData)return null;var k=new FormData;k.append("user_details[picture]",g,c.imageName||"avatar");if(e&&"string"===typeof e)for(c=e.split("&"),e=0;e<c.length;e++){var n=c[e];if(n){var m=n.indexOf("=");g=0<=m?n.substring(0,
m):n;n=0<=m?n.substring(m+1):"";k.append(g,n)}}return k});q(this,md,function(c,e,g,k,n){n=n||!1;var m;try{b(d,a).call(a,f.DEBUG,"Sending Fetch request");var u="POST",x={"Content-type":"application/x-www-form-urlencoded"},C=null;g=g||{};var F=g._forceImageUpload||!0===g.__imageUpload||g.imageData&&(g.imageName||g.imageType),R=g;if(F){var X={},I;for(I in g)Object.prototype.hasOwnProperty.call(g,I)&&"__imageUpload"!==I&&"imageData"!==I&&"imageName"!==I&&"imageType"!==I&&"type"!==I&&(X[I]=g[I]);R=X}Tc(R,
a.salt).then(function(S){a.force_post||2E3<=S.length?(u="POST",C=S):e+="?"+S;for(var J in a.headers)x[J]=a.headers[J];var Z=L(),ha=new AbortController;J=ha.signal;var Fa=setTimeout(function(){return ha.abort()},b(zc,a)),V=C,aa=e;if(F){S=b(ld,a).call(a,g,S);if(!S){clearTimeout(Fa);"function"===typeof k&&k(!0,g,"invalid_formdata");return}x["Content-type"]&&delete x["Content-type"];V=S;aa=e.split("?")[0]}fetch(aa,{method:u,headers:x,body:V,signal:J}).then(function(A){clearTimeout(Fa);m=A;return m.text()}).then(function(A){var N=
L()-Z;l(lb,a,N);F?b(d,a).call(a,f.DEBUG,c+" image Fetch upload completed with status code: ["+m.status+"] and response: ["+A+"], duration: ["+N+"] seconds"):b(d,a).call(a,f.DEBUG,c+" Fetch request completed wit status code: ["+m.status+"] and response: ["+A+"], duration: ["+N+"] seconds");(n?b(Mc,a).call(a,m.status,A):b(Lc,a).call(a,m.status,A))?"function"===typeof k&&k(!1,g,A):(b(d,a).call(a,f.ERROR,c+" Invalid response from server"),"send_request_queue"===c&&b(xa,a).saveRequestCounters(m.status,
A),"function"===typeof k&&k(!0,g,m.status,A))})["catch"](function(A){clearTimeout(Fa);"AbortError"===A.name?(b(d,a).call(a,f.ERROR,c+" timed out after 30 seconds"),"function"===typeof k&&k(!0,g,"timeout")):(b(d,a).call(a,f.ERROR,c+" Failed Fetch request: "+A),"function"===typeof k&&k(!0,g))})})}catch(S){b(d,a).call(a,f.ERROR,c+" Something went wrong with the Fetch request attempt: "+S),"function"===typeof k&&k(!0,g)}});q(this,Lc,function(c,e){if(!(200<=c&&300>c))return b(d,a).call(a,f.ERROR,"Http response status code:["+
c+"] is not within the expected range"),!1;try{var g=JSON.parse(e);return"[object Object]"!==Object.prototype.toString.call(g)?(b(d,a).call(a,f.ERROR,"Http response is not JSON Object"),!1):!!g.result}catch(k){return b(d,a).call(a,f.ERROR,"Http response is not JSON: "+k),!1}});q(this,Mc,function(c,e){if(!(200<=c&&300>c))return b(d,a).call(a,f.ERROR,"Http response status code:["+c+"] is not within the expected range"),!1;try{var g=JSON.parse(e);return"[object Object]"===Object.prototype.toString.call(g)||
Array.isArray(g)||"No content block found!"===g?!0:(b(d,a).call(a,f.ERROR,"Http response is not JSON Object nor JSON Array"),!1)}catch(k){return b(d,a).call(a,f.ERROR,"Http response is not JSON: "+k),!1}});q(this,nd,function(){D?l(fb,a,Math.max(b(fb,a),window.scrollY,document.body.scrollTop,document.documentElement.scrollTop)):b(d,a).call(a,f.WARNING,"processScroll, window object is not available. Not processing scroll.")});q(this,Nc,function(){if(!D)b(d,a).call(a,f.WARNING,"processScrollView, window object is not available. Not processing scroll view.");
else if(b(eb,a)){l(eb,a,!1);var c=ic(),e=Xc(),g=xd();a.check_consent("scrolls")&&(c={type:"scroll",y:b(fb,a)+g,width:e,height:c,view:a.getViewUrl()},c=Ga(c,b(Q,a),b(O,a),b(ja,a),"processScrollView",b(d,a)),a.track_domains&&(c.domain=window.location.hostname),b(oa,a).call(a,{key:ca.ACTION,segmentation:c}))}});q(this,Xd,function(){return b(P,a)});q(this,od,function(c){b(B,a).call(a,"cly_token",c)});q(this,Yd,function(){var c=b(E,a).call(a,"cly_token");b(ka,a).call(a,"cly_token");return c});q(this,Zd,
function(){return b(Y,a)});q(this,$d,function(){return b(K,a)});q(this,ae,function(c){c+="=";for(var e=document.cookie.split(";"),g=0,k=e.length;g<k;g++){for(var n=e[g];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(c))return n.substring(c.length,n.length)}return null});q(this,pd,function(c,e,g){var k=new Date;k.setTime(k.getTime()+864E5*g);g="; expires="+k.toGMTString();document.cookie=c+"="+e+g+"; path=/"});q(this,E,function(c,e,g){if("none"===a.storage||"object"!==W(a.storage)&&
!D)b(d,a).call(a,f.DEBUG,"Storage is disabled. Value with key: ["+c+"] won't be retrieved");else{g||(c=a.app_key+"/"+c,a.namespace&&(c=Ya(a.namespace)+"/"+c));if(a.storage&&"object"===W(a.storage)&&"function"===typeof a.storage.getItem){var k=a.storage.getItem(c);return c.endsWith("cly_id")?k:a.deserialize(k)}void 0===e&&(e=b(Ka,a));try{return e?k=localStorage.getItem(c):"localstorage"!==a.storage&&(k=b(ae,a).call(a,c)),c.endsWith("cly_id")?k:a.deserialize(k)}catch(n){}}});q(this,B,function(c,e,g,
k){if("none"===a.storage||"object"!==W(a.storage)&&!D)b(d,a).call(a,f.DEBUG,"Storage is disabled. Value with key: "+c+" won't be stored");else{k||(c=a.app_key+"/"+c,a.namespace&&(c=Ya(a.namespace)+"/"+c));try{"undefined"!==typeof e&&null!==e&&("object"===W(a.storage)&&"function"===typeof a.storage.setItem?a.storage.setItem(c,e):(void 0===g&&(g=b(Ka,a)),e=a.serialize(e),g?localStorage.setItem(c,e):"localstorage"!==a.storage&&b(pd,a).call(a,c,e,30)))}catch(n){}}});q(this,ka,function(c,e,g){if("none"===
a.storage||"object"!==W(a.storage)&&!D)b(d,a).call(a,f.DEBUG,"Storage is disabled. Value with key: "+c+" won't be removed");else{g||(c=a.app_key+"/"+c,a.namespace&&(c=Ya(a.namespace)+"/"+c));try{"object"===W(a.storage)&&"function"===typeof a.storage.removeItem?a.storage.removeItem(c):(void 0===e&&(e=b(Ka,a)),e?localStorage.removeItem(c):"localstorage"!==a.storage&&b(pd,a).call(a,c,"",-1))}catch(k){}}});q(this,be,function(){if(b(E,a).call(a,a.namespace+"cly_id",!1,!0)){b(B,a).call(a,"cly_id",b(E,a).call(a,
a.namespace+"cly_id",!1,!0));b(B,a).call(a,"cly_id_type",b(E,a).call(a,a.namespace+"cly_id_type",!1,!0));b(B,a).call(a,"cly_event",b(E,a).call(a,a.namespace+"cly_event",!1,!0));b(B,a).call(a,"cly_session",b(E,a).call(a,a.namespace+"cly_session",!1,!0));var c=b(E,a).call(a,a.namespace+"cly_queue",!1,!0);Array.isArray(c)&&(c=c.filter(function(e){return e.app_key===a.app_key}),b(B,a).call(a,"cly_queue",c));b(E,a).call(a,a.namespace+"cly_cmp_id",!1,!0)&&(b(B,a).call(a,"cly_cmp_id",b(E,a).call(a,a.namespace+
"cly_cmp_id",!1,!0)),b(B,a).call(a,"cly_cmp_uid",b(E,a).call(a,a.namespace+"cly_cmp_uid",!1,!0)));b(E,a).call(a,a.namespace+"cly_ignore",!1,!0)&&b(B,a).call(a,"cly_ignore",b(E,a).call(a,a.namespace+"cly_ignore",!1,!0));b(ka,a).call(a,"cly_id",!1,!0);b(ka,a).call(a,"cly_id_type",!1,!0);b(ka,a).call(a,"cly_event",!1,!0);b(ka,a).call(a,"cly_session",!1,!0);b(ka,a).call(a,"cly_queue",!1,!0);b(ka,a).call(a,"cly_cmp_id",!1,!0);b(ka,a).call(a,"cly_cmp_uid",!1,!0);b(ka,a).call(a,"cly_ignore",!1,!0)}});q(this,
ce,function(c,e){b(d,a).call(a,f.DEBUG,"onStorageChange, Applying storage changes for key:",c);b(d,a).call(a,f.DEBUG,"onStorageChange, Applying storage changes for value:",e);switch(c){case "cly_queue":l(K,a,a.deserialize(e||"[]"));break;case "cly_event":l(Y,a,a.deserialize(e||"[]"));break;case "cly_remote_configs":l(ea,a,a.deserialize(e||"{}"));break;case "cly_ignore":a.ignore_visitor=a.deserialize(e);break;case "cly_config":l(Ma,a,a.deserialize(e||"{}"));b(Bc,a).call(a,b(Ma,a));break;case "cly_id":a.device_id=
e;break;case "cly_id_type":l(P,a,a.deserialize(e))}});q(this,de,function(){l(K,a,[]);b(B,a).call(a,"cly_queue",[]);l(Y,a,[]);b(B,a).call(a,"cly_event",[])});q(this,ee,function(){return{eventQ:b(Y,a),requestQ:b(K,a)}});y(this,"_internals",{store:b(B,this),getDocWidth:Xc,getDocHeight:ic,getViewportHeight:xd,get_page_coord:Wc,get_event_target:hc,add_event_listener:M,createNewObjectFromProperties:Nb,truncateObject:Ga,truncateSingleValue:H,stripTrailingSlash:Ya,prepareParams:Tc,sendXmlHttpRequest:b(kd,
this),isResponseValid:b(Lc,this),getInternalDeviceIdType:b(Xd,this),getMsTimestamp:sb,getTimestamp:L,isResponseValidBroad:b(Mc,this),secureRandom:Qc,log:b(d,this),checkIfLoggingIsOn:gc,getMetrics:b(dc,this),getUA:b(jd,this),prepareRequest:b(pb,this),generateUUID:Rc,sendEventsForced:b(va,this),isUUID:b(Vd,this),calculateChecksum:vd,isReferrerUsable:b(Kc,this),getId:b(Jc,this),heartBeat:b(cc,this),toRequestQueue:b(da,this),reportViewDuration:b(Ic,this),loadJS:zd,loadCSS:jc,getLastView:b(Sd,this),setToken:b(od,
this),getToken:b(Yd,this),showLoader:Ad,hideLoader:Bd,setValueInStorage:b(B,this),getValueFromStorage:b(E,this),removeValueFromStorage:b(ka,this),add_cly_events:b(oa,this),processScrollView:b(Nc,this),processScroll:b(nd,this),currentUserAgentString:tb,currentUserAgentDataString:Uc,userAgentDeviceDetection:Vc,userAgentSearchBotDetection:wd,getRequestQueue:b($d,this),getEventQueue:b(Zd,this),sendFetchRequest:b(md,this),processAsyncQueue:b(wa,this),makeNetworkRequest:b(pa,this),onStorageChange:b(ce,
this),clearQueue:b(de,this),getLocalQueues:b(ee,this),testingGetRequests:b(Ud,this),setFakeRequestHandler:function(c){l(ob,a,c)},getFakeRequestHandler:function(){return b(ob,a)},closeContent:function(){return b(bc,a).call(a)}});q(this,xa,{sendInstantHCRequest:function(){if(b(T,a))b(d,a).call(a,f.DEBUG,"sendInstantHCRequest, Offline mode is active. Not sending health check request."),l(Tb,a,!0);else{var c=H(a.hcErrorMessage,1E3,"healthCheck",b(d,a));""!==c&&(c=JSON.stringify(c));c={hc:JSON.stringify({el:a.hcErrorCount,
wl:a.hcWarningCount,sc:a.hcStatusCode,em:c,bom:a.hcBackoffCount,cbom:a.hcConsecutiveBackoffCount}),metrics:JSON.stringify({_app_version:a.app_version})};b(pb,a).call(a,c);b(pa,a).call(a,"[healthCheck]",a.url+b(Pb,a),c,function(e){e||b(xa,a).resetAndSaveCounters()},!0)}},resetAndSaveCounters:function(){b(xa,a).resetCounters();b(B,a).call(a,ba.errorCount,a.hcErrorCount);b(B,a).call(a,ba.warningCount,a.hcWarningCount);b(B,a).call(a,ba.statusCode,a.hcStatusCode);b(B,a).call(a,ba.errorMessage,a.hcErrorMessage);
b(B,a).call(a,ba.backoffCount,a.hcBackoffCount);b(B,a).call(a,ba.consecutiveBackoffCount,a.hcConsecutiveBackoffCount)},incrementErrorCount:function(){a.hcErrorCount++},incrementWarningCount:function(){a.hcWarningCount++},incrementBackoffCount:function(){a.hcBackoffCount++;b(Yb,a)&&a.hcConsecutiveBackoffCount++;l(Yb,a,!0);b(B,a).call(a,ba.backoffCount,a.hcBackoffCount);b(B,a).call(a,ba.consecutiveBackoffCount,a.hcConsecutiveBackoffCount)},resetLastRequestBackoffStatus:function(){l(Yb,a,!1)},resetCounters:function(){a.hcErrorCount=
0;a.hcWarningCount=0;a.hcStatusCode=-1;a.hcErrorMessage="";a.hcBackoffCount=0;a.hcConsecutiveBackoffCount=0},saveRequestCounters:function(c,e){a.hcStatusCode=c;a.hcErrorMessage=e;b(B,a).call(a,ba.statusCode,a.hcStatusCode);b(B,a).call(a,ba.errorMessage,a.hcErrorMessage)}});l(Ed,this,this);l(ub,this,!w.i);l(na,this,!1);l(Pb,this,"/i");l(Za,this,"/o/sdk");l(K,this,[]);l(Y,this,[]);l(ea,this,{});l(Ha,this,[]);l(ra,this,{});l(Qb,this,null);l($a,this,!0);b(ya,this);l(Rb,this,0);l(ia,this,null);l(ab,this,
0);l(bb,this,0);l(Pa,this,0);l(Qa,this,0);l(Ia,this,!0);l(lb,this,0);l(Ta,this,0);l(Da,this,!1);l(xb,this,!1);l(ta,this,{});l(Ja,this,!0);l(kc,this,L());l(Ka,this,!0);l(Ra,this,null);l(P,this,1);l(eb,this,!1);l(fb,this,0);l(Sb,this,!1);l(La,this,null);l(yb,this,null);l(Aa,this,null);l(Tb,this,!1);l(Ub,this,[]);l(Yc,this,"/o/sdk/content");l(gb,this,!1);l(zb,this,null);l(hb,this,"cly-content-iframe");l(Ab,this,null);l(lc,this,!0);l(Ca,this,z("queue_size",r,1E3));l(Sa,this,z("max_events",r,100));l(ib,
this,z("session_update",r,60));l(Bb,this,1E3*Math.max(z("content_zone_timer_interval",r,30),15));l(mc,this,4);l(Cb,this,!0);l(Db,this,!0);l(Wb,this,!0);l(Vb,this,!0);l(nc,this,!0);l(oc,this,!0);l(Eb,this,!1);l(pc,this,!0);l(jb,this,z("require_consent",r,!1));l(Q,this,z("max_key_length",r,128));l(O,this,z("max_value_size",r,256));l(ja,this,z("max_segmentation_values",r,100));l(kb,this,z("max_breadcrumb_count",r,100));l(Na,this,z("max_stack_trace_lines_per_thread",r,30));l(Oa,this,z("max_stack_trace_line_length",
r,200));l(qc,this,!z("disable_backoff_mechanism",r,!1));l(rc,this,10);l(sc,this,.5);l(tc,this,24);l(uc,this,60);l(Fb,this,[]);l(Gb,this,[]);l(Hb,this,[]);l(Ib,this,[]);l(Jb,this,[]);l(Kb,this,[]);l(vc,this,{});l(wc,this,{});l(Lb,this,[]);l(zc,this,3E4);l($b,this,null);l(ac,this,!1);l(mb,this,!1);l(nb,this,!1);l(Ua,this,new Set);l(ob,this,z("fake_request_handler",r,null));this.app_key=z("app_key",r,null);this.url=Ya(z("url",r,""));this.serialize=z("serialize",r,w.serialize);this.deserialize=z("deserialize",
r,w.deserialize);l(Zc,this,z("disable_sdk_behavior_settings_updates",r,!1));l(Xb,this,!1);l(Zb,this,z("test_mode_time",r,0));try{localStorage.setItem("cly_testLocal",!0),localStorage.removeItem("cly_testLocal")}catch(c){b(d,this).call(this,f.ERROR,"Local storage test failed, Halting local storage support: "+c),l(Ka,this,!1)}l(Ma,this,b(E,this).call(this,"cly_config"));b(Ma,this)||(l(Ma,this,z("behavior_settings",r,{})),b(B,this).call(this,"cly_config",JSON.stringify(b(Ma,this))));b(Bc,this).call(this,
b(Ma,this));l(U,this,{});for(var G=0;G<w.features.length;G++)b(U,this)[w.features[G]]={};b(Fd,this).call(this,r);b(gd,this).call(this);setTimeout(function(){w.noHeartBeat?b(d,a).call(a,f.WARNING,"initialize, Heartbeat disabled. This is for testing purposes only!"):b(cc,a).call(a);a.remote_config&&a.fetch_remote_config(a.remote_config)},1);D&&document.documentElement.setAttribute("data-countly-useragent",tb());l(yc,this,sb());b(xa,this).sendInstantHCRequest();b(Eb,this)&&(b(Va,this).call(this),l(xc,
this,!0));b(d,this).call(this,f.INFO,"initialize, Countly initialized")}),ge=!0;w.features="apm attribution clicks crashes events feedback forms location remote-config scrolls sessions star-rating users views".split(" ");w.q=w.q||[];w.onload=w.onload||[];w.CountlyClass=fe;w.init=function(r){r=r||{};if(w.loadAPMScriptsAsync&&ge)ge=!1,he(r);else{var v=r.app_key||w.app_key;if(!w.i||!w.i[v]){r=new fe(r);if(!w.i){w.i={};for(var a in r)w[a]=r[a]}w.i[v]=r}return w.i[v]}};w.serialize=function(r){try{"object"===
W(r)&&(r=JSON.stringify(r))}catch(v){}return r};w.deserialize=function(r){if(""===r)return r;try{r=JSON.parse(r)}catch(v){}return r};w.getViewName=function(){return D?window.location.pathname:"web_worker"};w.getViewUrl=function(){return D?window.location.pathname:"web_worker"};w.getSearchQuery=function(){if(D)return window.location.search};w.DeviceIdType={DEVELOPER_SUPPLIED:0,SDK_GENERATED:1,TEMPORARY_ID:2};D&&window.addEventListener("storage",function(r){var v=(r.key+"").split("/"),a=v.pop();v=v.pop();
if(w.i&&w.i[v])w.i[v]._internals.onStorageChange(a,r.newValue)});Wa.default=w;Object.defineProperty(Wa,"__esModule",{value:!0})});
